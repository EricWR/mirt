<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Compute the M2 model fit statistic</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/languages/r.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head><body>

<table width="100%" summary="page for M2 {mirt}"><tr><td>M2 {mirt}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Compute the M2 model fit statistic</h2>

<h3>Description</h3>

<p>Computes the M2 (Maydeu-Olivares &amp; Joe, 2006) statistic for dichotomous data and the
M2* statistic for polytomous data (collapsing over response categories for better stability;
see Cai and Hansen, 2013), as well as associated fit indices that are based on
fitting the null model.
</p>


<h3>Usage</h3>

<pre>
M2(obj, calcNull = TRUE, quadpts = NULL, theta_lim = c(-6, 6),
  impute = 0, CI = 0.9, residmat = FALSE, QMC = FALSE, suppress = 1,
  ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>obj</code></td>
<td>
<p>an estimated model object from the mirt package</p>
</td></tr>
<tr valign="top"><td><code>calcNull</code></td>
<td>
<p>logical; calculate statistics for the null model as well?
Allows for statistics such as the limited information TLI and CFI</p>
</td></tr>
<tr valign="top"><td><code>quadpts</code></td>
<td>
<p>number of quadrature points to use during estimation. If <code>NULL</code>,
a suitable value will be chosen based
on the rubric found in <code><a href="fscores.html">fscores</a></code></p>
</td></tr>
<tr valign="top"><td><code>theta_lim</code></td>
<td>
<p>lower and upper range to evaluate latent trait integral for each dimension</p>
</td></tr>
<tr valign="top"><td><code>impute</code></td>
<td>
<p>a number indicating how many imputations to perform
(passed to <code><a href="imputeMissing.html">imputeMissing</a></code>) when there are missing data present. This requires
a precomputed <code>Theta</code> input. Will return a data.frame object with the mean estimates
of the stats and their imputed standard deviations</p>
</td></tr>
<tr valign="top"><td><code>CI</code></td>
<td>
<p>numeric value from 0 to 1 indicating the range of the confidence interval for
RMSEA. Default returns the 90% interval</p>
</td></tr>
<tr valign="top"><td><code>residmat</code></td>
<td>
<p>logical; return the residual matrix used to compute the SRMSR statistic?
Only the lower triangle of the residual correlation matrix will be returned
(the upper triangle is filled with NA's)</p>
</td></tr>
<tr valign="top"><td><code>QMC</code></td>
<td>
<p>logical; use quasi-Monte Carlo integration? Useful for higher dimensional models.
If <code>quadpts</code> not specified, 15000 nodes are used by default</p>
</td></tr>
<tr valign="top"><td><code>suppress</code></td>
<td>
<p>a numeric value indicating which parameter residual dependency combinations
to flag as being too high. Absolute values for the standardized residuals greater than
this value will be returned, while all values less than this value will be set to NA.
Must be used in conjunction with the argument <code>residmat = TRUE</code></p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>additional arguments to pass</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data.frame object with the M2 statistic, along with the degrees of freedom,
p-value, RMSEA (with 90% confidence interval), SRMSR if all items were ordinal,
and optionally the TLI and CFI model fit statistics
</p>


<h3>Author(s)</h3>

<p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a>
</p>


<h3>References</h3>

<p>Cai, L. &amp; Hansen, M. (2013). Limited-information goodness-of-fit testing of
hierarchical item factor models. British Journal of Mathematical and Statistical
Psychology, 66, 245-276.
</p>
<p>Maydeu-Olivares, A. &amp; Joe, H. (2006). Limited information goodness-of-fit testing in
multidimensional contingency tables Psychometrika, 71, 713-732.
</p>


<h3>Examples</h3>

<pre><code class="r">## No test: 
dat &lt;- expand.table(LSAT7)
(mod1 &lt;- mirt(dat, 1))
</code></pre>

<pre><code>## 
## Call:
## mirt(data = dat, model = 1)
## 
## Full-information item factor analysis with 1 factor(s).
## Converged within 1e-04 tolerance after 28 EM iterations.
## mirt version: 1.10 
## M-step optimizer: BFGS 
## EM acceleration: Ramsay
## Number of rectangular quadrature: 61
## 
## Log-likelihood = -2658.805
## AIC = 5337.61; AICc = 5337.833
## BIC = 5386.688; SABIC = 5354.927
## G2 (21) = 31.7, p = 0.0628
## RMSEA = 0.023, CFI = 0.939, TLI = 0.924
</code></pre>

<pre><code class="r">M2(mod1)
</code></pre>

<pre><code>##             M2 df          p     RMSEA     RMSEA_5   RMSEA_95       TLI
## stats 11.93769  5 0.03565165 0.0372683 0.008950922 0.06496573 0.9369332
##             CFI      SRMSR
## stats 0.9684666 0.03195919
</code></pre>

<pre><code class="r">M2(mod1, residmat=TRUE) #lower triangle of residual correlation matrix
</code></pre>

<pre><code>##             Item.1      Item.2       Item.3       Item.4 Item.5
## Item.1          NA          NA           NA           NA     NA
## Item.2 -0.02212010          NA           NA           NA     NA
## Item.3 -0.03265942  0.03335601           NA           NA     NA
## Item.4  0.05155184 -0.01642572 -0.012476892           NA     NA
## Item.5  0.05443241 -0.03867705 -0.001860395 7.235426e-05     NA
</code></pre>

<pre><code class="r">#M2 imputed with missing data present (run in parallel)
dat[sample(1:prod(dim(dat)), 250)] &lt;- NA
mod2 &lt;- mirt(dat, 1)
mirtCluster()
</code></pre>

<pre><code>## mirtCluster() has already been defined
</code></pre>

<pre><code class="r">M2(mod2, impute = 10)
</code></pre>

<pre><code>##                M2 df          p       RMSEA     RMSEA_5   RMSEA_95
## stats    9.574611  5 0.11290279 0.029394130 0.002356477 0.05860189
## SD_stats 2.516901  0 0.05612749 0.007198836 0.007069431 0.00603010
##                 TLI        CFI       SRMSR
## stats    0.95459681 0.97729840 0.028917316
## SD_stats 0.02452819 0.01226409 0.003213708
</code></pre>

<pre><code class="r">## End(No test)
</code></pre>


<hr /><div style="text-align: center;">[Package <em>mirt</em> version 1.10 <a href="00Index.html">Index</a>]</div>
</body></html>
