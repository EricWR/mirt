<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Imputing plausible data for missing values</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/languages/r.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head><body>

<table width="100%" summary="page for imputeMissing {mirt}"><tr><td>imputeMissing {mirt}</td><td align="right">R Documentation</td></tr></table>

<h2>Imputing plausible data for missing values</h2>

<h3>Description</h3>

<p>Given an estimated model from any of mirt's model fitting functions and an estimate of the
latent trait, impute plausible missing data values. Returns the original data in a
<code>data.frame</code> without any NA values. If a list of <code>Theta</code> values is supplied then a
list of complete datasets is returned instead.
</p>


<h3>Usage</h3>

<pre>
imputeMissing(x, Theta, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>an estimated model x from the mirt package</p>
</td></tr>
<tr valign="top"><td><code>Theta</code></td>
<td>
<p>a matrix containing the estimates of the latent trait scores
(e.g., via <code><a href="fscores.html">fscores</a></code>). Can also be a <code>list</code> input containing different
estimates for Theta (e.g., plausible value draws)</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>additional arguments to pass</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class="r">## No test: 
dat &lt;- expand.table(LSAT7)
(original &lt;- mirt(dat, 1))
</code></pre>

<pre><code>## 
## Call:
## mirt(data = dat, model = 1)
## 
## Full-information item factor analysis with 1 factor(s).
## Converged within 1e-04 tolerance after 28 EM iterations.
## mirt version: 1.9 
## M-step optimizer: BFGS 
## EM acceleration: Ramsay
## Number of rectangular quadrature: 41
## 
## Log-likelihood = -2658.805
## AIC = 5337.61; AICc = 5337.833
## BIC = 5386.688; SABIC = 5354.927
## G2 (21) = 31.7, p = 0.0628
## RMSEA = 0.023, CFI = 0.939, TLI = 0.924
</code></pre>

<pre><code class="r">NAperson &lt;- sample(1:nrow(dat), 20, replace = TRUE)
NAitem &lt;- sample(1:ncol(dat), 20, replace = TRUE)
for(i in 1:20)
    dat[NAperson[i], NAitem[i]] &lt;- NA
(mod &lt;- mirt(dat, 1))
</code></pre>

<pre><code>## 
## Call:
## mirt(data = dat, model = 1)
## 
## Full-information item factor analysis with 1 factor(s).
## Converged within 1e-04 tolerance after 36 EM iterations.
## mirt version: 1.9 
## M-step optimizer: BFGS 
## EM acceleration: Ramsay
## Number of rectangular quadrature: 41
## 
## Log-likelihood = -2648.141
## AIC = 5316.281; AICc = 5316.504
## BIC = 5365.359; SABIC = 5333.598
</code></pre>

<pre><code class="r">scores &lt;- fscores(mod, method = &#39;MAP&#39;, full.scores = TRUE)

#re-estimate imputed dataset (good to do this multiple times and average over)
fulldata &lt;- imputeMissing(mod, scores)
(fullmod &lt;- mirt(fulldata, 1))
</code></pre>

<pre><code>## 
## Call:
## mirt(data = fulldata, model = 1)
## 
## Full-information item factor analysis with 1 factor(s).
## Converged within 1e-04 tolerance after 33 EM iterations.
## mirt version: 1.9 
## M-step optimizer: BFGS 
## EM acceleration: Ramsay
## Number of rectangular quadrature: 41
## 
## Log-likelihood = -2655.975
## AIC = 5331.95; AICc = 5332.172
## BIC = 5381.027; SABIC = 5349.267
## G2 (21) = 32.82, p = 0.0482
## RMSEA = 0.024, CFI = 0.933, TLI = 0.918
</code></pre>

<pre><code class="r">#with multipleGroup
group &lt;- rep(c(&#39;group1&#39;, &#39;group2&#39;), each=500)
mod2 &lt;- multipleGroup(dat, 1, group, TOL=1e-2)
fs &lt;- fscores(mod2, full.scores=TRUE)
fulldata2 &lt;- imputeMissing(mod2, fs)

#supply list of plausible value estimates (the best approach when Theta&#39;s are imprecise)
pv &lt;- fscores(mod, plausible.draws = 5)
fulldata_list &lt;- imputeMissing(mod, pv)
str(fulldata_list)
</code></pre>

<pre><code>## List of 5
##  $ : int [1:1000, 1:5] 0 0 0 0 0 0 0 0 0 0 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:1000] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. ..$ : chr [1:5] &quot;Item.1&quot; &quot;Item.2&quot; &quot;Item.3&quot; &quot;Item.4&quot; ...
##  $ : int [1:1000, 1:5] 0 0 0 0 0 0 0 0 0 0 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:1000] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. ..$ : chr [1:5] &quot;Item.1&quot; &quot;Item.2&quot; &quot;Item.3&quot; &quot;Item.4&quot; ...
##  $ : int [1:1000, 1:5] 0 0 0 0 0 0 0 0 0 0 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:1000] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. ..$ : chr [1:5] &quot;Item.1&quot; &quot;Item.2&quot; &quot;Item.3&quot; &quot;Item.4&quot; ...
##  $ : int [1:1000, 1:5] 0 0 0 0 0 0 0 0 0 0 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:1000] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. ..$ : chr [1:5] &quot;Item.1&quot; &quot;Item.2&quot; &quot;Item.3&quot; &quot;Item.4&quot; ...
##  $ : int [1:1000, 1:5] 0 0 0 0 0 0 0 0 0 0 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:1000] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. ..$ : chr [1:5] &quot;Item.1&quot; &quot;Item.2&quot; &quot;Item.3&quot; &quot;Item.4&quot; ...
</code></pre>

<pre><code class="r">## End(No test)
</code></pre>


<hr><div align="center">[Package <em>mirt</em> version 1.9 <a href="00Index.html">Index</a>]</div>
</body></html>
