<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Three Parameterizations of Rasch model</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>Three Parameterizations of Rasch model</h1>

<p>Here we demonstrate three alternative ways to represent the simple Rasch model for dichotomous
data. </p>

<h2>Approach 1</h2>

<p>Use fixed slope parameters set to 1, freely estimate all intercepts, and freely estimate the 
variance of the latent trait.</p>

<pre><code class="r">library(mirt)
dat &lt;- expand.table(LSAT6)
mod &lt;- mirt(dat, 1, itemtype = &#39;Rasch&#39;)
</code></pre>

<pre><code>## 
Iteration: 1, Log-Lik: -2473.219, Max-Change: 0.05796
Iteration: 2, Log-Lik: -2471.904, Max-Change: 0.03951
Iteration: 3, Log-Lik: -2471.040, Max-Change: 0.03365
Iteration: 4, Log-Lik: -2470.475, Max-Change: 0.03651
Iteration: 5, Log-Lik: -2469.715, Max-Change: 0.02599
Iteration: 6, Log-Lik: -2469.258, Max-Change: 0.02223
Iteration: 7, Log-Lik: -2468.891, Max-Change: 0.02017
Iteration: 8, Log-Lik: -2468.585, Max-Change: 0.01728
Iteration: 9, Log-Lik: -2468.339, Max-Change: 0.01536
Iteration: 10, Log-Lik: -2468.165, Max-Change: 0.01744
Iteration: 11, Log-Lik: -2467.939, Max-Change: 0.01260
Iteration: 12, Log-Lik: -2467.794, Max-Change: 0.01115
Iteration: 13, Log-Lik: -2467.674, Max-Change: 0.01041
Iteration: 14, Log-Lik: -2467.570, Max-Change: 0.00914
Iteration: 15, Log-Lik: -2467.484, Max-Change: 0.00830
Iteration: 16, Log-Lik: -2467.420, Max-Change: 0.00962
Iteration: 17, Log-Lik: -2467.341, Max-Change: 0.00704
Iteration: 18, Log-Lik: -2467.287, Max-Change: 0.00635
Iteration: 19, Log-Lik: -2467.242, Max-Change: 0.00602
Iteration: 20, Log-Lik: -2467.201, Max-Change: 0.00536
Iteration: 21, Log-Lik: -2467.168, Max-Change: 0.00492
Iteration: 22, Log-Lik: -2467.142, Max-Change: 0.00575
Iteration: 23, Log-Lik: -2467.111, Max-Change: 0.00451
Iteration: 24, Log-Lik: -2467.089, Max-Change: 0.00389
Iteration: 25, Log-Lik: -2467.070, Max-Change: 0.00353
Iteration: 26, Log-Lik: -2467.053, Max-Change: 0.00331
Iteration: 27, Log-Lik: -2467.039, Max-Change: 0.00308
Iteration: 28, Log-Lik: -2467.029, Max-Change: 0.00393
Iteration: 29, Log-Lik: -2467.015, Max-Change: 0.00271
Iteration: 30, Log-Lik: -2467.005, Max-Change: 0.00236
Iteration: 31, Log-Lik: -2466.998, Max-Change: 0.00246
Iteration: 32, Log-Lik: -2466.990, Max-Change: 0.00212
Iteration: 33, Log-Lik: -2466.984, Max-Change: 0.00199
Iteration: 34, Log-Lik: -2466.979, Max-Change: 0.00188
Iteration: 35, Log-Lik: -2466.973, Max-Change: 0.00168
Iteration: 36, Log-Lik: -2466.969, Max-Change: 0.00150
Iteration: 37, Log-Lik: -2466.967, Max-Change: 0.00242
Iteration: 38, Log-Lik: -2466.963, Max-Change: 0.00141
Iteration: 39, Log-Lik: -2466.960, Max-Change: 0.00133
Iteration: 40, Log-Lik: -2466.958, Max-Change: 0.00177
Iteration: 41, Log-Lik: -2466.955, Max-Change: 0.00118
Iteration: 42, Log-Lik: -2466.953, Max-Change: 0.00135
Iteration: 43, Log-Lik: -2466.951, Max-Change: 0.00102
Iteration: 44, Log-Lik: -2466.950, Max-Change: 0.00096
Iteration: 45, Log-Lik: -2466.948, Max-Change: 0.00086
Iteration: 46, Log-Lik: -2466.947, Max-Change: 0.00107
Iteration: 47, Log-Lik: -2466.946, Max-Change: 0.00074
Iteration: 48, Log-Lik: -2466.945, Max-Change: 0.00074
Iteration: 49, Log-Lik: -2466.945, Max-Change: 0.00070
Iteration: 50, Log-Lik: -2466.944, Max-Change: 0.00060
Iteration: 51, Log-Lik: -2466.943, Max-Change: 0.00061
Iteration: 52, Log-Lik: -2466.943, Max-Change: 0.00058
Iteration: 53, Log-Lik: -2466.942, Max-Change: 0.00051
Iteration: 54, Log-Lik: -2466.942, Max-Change: 0.00051
Iteration: 55, Log-Lik: -2466.941, Max-Change: 0.00049
Iteration: 56, Log-Lik: -2466.941, Max-Change: 0.00050
Iteration: 57, Log-Lik: -2466.940, Max-Change: 0.00044
Iteration: 58, Log-Lik: -2466.940, Max-Change: 0.00040
Iteration: 59, Log-Lik: -2466.940, Max-Change: 0.00029
Iteration: 60, Log-Lik: -2466.940, Max-Change: 0.00029
Iteration: 61, Log-Lik: -2466.939, Max-Change: 0.00028
Iteration: 62, Log-Lik: -2466.939, Max-Change: 0.00027
Iteration: 63, Log-Lik: -2466.939, Max-Change: 0.00025
Iteration: 64, Log-Lik: -2466.939, Max-Change: 0.00026
Iteration: 65, Log-Lik: -2466.939, Max-Change: 0.00024
Iteration: 66, Log-Lik: -2466.939, Max-Change: 0.00022
Iteration: 67, Log-Lik: -2466.939, Max-Change: 0.00021
Iteration: 68, Log-Lik: -2466.939, Max-Change: 0.00020
Iteration: 69, Log-Lik: -2466.939, Max-Change: 0.00019
Iteration: 70, Log-Lik: -2466.938, Max-Change: 0.00020
Iteration: 71, Log-Lik: -2466.938, Max-Change: 0.00018
Iteration: 72, Log-Lik: -2466.938, Max-Change: 0.00017
Iteration: 73, Log-Lik: -2466.938, Max-Change: 0.00016
Iteration: 74, Log-Lik: -2466.938, Max-Change: 0.00016
Iteration: 75, Log-Lik: -2466.938, Max-Change: 0.00010
</code></pre>

<pre><code class="r">print(mod)
</code></pre>

<pre><code>## 
## Call:
## mirt(data = dat, model = 1, itemtype = &quot;Rasch&quot;)
## 
## Full-information item factor analysis with 1 factor(s).
## Converged within 1e-04 tolerance after 75 EM iterations.
## mirt version: 1.19 
## M-step optimizer: BFGS 
## EM acceleration: Ramsay
## Number of rectangular quadrature: 61
## 
## Log-likelihood = -2466.938
## AIC = 4945.876; AICc = 4945.961
## BIC = 4975.323; SABIC = 4956.266
## G2 (25) = 21.8, p = 0.6473
## RMSEA = 0, CFI = 1, TLI = 1.068
</code></pre>

<pre><code class="r">coef(mod)
</code></pre>

<pre><code>## $Item_1
##     a1     d g u
## par  1 2.731 0 1
## 
## $Item_2
##     a1     d g u
## par  1 0.999 0 1
## 
## $Item_3
##     a1    d g u
## par  1 0.24 0 1
## 
## $Item_4
##     a1     d g u
## par  1 1.307 0 1
## 
## $Item_5
##     a1     d g u
## par  1 2.101 0 1
## 
## $GroupPars
##     MEAN_1 COV_11
## par      0  0.574
</code></pre>

<h2>Approach 2</h2>

<p>Use freely estimate slope parameters but constrain them to be equal across all items, freely 
estimate all intercepts.</p>

<pre><code class="r">model &lt;- mirt.model(&#39;Theta = 1-5
                    CONSTRAIN = (1-5, a1)&#39;)
mod2 &lt;- mirt(dat, model)
</code></pre>

<pre><code>## 
Iteration: 1, Log-Lik: -2468.601, Max-Change: 0.07077
Iteration: 2, Log-Lik: -2467.371, Max-Change: 0.02297
Iteration: 3, Log-Lik: -2467.099, Max-Change: 0.01355
Iteration: 4, Log-Lik: -2466.986, Max-Change: 0.00735
Iteration: 5, Log-Lik: -2466.959, Max-Change: 0.00482
Iteration: 6, Log-Lik: -2466.947, Max-Change: 0.00316
Iteration: 7, Log-Lik: -2466.939, Max-Change: 0.00109
Iteration: 8, Log-Lik: -2466.938, Max-Change: 0.00073
Iteration: 9, Log-Lik: -2466.938, Max-Change: 0.00049
Iteration: 10, Log-Lik: -2466.938, Max-Change: 0.00028
Iteration: 11, Log-Lik: -2466.938, Max-Change: 0.00016
Iteration: 12, Log-Lik: -2466.938, Max-Change: 0.00009
</code></pre>

<pre><code class="r">print(mod2)
</code></pre>

<pre><code>## 
## Call:
## mirt(data = dat, model = model)
## 
## Full-information item factor analysis with 1 factor(s).
## Converged within 1e-04 tolerance after 12 EM iterations.
## mirt version: 1.19 
## M-step optimizer: BFGS 
## EM acceleration: Ramsay
## Number of rectangular quadrature: 61
## 
## Log-likelihood = -2466.938
## AIC = 4945.875; AICc = 4945.96
## BIC = 4975.322; SABIC = 4956.265
## G2 (25) = 21.8, p = 0.6474
## RMSEA = 0, CFI = 1, TLI = 1.068
</code></pre>

<pre><code class="r">coef(mod2)
</code></pre>

<pre><code>## $Item_1
##        a1    d g u
## par 0.755 2.73 0 1
## 
## $Item_2
##        a1     d g u
## par 0.755 0.999 0 1
## 
## $Item_3
##        a1    d g u
## par 0.755 0.24 0 1
## 
## $Item_4
##        a1     d g u
## par 0.755 1.307 0 1
## 
## $Item_5
##        a1   d g u
## par 0.755 2.1 0 1
## 
## $GroupPars
##     MEAN_1 COV_11
## par      0      1
</code></pre>

<h2>Approach 3</h2>

<p>Fix slopes to 1, freely estimate intercepts subject to the constraint that \(\sum_j d_j = 0\),
and freely estimate the latent mean and variance.</p>

<pre><code class="r">model2 &lt;- mirt.model(&#39;Theta = 1-5
                     MEAN = Theta
                     COV = Theta*Theta&#39;)

#view how vector of parameters is organized internally
sv &lt;- mirt(dat, model2, itemtype = &#39;Rasch&#39;, pars = &#39;values&#39;)
sv[sv$est, ]
</code></pre>

<pre><code>##    group   item     class   name parnum     value lbound ubound  est
## 2    all Item_1      dich      d      2 2.8152981   -Inf    Inf TRUE
## 6    all Item_2      dich      d      6 1.0818304   -Inf    Inf TRUE
## 10   all Item_3      dich      d     10 0.2618655   -Inf    Inf TRUE
## 14   all Item_4      dich      d     14 1.4071275   -Inf    Inf TRUE
## 18   all Item_5      dich      d     18 2.2136968   -Inf    Inf TRUE
## 21   all  GROUP GroupPars MEAN_1     21 0.0000000   -Inf    Inf TRUE
## 22   all  GROUP GroupPars COV_11     22 1.0000000  1e-04    Inf TRUE
##    prior.type prior_1 prior_2
## 2        none     NaN     NaN
## 6        none     NaN     NaN
## 10       none     NaN     NaN
## 14       none     NaN     NaN
## 18       none     NaN     NaN
## 21       none     NaN     NaN
## 22       none     NaN     NaN
</code></pre>

<pre><code class="r">#constraint: create function for solnp to compute constraint, and declare value in eqB
eqfun &lt;- function(p, optim_args) sum(p[1:5]) #could use browser() here, if it helps
solnp_args &lt;- list(eqfun=eqfun, eqB=0)

mod3 &lt;- mirt(dat, model2, itemtype = &#39;Rasch&#39;, optimizer = &#39;solnp&#39;, solnp_args=solnp_args)
</code></pre>

<pre><code>## 
## Iter: 1 fn: 10151.4502    Pars:   0.799784 -0.258164 -1.066590  0.002158  0.522813  0         0.950309
## Iter: 2 fn: 10151.4502    Pars:   0.79981 -0.25818 -1.06660  0.00214  0.52282  0        0.95031
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 1, Log-Lik: -2473.219, Max-Change: 2.01549
## Iter: 1 fn: 9001.9074     Pars:   0.86076 -0.33445 -1.06078 -0.04892  0.58340  0.54398  0.78548
## Iter: 2 fn: 8968.4212     Pars:   0.86268 -0.30574 -1.03825 -0.04416  0.52547  0.64484  0.76737
## Iter: 3 fn: 8968.4212     Pars:   0.86260 -0.30566 -1.03816 -0.04421  0.52543  0.64484  0.76736
## solnp--&gt; Completed in 3 iterations
## 
Iteration: 2, Log-Lik: -2976.930, Max-Change: 0.64484
## Iter: 1 fn: 8494.8016     Pars:   0.94828 -0.34713 -1.07587 -0.07480  0.54953  0.94830  0.67629
## Iter: 2 fn: 8494.8016     Pars:   0.94829 -0.34713 -1.07587 -0.07480  0.54951  0.94829  0.67630
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 3, Log-Lik: -2637.522, Max-Change: 0.30344
## Iter: 1 fn: 8250.5789     Pars:   1.02041 -0.37934 -1.11244 -0.09795  0.56933  1.11790  0.62587
## Iter: 2 fn: 8250.5789     Pars:   1.02041 -0.37934 -1.11245 -0.09796  0.56933  1.11790  0.62588
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 4, Log-Lik: -2536.426, Max-Change: 0.16961
## Iter: 1 fn: 8107.8712     Pars:   1.07646 -0.40344 -1.14128 -0.11542  0.58367  1.22298  0.59556
## Iter: 2 fn: 8107.8712     Pars:   1.07646 -0.40344 -1.14128 -0.11542  0.58368  1.22298  0.59556
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 5, Log-Lik: -2498.611, Max-Change: 0.10508
## Iter: 1 fn: 8018.7987     Pars:   1.11908 -0.42134 -1.16308 -0.12853  0.59387  1.29232  0.57638
## Iter: 2 fn: 8018.7987     Pars:   1.11908 -0.42134 -1.16308 -0.12853  0.59387  1.29232  0.57638
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 6, Log-Lik: -2482.404, Max-Change: 0.06934
## Iter: 1 fn: 7961.3054     Pars:   1.15127 -0.43464 -1.17942 -0.13836  0.60115  1.33999  0.56392
## Iter: 2 fn: 7961.3054     Pars:   1.15127 -0.43464 -1.17942 -0.13836  0.60115  1.33999  0.56392
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 7, Log-Lik: -2474.841, Max-Change: 0.04766
## Iter: 1 fn: 7923.7317     Pars:   1.17553 -0.44455 -1.19166 -0.14573  0.60641  1.37366  0.55574
## Iter: 2 fn: 7923.7317     Pars:   1.17553 -0.44455 -1.19166 -0.14573  0.60641  1.37366  0.55574
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 8, Log-Lik: -2471.109, Max-Change: 0.03368
## Iter: 1 fn: 7899.3031     Pars:   1.19382 -0.45196 -1.20086 -0.15126  0.61026  1.39792  0.55041
## Iter: 2 fn: 7899.3031     Pars:   1.19382 -0.45196 -1.20086 -0.15126  0.61026  1.39792  0.55041
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 9, Log-Lik: -2469.197, Max-Change: 0.02426
## Iter: 1 fn: 7884.8371     Pars:   1.20904 -0.45808 -1.20858 -0.15581  0.61344  1.41741  0.54728
## Iter: 2 fn: 7884.8371     Pars:   1.20904 -0.45808 -1.20858 -0.15581  0.61344  1.41741  0.54728
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 10, Log-Lik: -2468.196, Max-Change: 0.01948
## Iter: 1 fn: 7875.9742     Pars:   1.21912 -0.46211 -1.21367 -0.15882  0.61549  1.43009  0.54533
## Iter: 2 fn: 7875.9742     Pars:   1.21912 -0.46211 -1.21367 -0.15882  0.61549  1.43009  0.54533
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 11, Log-Lik: -2467.605, Max-Change: 0.01268
## Iter: 1 fn: 7871.2834     Pars:   1.22801 -0.46513 -1.21808 -0.16142  0.61663  1.44045  0.54440
## Iter: 2 fn: 7871.2833     Pars:   1.22742 -0.46588 -1.21776 -0.16118  0.61740  1.44044  0.54439
## Iter: 3 fn: 7871.2832     Pars:   1.22767 -0.46509 -1.21803 -0.16166  0.61711  1.44043  0.54439
## Iter: 4 fn: 7871.2831     Pars:   1.22749 -0.46596 -1.21774 -0.16103  0.61724  1.44042  0.54439
## Iter: 5 fn: 7871.2830     Pars:   1.22761 -0.46513 -1.21800 -0.16165  0.61716  1.44041  0.54439
## Iter: 6 fn: 7871.2830     Pars:   1.22749 -0.46590 -1.21775 -0.16105  0.61721  1.44040  0.54439
## Iter: 7 fn: 7871.2829     Pars:   1.22757 -0.46531 -1.21793 -0.16150  0.61717  1.44039  0.54439
## Iter: 8 fn: 7871.2828     Pars:   1.22744 -0.46606 -1.21769 -0.16091  0.61722  1.44037  0.54439
## Iter: 9 fn: 7871.2827     Pars:   1.22755 -0.46522 -1.21795 -0.16155  0.61717  1.44036  0.54439
## Iter: 10 fn: 7871.2826    Pars:   1.22744 -0.46594 -1.21772 -0.16099  0.61721  1.44035  0.54439
## Iter: 11 fn: 7871.2825    Pars:   1.22753 -0.46527 -1.21792 -0.16151  0.61717  1.44034  0.54439
## Iter: 12 fn: 7871.2824    Pars:   1.22739 -0.46612 -1.21764 -0.16084  0.61722  1.44032  0.54438
## Iter: 13 fn: 7871.2823    Pars:   1.22748 -0.46541 -1.21787 -0.16138  0.61717  1.44032  0.54438
## Iter: 14 fn: 7871.2795    Pars:   1.22690 -0.46507 -1.21762 -0.16115  0.61695  1.43958  0.54431
## Iter: 15 fn: 7871.2795    Pars:   1.22684 -0.46508 -1.21761 -0.16118  0.61704  1.43957  0.54431
## solnp--&gt; Completed in 15 iterations
## 
Iteration: 12, Log-Lik: -2467.328, Max-Change: 0.00949
## Iter: 1 fn: 7870.0307     Pars:   1.23310 -0.46802 -1.22047 -0.16310  0.61849  1.44838  0.54409
## Iter: 2 fn: 7870.0306     Pars:   1.23347 -0.46721 -1.22072 -0.16354  0.61800  1.44836  0.54409
## Iter: 3 fn: 7870.0305     Pars:   1.23328 -0.46801 -1.22050 -0.16301  0.61824  1.44835  0.54409
## Iter: 4 fn: 7870.0304     Pars:   1.23328 -0.46735 -1.22068 -0.16352  0.61827  1.44834  0.54409
## solnp--&gt; Completed in 4 iterations
## 
Iteration: 13, Log-Lik: -2467.178, Max-Change: 0.00932
## Iter: 1 fn: 7870.8579     Pars:   1.23344 -0.46742 -1.22084 -0.16352  0.61834  1.45379  0.54434
## Iter: 2 fn: 7870.8578     Pars:   1.23355 -0.46749 -1.22094 -0.16352  0.61840  1.45379  0.54420
## Iter: 3 fn: 7870.8577     Pars:   1.23366 -0.46755 -1.22104 -0.16353  0.61846  1.45379  0.54435
## Iter: 4 fn: 7870.8576     Pars:   1.23377 -0.46762 -1.22114 -0.16353  0.61852  1.45379  0.54419
## Iter: 5 fn: 7870.8575     Pars:   1.23387 -0.46768 -1.22123 -0.16353  0.61857  1.45379  0.54436
## Iter: 6 fn: 7870.8574     Pars:   1.23395 -0.46772 -1.22130 -0.16354  0.61861  1.45379  0.54422
## Iter: 7 fn: 7870.8573     Pars:   1.23409 -0.46781 -1.22142 -0.16354  0.61869  1.45379  0.54437
## Iter: 8 fn: 7870.8572     Pars:   1.23416 -0.46785 -1.22148 -0.16355  0.61872  1.45379  0.54421
## Iter: 9 fn: 7870.8571     Pars:   1.23426 -0.46791 -1.22156 -0.16355  0.61877  1.45379  0.54433
## solnp--&gt; Completed in 9 iterations
## 
Iteration: 14, Log-Lik: -2467.071, Max-Change: 0.00545
## Iter: 1 fn: 7873.1868     Pars:   1.24138 -0.47090 -1.22501 -0.16555  0.62008  1.45758  0.54484
## Iter: 2 fn: 7873.1868     Pars:   1.24146 -0.47117 -1.22493 -0.16523  0.61988  1.45757  0.54484
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 15, Log-Lik: -2467.028, Max-Change: 0.00720
## Iter: 1 fn: 7876.4360     Pars:   1.24375 -0.47183 -1.22671 -0.16587  0.62065  1.46072  0.54561
## Iter: 2 fn: 7876.4360     Pars:   1.24391 -0.47201 -1.22654 -0.16609  0.62073  1.46072  0.54561
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 16, Log-Lik: -2466.999, Max-Change: 0.00315
## Iter: 1 fn: 7880.3433     Pars:   1.24598 -0.47289 -1.22783 -0.16667  0.62141  1.46294  0.54650
## Iter: 2 fn: 7880.3433     Pars:   1.24601 -0.47275 -1.22791 -0.16660  0.62125  1.46293  0.54650
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 17, Log-Lik: -2466.984, Max-Change: 0.00221
## Iter: 1 fn: 7884.6020     Pars:   1.24701 -0.47325 -1.22873 -0.16677  0.62174  1.46424  0.54739
## Iter: 2 fn: 7884.6019     Pars:   1.24720 -0.47330 -1.22843 -0.16702  0.62156  1.46425  0.54739
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 18, Log-Lik: -2466.974, Max-Change: 0.00131
## Iter: 1 fn: 7888.5782     Pars:   1.24799 -0.47354 -1.22914 -0.16711  0.62181  1.46532  0.54829
## Iter: 2 fn: 7888.5782     Pars:   1.24828 -0.47376 -1.22898 -0.16728  0.62174  1.46533  0.54829
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 19, Log-Lik: -2466.969, Max-Change: 0.00108
## Iter: 1 fn: 7892.5157     Pars:   1.24865 -0.47379 -1.22960 -0.16725  0.62198  1.46668  0.54935
## Iter: 2 fn: 7892.5157     Pars:   1.24889 -0.47398 -1.22945 -0.16743  0.62197  1.46667  0.54935
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 20, Log-Lik: -2466.965, Max-Change: 0.00135
## Iter: 1 fn: 7897.1435     Pars:   1.24940 -0.47409 -1.23014 -0.16742  0.62225  1.46759  0.55038
## Iter: 2 fn: 7897.1435     Pars:   1.24963 -0.47424 -1.23005 -0.16757  0.62223  1.46759  0.55038
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 21, Log-Lik: -2466.961, Max-Change: 0.00103
## Iter: 1 fn: 7901.6711     Pars:   1.25055 -0.47446 -1.23066 -0.16773  0.62229  1.46845  0.55142
## Iter: 2 fn: 7901.6711     Pars:   1.25052 -0.47454 -1.23062 -0.16774  0.62239  1.46845  0.55142
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 22, Log-Lik: -2466.958, Max-Change: 0.00108
## Iter: 1 fn: 7905.9860     Pars:   1.25075 -0.47461 -1.23094 -0.16776  0.62256  1.46897  0.55226
## Iter: 2 fn: 7905.9860     Pars:   1.25088 -0.47470 -1.23089 -0.16786  0.62257  1.46897  0.55226
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 23, Log-Lik: -2466.955, Max-Change: 0.00084
## Iter: 1 fn: 7909.5204     Pars:   1.25110 -0.47475 -1.23120 -0.16784  0.62269  1.46937  0.55306
## Iter: 2 fn: 7909.5204     Pars:   1.25124 -0.47485 -1.23113 -0.16794  0.62268  1.46937  0.55306
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 24, Log-Lik: -2466.953, Max-Change: 0.00080
## Iter: 1 fn: 7912.9099     Pars:   1.25155 -0.47482 -1.23137 -0.16793  0.62257  1.46987  0.55386
## Iter: 2 fn: 7912.9099     Pars:   1.25152 -0.47492 -1.23130 -0.16798  0.62268  1.46987  0.55386
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 25, Log-Lik: -2466.952, Max-Change: 0.00150
## Iter: 1 fn: 7916.2010     Pars:   1.25172 -0.47497 -1.23168 -0.16795  0.62287  1.47023  0.55470
## Iter: 2 fn: 7916.2010     Pars:   1.25177 -0.47502 -1.23163 -0.16800  0.62289  1.47023  0.55470
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 26, Log-Lik: -2466.950, Max-Change: 0.00084
## Iter: 1 fn: 7919.6622     Pars:   1.25194 -0.47507 -1.23187 -0.16800  0.62300  1.47053  0.55549
## Iter: 2 fn: 7919.6622     Pars:   1.25202 -0.47512 -1.23184 -0.16806  0.62300  1.47053  0.55549
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 27, Log-Lik: -2466.949, Max-Change: 0.00079
## Iter: 1 fn: 7922.9492     Pars:   1.25261 -0.47535 -1.23206 -0.16827  0.62306  1.47092  0.55628
## Iter: 2 fn: 7922.9492     Pars:   1.25241 -0.47520 -1.23213 -0.16810  0.62303  1.47091  0.55628
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 28, Log-Lik: -2466.948, Max-Change: 0.00080
## Iter: 1 fn: 7926.1805     Pars:   1.25249 -0.47527 -1.23226 -0.16810  0.62314  1.47110  0.55697
## Iter: 2 fn: 7926.1805     Pars:   1.25252 -0.47531 -1.23224 -0.16815  0.62318  1.47110  0.55697
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 29, Log-Lik: -2466.947, Max-Change: 0.00068
## Iter: 1 fn: 7928.9516     Pars:   1.25260 -0.47531 -1.23240 -0.16812  0.62324  1.47128  0.55762
## Iter: 2 fn: 7928.9516     Pars:   1.25264 -0.47536 -1.23236 -0.16816  0.62324  1.47128  0.55762
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 30, Log-Lik: -2466.946, Max-Change: 0.00065
## Iter: 1 fn: 7931.6324     Pars:   1.25295 -0.47547 -1.23252 -0.16825  0.62329  1.47152  0.55827
## Iter: 2 fn: 7931.6324     Pars:   1.25285 -0.47538 -1.23257 -0.16817  0.62328  1.47152  0.55827
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 31, Log-Lik: -2466.945, Max-Change: 0.00066
## Iter: 1 fn: 7934.2789     Pars:   1.25290 -0.47542 -1.23267 -0.16816  0.62336  1.47174  0.55897
## Iter: 2 fn: 7934.2789     Pars:   1.25293 -0.47546 -1.23265 -0.16821  0.62339  1.47174  0.55897
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 32, Log-Lik: -2466.944, Max-Change: 0.00069
## Iter: 1 fn: 7937.0760     Pars:   1.25302 -0.47547 -1.23282 -0.16818  0.62345  1.47193  0.55961
## Iter: 2 fn: 7937.0760     Pars:   1.25305 -0.47550 -1.23279 -0.16820  0.62345  1.47193  0.55961
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 33, Log-Lik: -2466.944, Max-Change: 0.00064
## Iter: 1 fn: 7939.7258     Pars:   1.25334 -0.47564 -1.23291 -0.16829  0.62350  1.47211  0.56016
## Iter: 2 fn: 7939.7258     Pars:   1.25329 -0.47556 -1.23299 -0.16824  0.62350  1.47211  0.56016
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 34, Log-Lik: -2466.943, Max-Change: 0.00055
## Iter: 1 fn: 7941.9039     Pars:   1.25329 -0.47556 -1.23299 -0.16824  0.62350  1.47221  0.56064
## Iter: 2 fn: 7941.9039     Pars:   1.25329 -0.47556 -1.23299 -0.16824  0.62350  1.47220  0.56064
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 35, Log-Lik: -2466.942, Max-Change: 0.00048
## Iter: 1 fn: 7943.8339     Pars:   1.25329 -0.47556 -1.23300 -0.16824  0.62350  1.47236  0.56119
## Iter: 2 fn: 7943.8339     Pars:   1.25330 -0.47556 -1.23300 -0.16824  0.62351  1.47236  0.56119
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 36, Log-Lik: -2466.942, Max-Change: 0.00055
## Iter: 1 fn: 7946.0576     Pars:   1.25333 -0.47557 -1.23308 -0.16823  0.62354  1.47245  0.56162
## Iter: 2 fn: 7946.0576     Pars:   1.25334 -0.47557 -1.23309 -0.16823  0.62355  1.47244  0.56162
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 37, Log-Lik: -2466.941, Max-Change: 0.00043
## Iter: 1 fn: 7947.7874     Pars:   1.25335 -0.47557 -1.23310 -0.16823  0.62356  1.47259  0.56211
## Iter: 2 fn: 7947.7874     Pars:   1.25335 -0.47557 -1.23311 -0.16823  0.62356  1.47258  0.56212
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 38, Log-Lik: -2466.941, Max-Change: 0.00050
## Iter: 1 fn: 7949.7774     Pars:   1.25336 -0.47557 -1.23313 -0.16823  0.62357  1.47266  0.56250
## Iter: 2 fn: 7949.7774     Pars:   1.25338 -0.47558 -1.23316 -0.16822  0.62359  1.47264  0.56251
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 39, Log-Lik: -2466.941, Max-Change: 0.00039
## Iter: 1 fn: 7951.3430     Pars:   1.25344 -0.47560 -1.23328 -0.16821  0.62365  1.47274  0.56288
## Iter: 2 fn: 7951.3430     Pars:   1.25345 -0.47561 -1.23329 -0.16821  0.62365  1.47273  0.56289
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 40, Log-Lik: -2466.940, Max-Change: 0.00038
## Iter: 1 fn: 7952.8684     Pars:   1.25346 -0.47561 -1.23330 -0.16821  0.62366  1.47283  0.56325
## Iter: 2 fn: 7952.8684     Pars:   1.25347 -0.47561 -1.23331 -0.16821  0.62366  1.47282  0.56325
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 41, Log-Lik: -2466.940, Max-Change: 0.00036
## Iter: 1 fn: 7954.3146     Pars:   1.25348 -0.47561 -1.23332 -0.16821  0.62367  1.47291  0.56359
## Iter: 2 fn: 7954.3146     Pars:   1.25349 -0.47562 -1.23334 -0.16821  0.62368  1.47290  0.56360
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 42, Log-Lik: -2466.940, Max-Change: 0.00035
## Iter: 1 fn: 7955.7125     Pars:   1.25360 -0.47566 -1.23352 -0.16820  0.62377  1.47301  0.56393
## Iter: 2 fn: 7955.7125     Pars:   1.25361 -0.47566 -1.23352 -0.16820  0.62378  1.47300  0.56394
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 43, Log-Lik: -2466.940, Max-Change: 0.00034
## Iter: 1 fn: 7957.0634     Pars:   1.25362 -0.47566 -1.23353 -0.16820  0.62378  1.47309  0.56425
## Iter: 2 fn: 7957.0634     Pars:   1.25362 -0.47567 -1.23354 -0.16820  0.62379  1.47308  0.56426
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 44, Log-Lik: -2466.939, Max-Change: 0.00032
## Iter: 1 fn: 7958.3307     Pars:   1.25363 -0.47567 -1.23355 -0.16820  0.62379  1.47317  0.56455
## Iter: 2 fn: 7958.3307     Pars:   1.25364 -0.47567 -1.23356 -0.16820  0.62380  1.47316  0.56455
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 45, Log-Lik: -2466.939, Max-Change: 0.00030
## Iter: 1 fn: 7959.5306     Pars:   1.25374 -0.47571 -1.23369 -0.16820  0.62386  1.47326  0.56484
## Iter: 2 fn: 7959.5306     Pars:   1.25374 -0.47571 -1.23369 -0.16820  0.62387  1.47325  0.56484
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 46, Log-Lik: -2466.939, Max-Change: 0.00029
## Iter: 1 fn: 7960.6843     Pars:   1.25375 -0.47572 -1.23371 -0.16820  0.62387  1.47333  0.56511
## Iter: 2 fn: 7960.6843     Pars:   1.25376 -0.47572 -1.23371 -0.16820  0.62388  1.47332  0.56512
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 47, Log-Lik: -2466.939, Max-Change: 0.00027
## Iter: 1 fn: 7961.7670     Pars:   1.25377 -0.47572 -1.23373 -0.16820  0.62388  1.47340  0.56536
## Iter: 2 fn: 7961.7670     Pars:   1.25378 -0.47573 -1.23374 -0.16820  0.62389  1.47339  0.56537
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 48, Log-Lik: -2466.939, Max-Change: 0.00026
## Iter: 1 fn: 7962.7933     Pars:   1.25388 -0.47576 -1.23386 -0.16821  0.62395  1.47347  0.56561
## Iter: 2 fn: 7962.7933     Pars:   1.25389 -0.47577 -1.23386 -0.16821  0.62396  1.47347  0.56562
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 49, Log-Lik: -2466.939, Max-Change: 0.00025
## Iter: 1 fn: 7963.7841     Pars:   1.25389 -0.47577 -1.23387 -0.16821  0.62396  1.47354  0.56584
## Iter: 2 fn: 7963.7841     Pars:   1.25390 -0.47577 -1.23388 -0.16821  0.62396  1.47353  0.56585
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 50, Log-Lik: -2466.939, Max-Change: 0.00023
## Iter: 1 fn: 7964.7126     Pars:   1.25391 -0.47578 -1.23389 -0.16821  0.62397  1.47360  0.56606
## Iter: 2 fn: 7964.7126     Pars:   1.25392 -0.47578 -1.23391 -0.16821  0.62398  1.47359  0.56607
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 51, Log-Lik: -2466.939, Max-Change: 0.00022
## Iter: 1 fn: 7965.6069     Pars:   1.25404 -0.47583 -1.23404 -0.16822  0.62405  1.47367  0.56628
## Iter: 2 fn: 7965.6069     Pars:   1.25405 -0.47583 -1.23404 -0.16822  0.62405  1.47366  0.56629
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 52, Log-Lik: -2466.938, Max-Change: 0.00022
## Iter: 1 fn: 7966.4706     Pars:   1.25406 -0.47584 -1.23405 -0.16822  0.62406  1.47373  0.56648
## Iter: 2 fn: 7966.4706     Pars:   1.25406 -0.47584 -1.23406 -0.16823  0.62406  1.47372  0.56649
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 53, Log-Lik: -2466.938, Max-Change: 0.00020
## Iter: 1 fn: 7967.2744     Pars:   1.25407 -0.47584 -1.23406 -0.16823  0.62406  1.47383  0.56663
## Iter: 2 fn: 7967.2744     Pars:   1.25407 -0.47584 -1.23406 -0.16823  0.62406  1.47378  0.56668
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 54, Log-Lik: -2466.938, Max-Change: 0.00019
## Iter: 1 fn: 7968.0433     Pars:   1.25412 -0.47586 -1.23412 -0.16823  0.62409  1.47388  0.56681
## Iter: 2 fn: 7968.0433     Pars:   1.25412 -0.47586 -1.23412 -0.16823  0.62409  1.47384  0.56687
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 55, Log-Lik: -2466.938, Max-Change: 0.00018
## Iter: 1 fn: 7968.7704     Pars:   1.25413 -0.47586 -1.23413 -0.16823  0.62409  1.47393  0.56699
## Iter: 2 fn: 7968.7703     Pars:   1.25413 -0.47586 -1.23413 -0.16823  0.62409  1.47389  0.56704
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 56, Log-Lik: -2466.938, Max-Change: 0.00017
## Iter: 1 fn: 7969.4571     Pars:   1.25414 -0.47587 -1.23414 -0.16823  0.62410  1.47397  0.56715
## Iter: 2 fn: 7969.4571     Pars:   1.25414 -0.47587 -1.23414 -0.16823  0.62410  1.47393  0.56720
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 57, Log-Lik: -2466.938, Max-Change: 0.00016
## Iter: 1 fn: 7970.1093     Pars:   1.25420 -0.47588 -1.23420 -0.16824  0.62413  1.47402  0.56731
## Iter: 2 fn: 7970.1093     Pars:   1.25420 -0.47589 -1.23421 -0.16824  0.62413  1.47398  0.56736
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 58, Log-Lik: -2466.938, Max-Change: 0.00015
## Iter: 1 fn: 7970.7253     Pars:   1.25421 -0.47589 -1.23421 -0.16824  0.62413  1.47407  0.56749
## Iter: 2 fn: 7970.7253     Pars:   1.25421 -0.47589 -1.23422 -0.16824  0.62413  1.47402  0.56751
## solnp--&gt; Completed in 2 iterations
## 
Iteration: 59, Log-Lik: -2466.938, Max-Change: 0.00015
## Iter: 1 fn: 7971.3119     Pars:   1.25422 -0.47589 -1.23423 -0.16824  0.62414  1.47411  0.56763
## solnp--&gt; Completed in 1 iterations
## 
Iteration: 60, Log-Lik: -2466.938, Max-Change: 0.00012
## Iter: 1 fn: 7971.8092     Pars:   1.25425 -0.47590 -1.23425 -0.16824  0.62415  1.47417  0.56777
## solnp--&gt; Completed in 1 iterations
## 
Iteration: 61, Log-Lik: -2466.938, Max-Change: 0.00014
## Iter: 1 fn: 7972.3789     Pars:   1.25426 -0.47590 -1.23427 -0.16824  0.62415  1.47420  0.56790
## solnp--&gt; Completed in 1 iterations
## 
Iteration: 62, Log-Lik: -2466.938, Max-Change: 0.00014
## Iter: 1 fn: 7972.9145     Pars:   1.25427 -0.47590 -1.23428 -0.16824  0.62415  1.47423  0.56803
## solnp--&gt; Completed in 1 iterations
## 
Iteration: 63, Log-Lik: -2466.938, Max-Change: 0.00013
## Iter: 1 fn: 7973.4212     Pars:   1.25433 -0.47592 -1.23435 -0.16824  0.62418  1.47427  0.56815
## solnp--&gt; Completed in 1 iterations
## 
Iteration: 64, Log-Lik: -2466.938, Max-Change: 0.00012
## Iter: 1 fn: 7973.8988     Pars:   1.25434 -0.47592 -1.23436 -0.16824  0.62418  1.47429  0.56827
## solnp--&gt; Completed in 1 iterations
## 
Iteration: 65, Log-Lik: -2466.938, Max-Change: 0.00011
## Iter: 1 fn: 7974.3472     Pars:   1.25435 -0.47592 -1.23438 -0.16824  0.62419  1.47432  0.56837
## solnp--&gt; Completed in 1 iterations
## 
Iteration: 66, Log-Lik: -2466.938, Max-Change: 0.00011
## Iter: 1 fn: 7974.7714     Pars:   1.25441 -0.47594 -1.23444 -0.16824  0.62421  1.47435  0.56847
## solnp--&gt; Completed in 1 iterations
## 
Iteration: 67, Log-Lik: -2466.938, Max-Change: 0.00010
## Iter: 1 fn: 7975.1717     Pars:   1.25442 -0.47594 -1.23445 -0.16824  0.62421  1.47437  0.56857
## solnp--&gt; Completed in 1 iterations
## 
Iteration: 68, Log-Lik: -2466.938, Max-Change: 0.00010
</code></pre>

<pre><code class="r">print(mod3)
</code></pre>

<pre><code>## 
## Call:
## mirt(data = dat, model = model2, itemtype = &quot;Rasch&quot;, optimizer = &quot;solnp&quot;, 
##     solnp_args = solnp_args)
## 
## Full-information item factor analysis with 1 factor(s).
## Converged within 1e-04 tolerance after 68 EM iterations.
## mirt version: 1.19 
## M-step optimizer: solnp 
## EM acceleration: Ramsay
## Number of rectangular quadrature: 61
## 
## Log-likelihood = -2466.938
## AIC = 4947.876; AICc = 4947.988
## BIC = 4982.23; SABIC = 4959.997
## G2 (25) = 21.8, p = 0.6474
## RMSEA = 0, CFI = 1, TLI = 1.068
</code></pre>

<pre><code class="r">coef(mod3)
</code></pre>

<pre><code>## $Item_1
##     a1     d g u
## par  1 1.254 0 1
## 
## $Item_2
##     a1      d g u
## par  1 -0.476 0 1
## 
## $Item_3
##     a1      d g u
## par  1 -1.234 0 1
## 
## $Item_4
##     a1      d g u
## par  1 -0.168 0 1
## 
## $Item_5
##     a1     d g u
## par  1 0.624 0 1
## 
## $GroupPars
##     MEAN_1 COV_11
## par  1.474  0.569
</code></pre>

<pre><code class="r">(ds &lt;- sapply(coef(mod3)[1:5], function(x) x[,&#39;d&#39;]))
</code></pre>

<pre><code>## Item_1 Item_2 Item_3 Item_4 Item_5 
##  1.254 -0.476 -1.234 -0.168  0.624
</code></pre>

<pre><code class="r">sum(ds)
</code></pre>

<pre><code>## [1] 2.775558e-17
</code></pre>

<pre><code class="r">### same as above, but using alabama package optimizers (make use of gradient information, 
## though appears to be more sensitive to starting values)
heq &lt;- function(p, optim_args) sum(p[1:5]) #must sum to 0 for constraint

#start with better starting values
mod3b &lt;- mirt(dat, model2, itemtype = &#39;Rasch&#39;, optimizer = &#39;alabama&#39;, alabama_args=list(heq=heq),
              pars = mod2values(mod3), TOL=1e-5)
</code></pre>

<pre><code>## 
Iteration: 1, Log-Lik: -2466.938, Max-Change: 0.00000
</code></pre>

<pre><code>## Warning: M-step optimizer converged immediately. Solution is either at the ML or
##                      starting values are causing issues and should be adjusted.
</code></pre>

<pre><code class="r">print(mod3b)
</code></pre>

<pre><code>## 
## Call:
## mirt(data = dat, model = model2, itemtype = &quot;Rasch&quot;, optimizer = &quot;alabama&quot;, 
##     pars = mod2values(mod3), TOL = 1e-05, alabama_args = list(heq = heq))
## 
## Full-information item factor analysis with 1 factor(s).
## Converged within 1e-05 tolerance after 1 EM iterations.
## mirt version: 1.19 
## M-step optimizer: alabama 
## EM acceleration: Ramsay
## Number of rectangular quadrature: 61
## 
## Log-likelihood = -2466.938
## AIC = 4947.875; AICc = 4947.988
## BIC = 4982.23; SABIC = 4959.997
## G2 (25) = 21.8, p = 0.6474
## RMSEA = 0, CFI = 1, TLI = 1.068
</code></pre>

<pre><code class="r">coef(mod3b)
</code></pre>

<pre><code>## $Item_1
##     a1     d g u
## par  1 1.254 0 1
## 
## $Item_2
##     a1      d g u
## par  1 -0.476 0 1
## 
## $Item_3
##     a1      d g u
## par  1 -1.234 0 1
## 
## $Item_4
##     a1      d g u
## par  1 -0.168 0 1
## 
## $Item_5
##     a1     d g u
## par  1 0.624 0 1
## 
## $GroupPars
##     MEAN_1 COV_11
## par  1.474  0.569
</code></pre>

<pre><code class="r">(ds &lt;- sapply(coef(mod3b)[1:5], function(x) x[,&#39;d&#39;]))
</code></pre>

<pre><code>## Item_1 Item_2 Item_3 Item_4 Item_5 
##  1.254 -0.476 -1.234 -0.168  0.624
</code></pre>

<pre><code class="r">sum(ds)
</code></pre>

<pre><code>## [1] 2.775558e-17
</code></pre>

</body>

</html>
