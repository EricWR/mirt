<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Name: mixedmirt</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h3>Name: mixedmirt</h3>

<h3>Title: Mixed effects modeling for MIRT models</h3>

<pre><code class="r">#make some data
set.seed(1234)
N &lt;- 750
a &lt;- matrix(rlnorm(10,.3,1),10,1)
d &lt;- matrix(rnorm(10), 10)
Theta &lt;- matrix(sort(rnorm(N)))
pseudoIQ &lt;- Theta * 5 + 100  + rnorm(N, 0 , 5)
pseudoIQ &lt;- (pseudoIQ - mean(pseudoIQ))/10  #rescale variable for numerical stability
group &lt;- factor(rep(c(&#39;G1&#39;,&#39;G2&#39;,&#39;G3&#39;), each = N/3))
data &lt;- simdata(a,d,N, itemtype = rep(&#39;dich&#39;,10), Theta=Theta)
covdata &lt;- data.frame(group, pseudoIQ)
#use parallel computing
mirtCluster()
</code></pre>

<pre><code>## mirtCluster() has already been defined
</code></pre>

<pre><code class="r">#specify IRT model
model &lt;- mirt.model(&#39;Theta = 1-10&#39;)

#model with no person predictors
mod0 &lt;- mirt(data, model, itemtype = &#39;Rasch&#39;)

#group as a fixed effect predictor (aka, uniform dif)
mod1 &lt;- mixedmirt(data, covdata, model, fixed = ~ 0 + group + items)
anova(mod0, mod1)
</code></pre>

<pre><code>## 
## Model 1: mirt(data = data, model = model, itemtype = &quot;Rasch&quot;)
## Model 2: mixedmirt(data = data, covdata = covdata, model = model, fixed = ~0 + 
##     group + items)
</code></pre>

<pre><code>##        AIC     AICc    SABIC      BIC    logLik      X2  df   p
## 1 8826.167 8826.525 8842.059 8876.988 -4402.084     NaN NaN NaN
## 2 8118.155 8118.650 8136.936 8178.216 -4046.077 712.012   2   0
</code></pre>

<pre><code class="r">summary(mod1)
</code></pre>

<pre><code>## 
## Call:
## mixedmirt(data = data, covdata = covdata, model = model, fixed = ~0 + 
##     group + items)
## 
## --------------
## FIXED EFFECTS:
##         Estimate Std.Error z.value
## groupG1   -1.829     0.099 -18.411
## groupG2   -0.659     0.092  -7.149
## groupG3    0.493     0.092   5.361
## 
## --------------
## RANDOM EFFECT COVARIANCE(S):
## Correlations on upper diagonal
## 
## $Theta
##        Theta
## Theta 0.0767
</code></pre>

<pre><code class="r">coef(mod1)
</code></pre>

<pre><code>## $Item_1
##         groupG1 groupG2 groupG3 a1  d  g  u
## par      -1.829  -0.659   0.493  1  0  0  1
## CI_2.5   -2.024  -0.839   0.313 NA NA NA NA
## CI_97.5  -1.635  -0.478   0.674 NA NA NA NA
## 
## $Item_2
##         groupG1 groupG2 groupG3 a1      d  g  u
## par      -1.829  -0.659   0.493  1 -0.170  0  1
## CI_2.5   -2.024  -0.839   0.313 NA -0.403 NA NA
## CI_97.5  -1.635  -0.478   0.674 NA  0.064 NA NA
## 
## $Item_3
##         groupG1 groupG2 groupG3 a1     d  g  u
## par      -1.829  -0.659   0.493  1 0.347  0  1
## CI_2.5   -2.024  -0.839   0.313 NA 0.118 NA NA
## CI_97.5  -1.635  -0.478   0.674 NA 0.576 NA NA
## 
## $Item_4
##         groupG1 groupG2 groupG3 a1     d  g  u
## par      -1.829  -0.659   0.493  1 0.684  0  1
## CI_2.5   -2.024  -0.839   0.313 NA 0.455 NA NA
## CI_97.5  -1.635  -0.478   0.674 NA 0.912 NA NA
## 
## $Item_5
##         groupG1 groupG2 groupG3 a1     d  g  u
## par      -1.829  -0.659   0.493  1 1.315  0  1
## CI_2.5   -2.024  -0.839   0.313 NA 1.081 NA NA
## CI_97.5  -1.635  -0.478   0.674 NA 1.548 NA NA
## 
## $Item_6
##         groupG1 groupG2 groupG3 a1     d  g  u
## par      -1.829  -0.659   0.493  1 0.578  0  1
## CI_2.5   -2.024  -0.839   0.313 NA 0.350 NA NA
## CI_97.5  -1.635  -0.478   0.674 NA 0.807 NA NA
## 
## $Item_7
##         groupG1 groupG2 groupG3 a1      d  g  u
## par      -1.829  -0.659   0.493  1  0.097  0  1
## CI_2.5   -2.024  -0.839   0.313 NA -0.134 NA NA
## CI_97.5  -1.635  -0.478   0.674 NA  0.327 NA NA
## 
## $Item_8
##         groupG1 groupG2 groupG3 a1      d  g  u
## par      -1.829  -0.659   0.493  1 -0.407  0  1
## CI_2.5   -2.024  -0.839   0.313 NA -0.644 NA NA
## CI_97.5  -1.635  -0.478   0.674 NA -0.170 NA NA
## 
## $Item_9
##         groupG1 groupG2 groupG3 a1      d  g  u
## par      -1.829  -0.659   0.493  1 -0.228  0  1
## CI_2.5   -2.024  -0.839   0.313 NA -0.462 NA NA
## CI_97.5  -1.635  -0.478   0.674 NA  0.006 NA NA
## 
## $Item_10
##         groupG1 groupG2 groupG3 a1     d  g  u
## par      -1.829  -0.659   0.493  1 3.588  0  1
## CI_2.5   -2.024  -0.839   0.313 NA 3.256 NA NA
## CI_97.5  -1.635  -0.478   0.674 NA 3.920 NA NA
## 
## $GroupPars
##         MEAN_1 COV_11
## par          0  0.077
## CI_2.5      NA  0.044
## CI_97.5     NA  0.109
</code></pre>

<pre><code class="r">#same model as above in lme4
wide &lt;- data.frame(id=1:nrow(data),data,covdata)
long &lt;- reshape2::melt(wide, id.vars = c(&#39;id&#39;, &#39;group&#39;, &#39;pseudoIQ&#39;))
library(lme4)
</code></pre>

<pre><code>## Loading required package: Matrix
## Loading required package: Rcpp
</code></pre>

<pre><code class="r">lmod0 &lt;- glmer(value ~ 0 + variable + (1|id), long, family = binomial)
</code></pre>

<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl =
## control$checkConv, : Model failed to converge with max|grad| = 0.00153862
## (tol = 0.001, component 6)
</code></pre>

<pre><code class="r">lmod1 &lt;- glmer(value ~ 0 + group + variable + (1|id), long, family = binomial)
anova(lmod0, lmod1)
</code></pre>

<pre><code>## Data: long
## Models:
## lmod0: value ~ 0 + variable + (1 | id)
## lmod1: value ~ 0 + group + variable + (1 | id)
##       Df    AIC    BIC  logLik deviance  Chisq Chi Df Pr(&gt;Chisq)    
## lmod0 11 8839.4 8915.5 -4408.7   8817.4                             
## lmod1 13 8116.0 8206.0 -4045.0   8090.0 727.38      2  &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre>

<pre><code class="r">#model using 2PL items instead of Rasch
mod1b &lt;- mixedmirt(data, covdata, model, fixed = ~ 0 + group + items, itemtype = &#39;2PL&#39;)
anova(mod1, mod1b) #better with 2PL models using all criteria (as expected, given simdata pars)
</code></pre>

<pre><code>## 
## Model 1: mixedmirt(data = data, covdata = covdata, model = model, fixed = ~0 + 
##     group + items)
## Model 2: mixedmirt(data = data, covdata = covdata, model = model, fixed = ~0 + 
##     group + items, itemtype = &quot;2PL&quot;)
</code></pre>

<pre><code>##        AIC     AICc    SABIC      BIC    logLik      X2  df   p
## 1 8118.155 8118.650 8136.936 8178.216 -4046.077     NaN NaN NaN
## 2 7969.381 7970.773 8001.164 8071.023 -3962.691 166.774   9   0
</code></pre>

<pre><code class="r">#continuous predictor with group
mod2 &lt;- mixedmirt(data, covdata, model, fixed = ~ 0 + group + items + pseudoIQ)
summary(mod2)
</code></pre>

<pre><code>## 
## Call:
## mixedmirt(data = data, covdata = covdata, model = model, fixed = ~0 + 
##     group + items + pseudoIQ)
## 
## --------------
## FIXED EFFECTS:
##          Estimate Std.Error z.value
## groupG1    -1.715     0.104 -16.530
## groupG2    -0.656     0.092  -7.127
## groupG3     0.375     0.097   3.856
## pseudoIQ    0.215     0.056   3.862
## 
## --------------
## RANDOM EFFECT COVARIANCE(S):
## Correlations on upper diagonal
## 
## $Theta
##        Theta
## Theta 0.0693
</code></pre>

<pre><code class="r">anova(mod1b, mod2)
</code></pre>

<pre><code>## 
## Model 1: mixedmirt(data = data, covdata = covdata, model = model, fixed = ~0 + 
##     group + items + pseudoIQ)
## Model 2: mixedmirt(data = data, covdata = covdata, model = model, fixed = ~0 + 
##     group + items, itemtype = &quot;2PL&quot;)
</code></pre>

<pre><code>##        AIC     AICc    SABIC      BIC    logLik      X2  df   p
## 1 8104.406 8104.977 8124.631 8169.087 -4038.203     NaN NaN NaN
## 2 7969.381 7970.773 8001.164 8071.023 -3962.691 151.024   8   0
</code></pre>

<pre><code class="r">#view fixed design matrix with and without unique item level intercepts
withint &lt;- mixedmirt(data, covdata, model, fixed = ~ 0 + items + group, return.design = TRUE)
withoutint &lt;- mixedmirt(data, covdata, model, fixed = ~ 0 + group, return.design = TRUE)

#notice that in result above, the intercepts &#39;items1 to items 10&#39; were reassigned to &#39;d&#39;
head(withint$X)
</code></pre>

<pre><code>##     items1 items2 items3 items4 items5 items6 items7 items8 items9 items10
## 1.1      1      0      0      0      0      0      0      0      0       0
## 2.1      1      0      0      0      0      0      0      0      0       0
## 3.1      1      0      0      0      0      0      0      0      0       0
## 4.1      1      0      0      0      0      0      0      0      0       0
## 5.1      1      0      0      0      0      0      0      0      0       0
## 6.1      1      0      0      0      0      0      0      0      0       0
##     groupG2 groupG3
## 1.1       0       0
## 2.1       0       0
## 3.1       0       0
## 4.1       0       0
## 5.1       0       0
## 6.1       0       0
</code></pre>

<pre><code class="r">tail(withint$X)
</code></pre>

<pre><code>##        items1 items2 items3 items4 items5 items6 items7 items8 items9
## 745.10      0      0      0      0      0      0      0      0      0
## 746.10      0      0      0      0      0      0      0      0      0
## 747.10      0      0      0      0      0      0      0      0      0
## 748.10      0      0      0      0      0      0      0      0      0
## 749.10      0      0      0      0      0      0      0      0      0
## 750.10      0      0      0      0      0      0      0      0      0
##        items10 groupG2 groupG3
## 745.10       1       0       1
## 746.10       1       0       1
## 747.10       1       0       1
## 748.10       1       0       1
## 749.10       1       0       1
## 750.10       1       0       1
</code></pre>

<pre><code class="r">head(withoutint$X) #no intercepts design here to be reassigned into item intercepts
</code></pre>

<pre><code>##     groupG1 groupG2 groupG3
## 1.1       1       0       0
## 2.1       1       0       0
## 3.1       1       0       0
## 4.1       1       0       0
## 5.1       1       0       0
## 6.1       1       0       0
</code></pre>

<pre><code class="r">tail(withoutint$X)
</code></pre>

<pre><code>##        groupG1 groupG2 groupG3
## 745.10       0       0       1
## 746.10       0       0       1
## 747.10       0       0       1
## 748.10       0       0       1
## 749.10       0       0       1
## 750.10       0       0       1
</code></pre>

<pre><code class="r">###################################################
### random effects
#make the number of groups much larger
covdata$group &lt;- factor(rep(paste0(&#39;G&#39;,1:50), each = N/50))

#random groups
rmod1 &lt;- mixedmirt(data, covdata, 1, fixed = ~ 0 + items, random = ~ 1|group)
summary(rmod1)
</code></pre>

<pre><code>## 
## Call:
## mixedmirt(data = data, covdata = covdata, model = 1, fixed = ~0 + 
##     items, random = ~1 | group)
## 
## 
## --------------
## RANDOM EFFECT COVARIANCE(S):
## Correlations on upper diagonal
## 
## $Theta
##        F1
## F1 0.0523
## 
## $group
##           COV_group
## COV_group      1.05
</code></pre>

<pre><code class="r">coef(rmod1)
</code></pre>

<pre><code>## $Item_1
##         a1      d  g  u
## par      1 -0.667  0  1
## CI_2.5  NA -0.867 NA NA
## CI_97.5 NA -0.467 NA NA
## 
## $Item_2
##         a1      d  g  u
## par      1 -0.839  0  1
## CI_2.5  NA -1.043 NA NA
## CI_97.5 NA -0.635 NA NA
## 
## $Item_3
##         a1      d  g  u
## par      1 -0.316  0  1
## CI_2.5  NA -0.512 NA NA
## CI_97.5 NA -0.120 NA NA
## 
## $Item_4
##         a1      d  g  u
## par      1  0.026  0  1
## CI_2.5  NA -0.169 NA NA
## CI_97.5 NA  0.220 NA NA
## 
## $Item_5
##         a1     d  g  u
## par      1 0.666  0  1
## CI_2.5  NA 0.466 NA NA
## CI_97.5 NA 0.866 NA NA
## 
## $Item_6
##         a1      d  g  u
## par      1 -0.081  0  1
## CI_2.5  NA -0.276 NA NA
## CI_97.5 NA  0.114 NA NA
## 
## $Item_7
##         a1      d  g  u
## par      1 -0.569  0  1
## CI_2.5  NA -0.768 NA NA
## CI_97.5 NA -0.370 NA NA
## 
## $Item_8
##         a1      d  g  u
## par      1 -1.080  0  1
## CI_2.5  NA -1.289 NA NA
## CI_97.5 NA -0.870 NA NA
## 
## $Item_9
##         a1      d  g  u
## par      1 -0.898  0  1
## CI_2.5  NA -1.103 NA NA
## CI_97.5 NA -0.693 NA NA
## 
## $Item_10
##         a1     d  g  u
## par      1 2.990  0  1
## CI_2.5  NA 2.673 NA NA
## CI_97.5 NA 3.307 NA NA
## 
## $GroupPars
##         MEAN_1 COV_11
## par          0  0.052
## CI_2.5      NA    NaN
## CI_97.5     NA    NaN
## 
## $group
##         COV_group_group
## par               1.050
## CI_2.5            0.623
## CI_97.5           1.477
</code></pre>

<pre><code class="r">#random groups and random items
rmod2 &lt;- mixedmirt(data, covdata, 1, random = list(~ 1|group, ~ 1|items))
summary(rmod2)
</code></pre>

<pre><code>## 
## Call:
## mixedmirt(data = data, covdata = covdata, model = 1, random = list(~1 | 
##     group, ~1 | items))
## 
## --------------
## FIXED EFFECTS:
##             Estimate Std.Error z.value
## (Intercept)   -0.574       NaN     NaN
## 
## --------------
## RANDOM EFFECT COVARIANCE(S):
## Correlations on upper diagonal
## 
## $Theta
##        F1
## F1 0.0564
## 
## $group
##           COV_group
## COV_group     0.887
## 
## $items
##           COV_items
## COV_items      1.07
</code></pre>

<pre><code class="r">eff &lt;- randef(rmod2) #estimate random effects

#random slopes with fixed intercepts (suppressed correlation)
rmod3 &lt;- mixedmirt(data, covdata, 1, fixed = ~ 0 + items, random = ~ -1 + pseudoIQ|group)
summary(rmod3)
</code></pre>

<pre><code>## 
## Call:
## mixedmirt(data = data, covdata = covdata, model = 1, fixed = ~0 + 
##     items, random = ~-1 + pseudoIQ | group)
## 
## 
## --------------
## RANDOM EFFECT COVARIANCE(S):
## Correlations on upper diagonal
## 
## $Theta
##        F1
## F1 0.0638
## 
## $group
##              COV_group COV_pseudoIQ
## COV_group         1.04       0.0000
## COV_pseudoIQ      0.00       0.0427
</code></pre>

<pre><code class="r">eff &lt;- randef(rmod3)
str(eff)
</code></pre>

<pre><code>## List of 2
##  $ Theta: num [1:750, 1] 0.00405 0.03075 -0.0251 0.01071 -0.07207 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr &quot;F1&quot;
##  $ group: num [1:50, 1:2] -2.06 -1.2 -1.43 -1.23 -1.39 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:50] &quot;G1&quot; &quot;G2&quot; &quot;G3&quot; &quot;G4&quot; ...
##   .. ..$ : chr [1:2] &quot;group&quot; &quot;pseudoIQ&quot;
</code></pre>

<pre><code class="r">###################################################
##LLTM, and 2PL version of LLTM
data(SAT12)
data &lt;- key2binary(SAT12,
                   key = c(1,4,5,2,3,1,2,1,3,1,2,4,2,1,5,3,4,4,1,4,3,3,4,1,3,5,1,3,1,5,4,5))
model &lt;- mirt.model(&#39;Theta = 1-32&#39;)

# Suppose that the first 16 items were suspected to be easier than the last 16 items,
#   and we wish to test this item structure hypothesis (more intercept designs are possible
#   by including more columns).
itemdesign &lt;- data.frame(itemorder = factor(c(rep(&#39;easier&#39;, 16), rep(&#39;harder&#39;, 16))))

#notice that the &#39;fixed = ~ ... + items&#39; argument is omitted
LLTM &lt;- mixedmirt(data, model = model, fixed = ~ 0 + itemorder, itemdesign = itemdesign,
   SE = TRUE) # SE argument ensures that the information matrix is computed accurately
summary(LLTM)
</code></pre>

<pre><code>## 
## Call:
## mixedmirt(data = data, model = model, fixed = ~0 + itemorder, 
##     itemdesign = itemdesign, SE = TRUE)
## 
## --------------
## FIXED EFFECTS:
##                 Estimate Std.Error z.value
## itemordereasier    0.153     0.033   4.565
## itemorderharder    0.444     0.034  13.169
## 
## --------------
## RANDOM EFFECT COVARIANCE(S):
## Correlations on upper diagonal
## 
## $Theta
##       Theta
## Theta 0.357
</code></pre>

<pre><code class="r">coef(LLTM)
</code></pre>

<pre><code>## $Item.1
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.2
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.3
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.4
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.5
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.6
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.7
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.8
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.9
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.10
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.11
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.12
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.13
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.14
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.15
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.16
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.17
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.18
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.19
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.20
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.21
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.22
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.23
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.24
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.25
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.26
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.27
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.28
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.29
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.30
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.31
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $Item.32
##         itemordereasier itemorderharder a1  d  g  u
## par               0.153           0.444  1  0  0  1
## CI_2.5            0.087           0.378 NA NA NA NA
## CI_97.5           0.218           0.510 NA NA NA NA
## 
## $GroupPars
##         MEAN_1 COV_11
## par          0  0.357
## CI_2.5      NA  0.300
## CI_97.5     NA  0.414
</code></pre>

<pre><code class="r">wald(LLTM)
</code></pre>

<pre><code>##                                                                                                                                     1
## infoname itemordereasier.1.7.13.19.25.31.37.43.49.55.61.67.73.79.85.91.97.103.109.115.121.127.133.139.145.151.157.163.169.175.181.187
## par                                                                                                                             0.153
##                                                                                                                                     2
## infoname itemorderharder.2.8.14.20.26.32.38.44.50.56.62.68.74.80.86.92.98.104.110.116.122.128.134.140.146.152.158.164.170.176.182.188
## par                                                                                                                             0.444
##                   3
## infoname COV_11.194
## par           0.357
</code></pre>

<pre><code class="r">L &lt;- matrix(c(-1, 1, 0), 1)
wald(LLTM, L) #first half different from second
</code></pre>

<pre><code>##          W df p
## 1 92.15335  1 0
</code></pre>

<pre><code class="r">#compare to items with estimated slopes (2PL)
twoPL &lt;- mixedmirt(data, model = model, fixed = ~ 0 + itemorder, itemtype = &#39;2PL&#39;,
                   itemdesign = itemdesign)
#twoPL not mixing too well (AR should be between .2 and .5), decrease MHcand
twoPL &lt;- mixedmirt(data, model = model, fixed = ~ 0 + itemorder, itemtype = &#39;2PL&#39;,
                  itemdesign = itemdesign, technical = list(MHcand = 0.8))
anova(twoPL, LLTM) #much better fit
</code></pre>

<pre><code>## 
## Model 1: mixedmirt(data = data, model = model, fixed = ~0 + itemorder, 
##     itemdesign = itemdesign, SE = TRUE)
## Model 2: mixedmirt(data = data, model = model, fixed = ~0 + itemorder, 
##     itemtype = &quot;2PL&quot;, itemdesign = itemdesign, technical = list(MHcand = 0.8))
</code></pre>

<pre><code>##        AIC     AICc    SABIC      BIC    logLik       X2  df   p
## 1 25465.14 25465.18 25468.81 25478.33 -12729.57      NaN NaN NaN
## 2 20490.01 20494.22 20531.56 20639.51 -10211.00 5037.129  31   0
</code></pre>

<pre><code class="r">summary(twoPL)
</code></pre>

<pre><code>## 
## Call:
## mixedmirt(data = data, model = model, fixed = ~0 + itemorder, 
##     itemtype = &quot;2PL&quot;, itemdesign = itemdesign, technical = list(MHcand = 0.8))
## 
## --------------
## FIXED EFFECTS:
##                 Estimate Std.Error z.value
## itemordereasier   -1.657     0.063 -26.331
## itemorderharder   -1.632     0.070 -23.199
## 
## --------------
## RANDOM EFFECT COVARIANCE(S):
## Correlations on upper diagonal
## 
## $Theta
##       Theta
## Theta     1
</code></pre>

<pre><code class="r">coef(twoPL)
</code></pre>

<pre><code>## $Item.1
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 0.929  0  0  1
## CI_2.5           -1.781          -1.770 0.711 NA NA NA
## CI_97.5          -1.534          -1.494 1.148 NA NA NA
## 
## $Item.2
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 2.536  0  0  1
## CI_2.5           -1.781          -1.770 2.289 NA NA NA
## CI_97.5          -1.534          -1.494 2.783 NA NA NA
## 
## $Item.3
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 0.997  0  0  1
## CI_2.5           -1.781          -1.770 0.781 NA NA NA
## CI_97.5          -1.534          -1.494 1.213 NA NA NA
## 
## $Item.4
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 1.287  0  0  1
## CI_2.5           -1.781          -1.770 1.055 NA NA NA
## CI_97.5          -1.534          -1.494 1.519 NA NA NA
## 
## $Item.5
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 2.714  0  0  1
## CI_2.5           -1.781          -1.770 2.457 NA NA NA
## CI_97.5          -1.534          -1.494 2.971 NA NA NA
## 
## $Item.6
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 0.418  0  0  1
## CI_2.5           -1.781          -1.770 0.195 NA NA NA
## CI_97.5          -1.534          -1.494 0.640 NA NA NA
## 
## $Item.7
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 3.937  0  0  1
## CI_2.5           -1.781          -1.770 3.698 NA NA NA
## CI_97.5          -1.534          -1.494 4.176 NA NA NA
## 
## $Item.8
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 0.510  0  0  1
## CI_2.5           -1.781          -1.770 0.293 NA NA NA
## CI_97.5          -1.534          -1.494 0.727 NA NA NA
## 
## $Item.9
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 5.495  0  0  1
## CI_2.5           -1.781          -1.770 5.282 NA NA NA
## CI_97.5          -1.534          -1.494 5.708 NA NA NA
## 
## $Item.10
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 1.632  0  0  1
## CI_2.5           -1.781          -1.770 1.390 NA NA NA
## CI_97.5          -1.534          -1.494 1.875 NA NA NA
## 
## $Item.11
##         itemordereasier itemorderharder     a1  d  g  u
## par              -1.657          -1.632 13.706  0  0  1
## CI_2.5           -1.781          -1.770 12.068 NA NA NA
## CI_97.5          -1.534          -1.494 15.345 NA NA NA
## 
## $Item.12
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 1.240  0  0  1
## CI_2.5           -1.781          -1.770 1.005 NA NA NA
## CI_97.5          -1.534          -1.494 1.475 NA NA NA
## 
## $Item.13
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 3.053  0  0  1
## CI_2.5           -1.781          -1.770 2.822 NA NA NA
## CI_97.5          -1.534          -1.494 3.285 NA NA NA
## 
## $Item.14
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 3.508  0  0  1
## CI_2.5           -1.781          -1.770 3.246 NA NA NA
## CI_97.5          -1.534          -1.494 3.769 NA NA NA
## 
## $Item.15
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 4.789  0  0  1
## CI_2.5           -1.781          -1.770   NaN NA NA NA
## CI_97.5          -1.534          -1.494   NaN NA NA NA
## 
## $Item.16
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 1.469  0  0  1
## CI_2.5           -1.781          -1.770 1.231 NA NA NA
## CI_97.5          -1.534          -1.494 1.707 NA NA NA
## 
## $Item.17
##         itemordereasier itemorderharder     a1  d  g  u
## par              -1.657          -1.632 10.048  0  0  1
## CI_2.5           -1.781          -1.770  9.330 NA NA NA
## CI_97.5          -1.534          -1.494 10.766 NA NA NA
## 
## $Item.18
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 1.412  0  0  1
## CI_2.5           -1.781          -1.770 1.191 NA NA NA
## CI_97.5          -1.534          -1.494 1.633 NA NA NA
## 
## $Item.19
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 2.161  0  0  1
## CI_2.5           -1.781          -1.770 1.906 NA NA NA
## CI_97.5          -1.534          -1.494 2.415 NA NA NA
## 
## $Item.20
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 5.832  0  0  1
## CI_2.5           -1.781          -1.770   NaN NA NA NA
## CI_97.5          -1.534          -1.494   NaN NA NA NA
## 
## $Item.21
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 6.415  0  0  1
## CI_2.5           -1.781          -1.770   NaN NA NA NA
## CI_97.5          -1.534          -1.494   NaN NA NA NA
## 
## $Item.22
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 7.925  0  0  1
## CI_2.5           -1.781          -1.770 7.430 NA NA NA
## CI_97.5          -1.534          -1.494 8.420 NA NA NA
## 
## $Item.23
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 0.979  0  0  1
## CI_2.5           -1.781          -1.770 0.754 NA NA NA
## CI_97.5          -1.534          -1.494 1.204 NA NA NA
## 
## $Item.24
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 3.646  0  0  1
## CI_2.5           -1.781          -1.770 3.416 NA NA NA
## CI_97.5          -1.534          -1.494 3.877 NA NA NA
## 
## $Item.25
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 1.294  0  0  1
## CI_2.5           -1.781          -1.770 1.063 NA NA NA
## CI_97.5          -1.534          -1.494 1.525 NA NA NA
## 
## $Item.26
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 1.907  0  0  1
## CI_2.5           -1.781          -1.770 1.683 NA NA NA
## CI_97.5          -1.534          -1.494 2.131 NA NA NA
## 
## $Item.27
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 5.728  0  0  1
## CI_2.5           -1.781          -1.770   NaN NA NA NA
## CI_97.5          -1.534          -1.494   NaN NA NA NA
## 
## $Item.28
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 2.125  0  0  1
## CI_2.5           -1.781          -1.770 1.877 NA NA NA
## CI_97.5          -1.534          -1.494 2.373 NA NA NA
## 
## $Item.29
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 1.163  0  0  1
## CI_2.5           -1.781          -1.770 0.941 NA NA NA
## CI_97.5          -1.534          -1.494 1.385 NA NA NA
## 
## $Item.30
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 1.438  0  0  1
## CI_2.5           -1.781          -1.770 1.195 NA NA NA
## CI_97.5          -1.534          -1.494 1.682 NA NA NA
## 
## $Item.31
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.657          -1.632 5.282  0  0  1
## CI_2.5           -1.781          -1.770 5.111 NA NA NA
## CI_97.5          -1.534          -1.494 5.454 NA NA NA
## 
## $Item.32
##         itemordereasier itemorderharder     a1  d  g  u
## par              -1.657          -1.632  0.088  0  0  1
## CI_2.5           -1.781          -1.770 -0.158 NA NA NA
## CI_97.5          -1.534          -1.494  0.335 NA NA NA
## 
## $GroupPars
##         MEAN_1 COV_11
## par          0      1
## CI_2.5      NA     NA
## CI_97.5     NA     NA
</code></pre>

<pre><code class="r">wald(twoPL)
</code></pre>

<pre><code>##                                                                                                                                     1
## infoname itemordereasier.1.7.13.19.25.31.37.43.49.55.61.67.73.79.85.91.97.103.109.115.121.127.133.139.145.151.157.163.169.175.181.187
## par                                                                                                                            -1.657
##                                                                                                                                     2
## infoname itemorderharder.2.8.14.20.26.32.38.44.50.56.62.68.74.80.86.92.98.104.110.116.122.128.134.140.146.152.158.164.170.176.182.188
## par                                                                                                                            -1.632
##               3      4      5      6      7      8      9     10     11
## infoname   a1.3   a1.9  a1.15  a1.21  a1.27  a1.33  a1.39  a1.45  a1.51
## par       0.929  2.536  0.997  1.287  2.714  0.418  3.937  0.510  5.495
##              12     13     14     15     16     17     18     19     20
## infoname  a1.57  a1.63  a1.69  a1.75  a1.81  a1.87  a1.93  a1.99 a1.105
## par       1.632 13.706  1.240  3.053  3.508  4.789  1.469 10.048  1.412
##              21     22     23     24     25     26     27     28     29
## infoname a1.111 a1.117 a1.123 a1.129 a1.135 a1.141 a1.147 a1.153 a1.159
## par       2.161  5.832  6.415  7.925  0.979  3.646  1.294  1.907  5.728
##              30     31     32     33     34
## infoname a1.165 a1.171 a1.177 a1.183 a1.189
## par       2.125  1.163  1.438  5.282  0.088
</code></pre>

<pre><code class="r">L &lt;- matrix(0, 1, 34)
L[1, 1] &lt;- 1
L[1, 2] &lt;- -1
wald(twoPL, L) #n.s., which is the correct conclusion. Rasch approach gave wrong inference
</code></pre>

<pre><code>##            W df         p
## 1 0.07593067  1 0.7828897
</code></pre>

<pre><code class="r">##LLTM with item error term
LLTMwithError &lt;- mixedmirt(data, model = model, fixed = ~ 0 + itemorder, random = ~ 1|items,
    itemdesign = itemdesign)
summary(LLTMwithError)
</code></pre>

<pre><code>## 
## Call:
## mixedmirt(data = data, model = model, fixed = ~0 + itemorder, 
##     random = ~1 | items, itemdesign = itemdesign)
## 
## --------------
## FIXED EFFECTS:
##                 Estimate Std.Error z.value
## itemordereasier    0.206     0.066   3.115
## itemorderharder    0.361     0.087   4.124
## 
## --------------
## RANDOM EFFECT COVARIANCE(S):
## Correlations on upper diagonal
## 
## $Theta
##       Theta
## Theta 0.795
## 
## $items
##           COV_items
## COV_items      2.47
</code></pre>

<pre><code class="r">#large item level variance after itemorder is regressed; not a great predictor of item difficulty
coef(LLTMwithError)
</code></pre>

<pre><code>## $Item.1
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.2
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.3
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.4
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.5
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.6
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.7
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.8
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.9
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.10
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.11
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.12
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.13
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.14
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.15
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.16
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.17
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.18
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.19
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.20
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.21
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.22
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.23
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.24
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.25
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.26
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.27
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.28
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.29
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.30
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.31
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $Item.32
##         itemordereasier itemorderharder a1  d  g  u
## par               0.206           0.361  1  0  0  1
## CI_2.5            0.076           0.189 NA NA NA NA
## CI_97.5           0.335           0.532 NA NA NA NA
## 
## $GroupPars
##         MEAN_1 COV_11
## par          0  0.795
## CI_2.5      NA  0.662
## CI_97.5     NA  0.928
## 
## $items
##         COV_items_items
## par               2.468
## CI_2.5            1.263
## CI_97.5           3.674
</code></pre>

<pre><code class="r">###################################################
### Polytomous example

#make an arbitrary group difference
covdat &lt;- data.frame(group = rep(c(&#39;m&#39;, &#39;f&#39;), nrow(Science)/2))

#partial credit model
mod &lt;- mixedmirt(Science, covdat, model=1, fixed = ~ 0 + group)
coef(mod)
</code></pre>

<pre><code>## $Comfort
##         groupm a1 ak0 ak1 ak2 ak3 d0    d1    d2    d3
## par     -0.034  1   0   1   2   3  0 3.096 5.707 4.334
## CI_2.5  -0.285 NA  NA  NA  NA  NA NA 2.069 4.644 3.210
## CI_97.5  0.217 NA  NA  NA  NA  NA NA 4.123 6.770 5.457
## 
## $Work
##         groupm a1 ak0 ak1 ak2 ak3 d0    d1    d2    d3
## par     -0.034  1   0   1   2   3  0 1.912 2.839 0.996
## CI_2.5  -0.285 NA  NA  NA  NA  NA NA 1.441 2.282 0.298
## CI_97.5  0.217 NA  NA  NA  NA  NA NA 2.382 3.395 1.693
## 
## $Future
##         groupm a1 ak0 ak1 ak2 ak3 d0    d1    d2    d3
## par     -0.034  1   0   1   2   3  0 2.661 4.098 2.978
## CI_2.5  -0.285 NA  NA  NA  NA  NA NA 2.011 3.376 2.167
## CI_97.5  0.217 NA  NA  NA  NA  NA NA 3.310 4.820 3.790
## 
## $Benefit
##         groupm a1 ak0 ak1 ak2 ak3 d0    d1    d2    d3
## par     -0.034  1   0   1   2   3  0 2.464 3.380 2.037
## CI_2.5  -0.285 NA  NA  NA  NA  NA NA 1.919 2.750 1.299
## CI_97.5  0.217 NA  NA  NA  NA  NA NA 3.009 4.009 2.775
## 
## $GroupPars
##         MEAN_1 COV_11
## par          0  1.001
## CI_2.5      NA  0.678
## CI_97.5     NA  1.324
</code></pre>

<pre><code class="r">#gpcm to estimate slopes
mod2 &lt;- mixedmirt(Science, covdat, model=1, fixed = ~ 0 + group,
                 itemtype = &#39;gpcm&#39;)
summary(mod2)
</code></pre>

<pre><code>## 
## Call:
## mixedmirt(data = Science, covdata = covdat, model = 1, fixed = ~0 + 
##     group, itemtype = &quot;gpcm&quot;)
## 
## --------------
## FIXED EFFECTS:
##        Estimate Std.Error z.value
## groupm   -0.158     0.115   -1.38
## 
## --------------
## RANDOM EFFECT COVARIANCE(S):
## Correlations on upper diagonal
## 
## $Theta
##    F1
## F1  1
</code></pre>

<pre><code class="r">anova(mod, mod2)
</code></pre>

<pre><code>## 
## Model 1: mixedmirt(data = Science, covdata = covdat, model = 1, fixed = ~0 + 
##     group)
## Model 2: mixedmirt(data = Science, covdata = covdat, model = 1, fixed = ~0 + 
##     group, itemtype = &quot;gpcm&quot;)
</code></pre>

<pre><code>##        AIC     AICc    SABIC      BIC    logLik     X2  df      p
## 1 3265.941 3267.055 3277.117 3321.538 -1618.970    NaN NaN    NaN
## 2 3261.099 3262.735 3274.670 3328.610 -1613.549 10.842   3 0.0126
</code></pre>

<pre><code class="r">#graded model
mod3 &lt;- mixedmirt(Science, covdat, model=1, fixed = ~ 0 + group,
                 itemtype = &#39;graded&#39;)
coef(mod3)
</code></pre>

<pre><code>## $Comfort
##         groupm    a1    d1    d2     d3
## par     -0.207 1.010 4.937 2.722 -1.354
## CI_2.5  -0.524 0.662 3.976 2.274 -1.693
## CI_97.5  0.110 1.359 5.898 3.171 -1.014
## 
## $Work
##         groupm    a1    d1    d2     d3
## par     -0.207 1.207 3.013 0.997 -2.154
## CI_2.5  -0.524 0.865 2.533 0.684 -2.580
## CI_97.5  0.110 1.550 3.492 1.311 -1.729
## 
## $Future
##         groupm    a1    d1    d2     d3
## par     -0.207 2.494 5.615 2.441 -1.976
## CI_2.5  -0.524 1.357 3.875 1.574 -2.727
## CI_97.5  0.110 3.630 7.356 3.309 -1.225
## 
## $Benefit
##         groupm    a1    d1    d2     d3
## par     -0.207 1.068 3.429 1.085 -1.575
## CI_2.5  -0.524 0.683 2.869 0.776 -1.948
## CI_97.5  0.110 1.452 3.990 1.395 -1.202
## 
## $GroupPars
##         MEAN_1 COV_11
## par          0      1
## CI_2.5      NA     NA
## CI_97.5     NA     NA
</code></pre>

<pre><code class="r">###################################################
# latent regression with Rasch and 2PL models

set.seed(1)
n &lt;- 300
a &lt;- matrix(1, 10)
d &lt;- matrix(rnorm(10))
Theta &lt;- matrix(c(rnorm(n, 0), rnorm(n, 1), rnorm(n, 2)))
covdata &lt;- data.frame(group=rep(c(&#39;g1&#39;,&#39;g2&#39;,&#39;g3&#39;), each=n))
dat &lt;- simdata(a, d, N=n*3, Theta=Theta, itemtype = &#39;dich&#39;)

#had we known the latent abilities, we could have computed the regression coefs
summary(lm(Theta ~ covdata$group))
</code></pre>

<pre><code>## 
## Call:
## lm(formula = Theta ~ covdata$group)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.9871 -0.6851 -0.0427  0.7170  3.8313 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      0.04434    0.05970   0.743    0.458    
## covdata$groupg2  0.93468    0.08443  11.071   &lt;2e-16 ***
## covdata$groupg3  1.88134    0.08443  22.284   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.034 on 897 degrees of freedom
## Multiple R-squared:  0.3563, Adjusted R-squared:  0.3549 
## F-statistic: 248.3 on 2 and 897 DF,  p-value: &lt; 2.2e-16
</code></pre>

<pre><code class="r">#but all we have is observed test data. Latent regression helps to recover these coefs
#Rasch model approach (and mirt equivalent)
rmod0 &lt;- mirt(dat, 1, &#39;Rasch&#39;) # unconditional

# these two models are equivalent
rmod1a &lt;- mirt(dat, 1, &#39;Rasch&#39;, covdata = covdata, formula = ~ group)
rmod1b &lt;- mixedmirt(dat, covdata, 1, fixed = ~ 0 + items + group)
anova(rmod0, rmod1b)
</code></pre>

<pre><code>## 
## Model 1: mirt(data = dat, model = 1, itemtype = &quot;Rasch&quot;)
## Model 2: mixedmirt(data = dat, covdata = covdata, model = 1, fixed = ~0 + 
##     items + group)
</code></pre>

<pre><code>##        AIC     AICc    SABIC      BIC    logLik     X2  df   p
## 1 9743.151 9743.448 9761.043 9795.977 -4860.576    NaN NaN NaN
## 2 9494.401 9494.811 9515.546 9556.832 -4734.200 252.75   2   0
</code></pre>

<pre><code class="r">coef(rmod1a, simplify=TRUE)
</code></pre>

<pre><code>## $items
##         a1      d g u
## Item_1   1 -0.437 0 1
## Item_2   1  0.257 0 1
## Item_3   1 -0.555 0 1
## Item_4   1  1.758 0 1
## Item_5   1  0.416 0 1
## Item_6   1 -0.736 0 1
## Item_7   1  0.690 0 1
## Item_8   1  0.793 0 1
## Item_9   1  0.674 0 1
## Item_10  1 -0.251 0 1
## 
## $groupPars
## $groupPars$means
## MEAN_1 
##      0 
## 
## $groupPars$cov
##       F1
## F1 0.981
## 
## 
## $lr.betas
##                F1
## (Intercept) 0.000
## groupg2     0.810
## groupg3     1.776
</code></pre>

<pre><code class="r">summary(rmod1b)
</code></pre>

<pre><code>## 
## Call:
## mixedmirt(data = dat, covdata = covdata, model = 1, fixed = ~0 + 
##     items + group)
## 
## --------------
## FIXED EFFECTS:
##         Estimate Std.Error z.value
## groupg2    0.810     0.099   8.142
## groupg3    1.782     0.113  15.753
## 
## --------------
## RANDOM EFFECT COVARIANCE(S):
## Correlations on upper diagonal
## 
## $Theta
##       F1
## F1 0.954
</code></pre>

<pre><code class="r"># 2PL, requires different input to allow Theta variance to remain fixed
mod0 &lt;- mirt(dat, 1) # unconditional
mod1a &lt;- mirt(dat, 1, covdata = covdata, formula = ~ group, itemtype = &#39;2PL&#39;)
mod1b &lt;- mixedmirt(dat, covdata, 1, fixed = ~ 0 + items, lr.fixed = ~group, itemtype = &#39;2PL&#39;)
anova(mod0, mod1b)
</code></pre>

<pre><code>## 
## Model 1: mirt(data = dat, model = 1)
## Model 2: mixedmirt(data = dat, covdata = covdata, model = 1, fixed = ~0 + 
##     items, itemtype = &quot;2PL&quot;, lr.fixed = ~group)
</code></pre>

<pre><code>##        AIC     AICc    SABIC      BIC    logLik      X2  df   p
## 1 9743.773 9744.729 9776.304 9839.821 -4851.887     NaN NaN NaN
## 2 9492.867 9494.021 9528.651 9598.520 -4724.434 254.906   2   0
</code></pre>

<pre><code class="r">coef(mod1a)$lr.betas
</code></pre>

<pre><code>##                F1
## (Intercept) 0.000
## groupg2     0.815
## groupg3     1.800
</code></pre>

<pre><code class="r">summary(mod1b)
</code></pre>

<pre><code>## 
## Call:
## mixedmirt(data = dat, covdata = covdata, model = 1, fixed = ~0 + 
##     items, itemtype = &quot;2PL&quot;, lr.fixed = ~group)
## 
## 
## --------------
## RANDOM EFFECT COVARIANCE(S):
## Correlations on upper diagonal
## 
## $Theta
##    F1
## F1  1
## 
## --------------
## LATENT REGRESSION FIXED EFFECTS:
## 
##                F1
## (Intercept) 0.000
## groupg2     0.846
## groupg3     1.820
## 
##             Std.Error_F1   z_F1
## (Intercept)           NA     NA
## groupg2            0.095  8.955
## groupg3            0.100 18.267
</code></pre>

<pre><code class="r"># specifying specific regression effects is accomplished by passing a list of formula
model &lt;- mirt.model(&#39;F1 = 1-5
                     F2 = 6-10&#39;)
covdata$contvar &lt;- rnorm(nrow(covdata))
mod2 &lt;- mirt(dat, model, itemtype = &#39;Rasch&#39;, covdata=covdata,
        formula = list(F1 = ~ group + contvar, F2 = ~ group))
coef(mod2)[11:12]
</code></pre>

<pre><code>## $GroupPars
##     MEAN_1 MEAN_2 COV_11 COV_21 COV_22
## par      0      0  0.893      0  0.702
## 
## $lr.betas
##                 F1    F2
## (Intercept)  0.000 0.000
## groupg2      0.832 0.743
## groupg3      1.623 1.745
## contvar     -0.002 0.000
</code></pre>

<pre><code class="r">mod2b &lt;- mixedmirt(dat, covdata, model, fixed = ~ 0 + items,
        lr.fixed = list(F1 = ~ group + contvar, F2 = ~ group))
summary(mod2b)
</code></pre>

<pre><code>## 
## Call:
## mixedmirt(data = dat, covdata = covdata, model = model, fixed = ~0 + 
##     items, lr.fixed = list(F1 = ~group + contvar, F2 = ~group))
## 
## 
## --------------
## RANDOM EFFECT COVARIANCE(S):
## Correlations on upper diagonal
## 
## $Theta
##      F1   F2
## F1 1.07 0.00
## F2 0.00 0.76
## 
## --------------
## LATENT REGRESSION FIXED EFFECTS:
## 
##                 F1    F2
## (Intercept)  0.000 0.000
## groupg2      0.820 0.688
## groupg3      1.664 1.742
## contvar     -0.012 0.000
## 
##             Std.Error_F1 Std.Error_F2   z_F1  z_F2
## (Intercept)           NA           NA     NA    NA
## groupg2            0.066         0.09 12.485 7.657
## groupg3            0.041          NaN 40.871   NaN
## contvar            0.041           NA -0.293    NA
</code></pre>

<pre><code class="r">####################################################
## Simulated Multilevel Rasch Model

set.seed(1)
N &lt;- 2000
a &lt;- matrix(rep(1,10),10,1)
d &lt;- matrix(rnorm(10))
cluster = 100
random_intercept = rnorm(cluster,0,1)
Theta = numeric()
for (i in 1:cluster)
    Theta &lt;- c(Theta, rnorm(N/cluster,0,1) + random_intercept[i])

group = factor(rep(paste0(&#39;G&#39;,1:cluster), each = N/cluster))
covdata &lt;- data.frame(group)
dat &lt;- simdata(a,d,N, itemtype = rep(&#39;dich&#39;,10), Theta=matrix(Theta))

# null model
mod1 &lt;- mixedmirt(dat, covdata, 1, fixed = ~ 0 + items, random = ~ 1|group)
summary(mod1)
</code></pre>

<pre><code>## 
## Call:
## mixedmirt(data = dat, covdata = covdata, model = 1, fixed = ~0 + 
##     items, random = ~1 | group)
## 
## 
## --------------
## RANDOM EFFECT COVARIANCE(S):
## Correlations on upper diagonal
## 
## $Theta
##       F1
## F1 0.993
## 
## $group
##           COV_group
## COV_group     0.665
</code></pre>

<pre><code class="r"># include level 2 predictor for &#39;group&#39; variance
covdata$group_pred &lt;- rep(random_intercept, each = N/cluster)
mod2 &lt;- mixedmirt(dat, covdata, 1, fixed = ~ 0 + items + group_pred, random = ~ 1|group)

# including group means predicts nearly all variability in &#39;group&#39;
summary(mod2)
</code></pre>

<pre><code>## 
## Call:
## mixedmirt(data = dat, covdata = covdata, model = 1, fixed = ~0 + 
##     items + group_pred, random = ~1 | group)
## 
## --------------
## FIXED EFFECTS:
##            Estimate Std.Error z.value
## group_pred     0.97     0.035  27.497
## 
## --------------
## RANDOM EFFECT COVARIANCE(S):
## Correlations on upper diagonal
## 
## $Theta
##       F1
## F1 0.984
## 
## $group
##           COV_group
## COV_group     0.025
</code></pre>

<pre><code class="r">anova(mod1, mod2)
</code></pre>

<pre><code>## 
## Model 1: mixedmirt(data = dat, covdata = covdata, model = 1, fixed = ~0 + 
##     items, random = ~1 | group)
## Model 2: mixedmirt(data = dat, covdata = covdata, model = 1, fixed = ~0 + 
##     items + group_pred, random = ~1 | group)
</code></pre>

<pre><code>##        AIC     AICc    SABIC      BIC    logLik      X2  df   p
## 1 23679.15 23679.31 23708.24 23746.36 -11827.58     NaN NaN NaN
## 2 22907.81 22908.00 22939.32 22980.63 -11440.91 773.338   1   0
</code></pre>

</body>

</html>
