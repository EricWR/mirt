<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Name: mixedmirt</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h3>Name: mixedmirt</h3>

<h3>Title: Mixed effects modeling for MIRT models</h3>

<pre><code class="r">#make some data
set.seed(1234)
N &lt;- 750
a &lt;- matrix(rlnorm(10,.3,1),10,1)
d &lt;- matrix(rnorm(10), 10)
Theta &lt;- matrix(sort(rnorm(N)))
pseudoIQ &lt;- Theta * 5 + 100  + rnorm(N, 0 , 5)
pseudoIQ &lt;- (pseudoIQ - mean(pseudoIQ))/10  #rescale variable for numerical stability
group &lt;- factor(rep(c(&#39;G1&#39;,&#39;G2&#39;,&#39;G3&#39;), each = N/3))
data &lt;- simdata(a,d,N, itemtype = rep(&#39;dich&#39;,10), Theta=Theta)
covdata &lt;- data.frame(group, pseudoIQ)
#use parallel computing
mirtCluster()
</code></pre>

<pre><code>## mirtCluster() has already been defined
</code></pre>

<pre><code class="r">#specify IRT model
model &lt;- mirt.model(&#39;Theta = 1-10&#39;)

#model with no person predictors
mod0 &lt;- mirt(data, model, itemtype = &#39;Rasch&#39;)

#group as a fixed effect predictor (aka, uniform dif)
mod1 &lt;- mixedmirt(data, covdata, model, fixed = ~ 0 + group + items)
anova(mod0, mod1)
</code></pre>

<pre><code>## 
## Model 1: mirt(data = data, model = model, itemtype = &quot;Rasch&quot;)
## Model 2: mixedmirt(data = data, covdata = covdata, model = model, fixed = ~0 + 
##     group + items)
</code></pre>

<pre><code>##    AIC AICc SABIC  BIC logLik    X2  df   p
## 1 8826 8827  8842 8877  -4402   NaN NaN NaN
## 2 8118 8119  8137 8178  -4046 711.9   2   0
</code></pre>

<pre><code class="r">summary(mod1)
</code></pre>

<pre><code>## 
## Call:
## mixedmirt(data = data, covdata = covdata, model = model, fixed = ~0 + 
##     group + items)
## 
## --------------
## FIXED EFFECTS:
##         Estimate Std.Error z.value
## groupG1   -1.837     0.100 -18.431
## groupG2   -0.661     0.092  -7.202
## groupG3    0.494     0.092   5.357
## 
## --------------
## RANDOM EFFECT COVARIANCE(S):
## Correlations on upper diagonal
## 
## $Theta
##        Theta
## Theta 0.0913
</code></pre>

<pre><code class="r">coef(mod1)
</code></pre>

<pre><code>## $Item_1
##         groupG1 groupG2 groupG3 a1  d  g  u
## par      -1.837  -0.661   0.494  1  0  0  1
## CI_2.5   -2.032  -0.841   0.313 NA NA NA NA
## CI_97.5  -1.641  -0.481   0.675 NA NA NA NA
## 
## $Item_2
##         groupG1 groupG2 groupG3 a1      d  g  u
## par      -1.837  -0.661   0.494  1 -0.170  0  1
## CI_2.5   -2.032  -0.841   0.313 NA -0.404 NA NA
## CI_97.5  -1.641  -0.481   0.675 NA  0.063 NA NA
## 
## $Item_3
##         groupG1 groupG2 groupG3 a1     d  g  u
## par      -1.837  -0.661   0.494  1 0.348  0  1
## CI_2.5   -2.032  -0.841   0.313 NA 0.118 NA NA
## CI_97.5  -1.641  -0.481   0.675 NA 0.577 NA NA
## 
## $Item_4
##         groupG1 groupG2 groupG3 a1     d  g  u
## par      -1.837  -0.661   0.494  1 0.686  0  1
## CI_2.5   -2.032  -0.841   0.313 NA 0.457 NA NA
## CI_97.5  -1.641  -0.481   0.675 NA 0.915 NA NA
## 
## $Item_5
##         groupG1 groupG2 groupG3 a1     d  g  u
## par      -1.837  -0.661   0.494  1 1.318  0  1
## CI_2.5   -2.032  -0.841   0.313 NA 1.085 NA NA
## CI_97.5  -1.641  -0.481   0.675 NA 1.551 NA NA
## 
## $Item_6
##         groupG1 groupG2 groupG3 a1     d  g  u
## par      -1.837  -0.661   0.494  1 0.580  0  1
## CI_2.5   -2.032  -0.841   0.313 NA 0.351 NA NA
## CI_97.5  -1.641  -0.481   0.675 NA 0.809 NA NA
## 
## $Item_7
##         groupG1 groupG2 groupG3 a1      d  g  u
## par      -1.837  -0.661   0.494  1  0.097  0  1
## CI_2.5   -2.032  -0.841   0.313 NA -0.134 NA NA
## CI_97.5  -1.641  -0.481   0.675 NA  0.328 NA NA
## 
## $Item_8
##         groupG1 groupG2 groupG3 a1      d  g  u
## par      -1.837  -0.661   0.494  1 -0.408  0  1
## CI_2.5   -2.032  -0.841   0.313 NA -0.645 NA NA
## CI_97.5  -1.641  -0.481   0.675 NA -0.171 NA NA
## 
## $Item_9
##         groupG1 groupG2 groupG3 a1      d  g  u
## par      -1.837  -0.661   0.494  1 -0.228  0  1
## CI_2.5   -2.032  -0.841   0.313 NA -0.463 NA NA
## CI_97.5  -1.641  -0.481   0.675 NA  0.006 NA NA
## 
## $Item_10
##         groupG1 groupG2 groupG3 a1     d  g  u
## par      -1.837  -0.661   0.494  1 3.596  0  1
## CI_2.5   -2.032  -0.841   0.313 NA 3.266 NA NA
## CI_97.5  -1.641  -0.481   0.675 NA 3.927 NA NA
## 
## $GroupPars
##         MEAN_1 COV_11
## par          0  0.091
## CI_2.5      NA    NaN
## CI_97.5     NA    NaN
</code></pre>

<pre><code class="r">#same model as above in lme4
wide &lt;- data.frame(id=1:nrow(data),data,covdata)
long &lt;- reshape2::melt(wide, id.vars = c(&#39;id&#39;, &#39;group&#39;, &#39;pseudoIQ&#39;))
library(lme4)
</code></pre>

<pre><code>## Loading required package: Matrix
## Loading required package: Rcpp
</code></pre>

<pre><code class="r">lmod0 &lt;- glmer(value ~ 0 + variable + (1|id), long, family = binomial)
</code></pre>

<pre><code>## Warning: Model failed to converge with max|grad| = 0.00153862 (tol =
## 0.001, component 6)
</code></pre>

<pre><code class="r">lmod1 &lt;- glmer(value ~ 0 + group + variable + (1|id), long, family = binomial)
anova(lmod0, lmod1)
</code></pre>

<pre><code>## Data: long
## Models:
## lmod0: value ~ 0 + variable + (1 | id)
## lmod1: value ~ 0 + group + variable + (1 | id)
##       Df  AIC  BIC logLik deviance Chisq Chi Df Pr(&gt;Chisq)    
## lmod0 11 8839 8916  -4409     8817                            
## lmod1 13 8116 8206  -4045     8090   727      2     &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre>

<pre><code class="r">#model using 2PL items instead of Rasch
mod1b &lt;- mixedmirt(data, covdata, model, fixed = ~ 0 + group + items, itemtype = &#39;2PL&#39;)
anova(mod1, mod1b) #better with 2PL models using all criteria (as expected, given simdata pars)
</code></pre>

<pre><code>## 
## Model 1: mixedmirt(data = data, covdata = covdata, model = model, fixed = ~0 + 
##     group + items)
## Model 2: mixedmirt(data = data, covdata = covdata, model = model, fixed = ~0 + 
##     group + items, itemtype = &quot;2PL&quot;)
</code></pre>

<pre><code>##    AIC AICc SABIC  BIC logLik    X2  df   p
## 1 8118 8119  8137 8178  -4046   NaN NaN NaN
## 2 7968 7969  8000 8070  -3962 168.3   9   0
</code></pre>

<pre><code class="r">#continuous predictor with group
mod2 &lt;- mixedmirt(data, covdata, model, fixed = ~ 0 + group + items + pseudoIQ)
summary(mod2)
</code></pre>

<pre><code>## 
## Call:
## mixedmirt(data = data, covdata = covdata, model = model, fixed = ~0 + 
##     group + items + pseudoIQ)
## 
## --------------
## FIXED EFFECTS:
##          Estimate Std.Error z.value
## groupG1    -1.713     0.103 -16.597
## groupG2    -0.656     0.092  -7.143
## groupG3     0.374     0.097   3.869
## pseudoIQ    0.209     0.055   3.818
## 
## --------------
## RANDOM EFFECT COVARIANCE(S):
## Correlations on upper diagonal
## 
## $Theta
##        Theta
## Theta 0.0736
</code></pre>

<pre><code class="r">anova(mod1b, mod2)
</code></pre>

<pre><code>## 
## Model 1: mixedmirt(data = data, covdata = covdata, model = model, fixed = ~0 + 
##     group + items + pseudoIQ)
## Model 2: mixedmirt(data = data, covdata = covdata, model = model, fixed = ~0 + 
##     group + items, itemtype = &quot;2PL&quot;)
</code></pre>

<pre><code>##    AIC AICc SABIC  BIC logLik    X2  df   p
## 1 8106 8106  8126 8170  -4039   NaN NaN NaN
## 2 7968 7969  8000 8070  -3962 153.5   8   0
</code></pre>

<pre><code class="r">#view fixed design matrix with and without unique item level intercepts
withint &lt;- mixedmirt(data, covdata, model, fixed = ~ 0 + items + group, return.design = TRUE)
withoutint &lt;- mixedmirt(data, covdata, model, fixed = ~ 0 + group, return.design = TRUE)

#notice that in result above, the intercepts &#39;items1 to items 10&#39; were reassigned to &#39;d&#39;
head(withint$X)
</code></pre>

<pre><code>##     items1 items2 items3 items4 items5 items6 items7 items8 items9 items10
## 1.1      1      0      0      0      0      0      0      0      0       0
## 2.1      1      0      0      0      0      0      0      0      0       0
## 3.1      1      0      0      0      0      0      0      0      0       0
## 4.1      1      0      0      0      0      0      0      0      0       0
## 5.1      1      0      0      0      0      0      0      0      0       0
## 6.1      1      0      0      0      0      0      0      0      0       0
##     groupG2 groupG3
## 1.1       0       0
## 2.1       0       0
## 3.1       0       0
## 4.1       0       0
## 5.1       0       0
## 6.1       0       0
</code></pre>

<pre><code class="r">tail(withint$X)
</code></pre>

<pre><code>##        items1 items2 items3 items4 items5 items6 items7 items8 items9
## 745.10      0      0      0      0      0      0      0      0      0
## 746.10      0      0      0      0      0      0      0      0      0
## 747.10      0      0      0      0      0      0      0      0      0
## 748.10      0      0      0      0      0      0      0      0      0
## 749.10      0      0      0      0      0      0      0      0      0
## 750.10      0      0      0      0      0      0      0      0      0
##        items10 groupG2 groupG3
## 745.10       1       0       1
## 746.10       1       0       1
## 747.10       1       0       1
## 748.10       1       0       1
## 749.10       1       0       1
## 750.10       1       0       1
</code></pre>

<pre><code class="r">head(withoutint$X) #no intercepts design here to be reassigned into item intercepts
</code></pre>

<pre><code>##     groupG1 groupG2 groupG3
## 1.1       1       0       0
## 2.1       1       0       0
## 3.1       1       0       0
## 4.1       1       0       0
## 5.1       1       0       0
## 6.1       1       0       0
</code></pre>

<pre><code class="r">tail(withoutint$X)
</code></pre>

<pre><code>##        groupG1 groupG2 groupG3
## 745.10       0       0       1
## 746.10       0       0       1
## 747.10       0       0       1
## 748.10       0       0       1
## 749.10       0       0       1
## 750.10       0       0       1
</code></pre>

<pre><code class="r">###################################################
### random effects
#make the number of groups much larger
covdata$group &lt;- factor(rep(paste0(&#39;G&#39;,1:50), each = N/50))

#random groups
rmod1 &lt;- mixedmirt(data, covdata, 1, fixed = ~ 0 + items, random = ~ 1|group)
summary(rmod1)
</code></pre>

<pre><code>## 
## Call:
## mixedmirt(data = data, covdata = covdata, model = 1, fixed = ~0 + 
##     items, random = ~1 | group)
## 
## 
## --------------
## RANDOM EFFECT COVARIANCE(S):
## Correlations on upper diagonal
## 
## $Theta
##       F1
## F1 0.377
## 
## $group
##           COV_group
## COV_group     0.652
</code></pre>

<pre><code class="r">coef(rmod1)
</code></pre>

<pre><code>## $Item_1
##         a1      d  g  u
## par      1 -0.669  0  1
## CI_2.5  NA -0.818 NA NA
## CI_97.5 NA -0.520 NA NA
## 
## $Item_2
##         a1      d  g  u
## par      1 -0.841  0  1
## CI_2.5  NA -0.994 NA NA
## CI_97.5 NA -0.689 NA NA
## 
## $Item_3
##         a1      d  g  u
## par      1 -0.320  0  1
## CI_2.5  NA -0.465 NA NA
## CI_97.5 NA -0.176 NA NA
## 
## $Item_4
##         a1      d  g  u
## par      1  0.018  0  1
## CI_2.5  NA -0.127 NA NA
## CI_97.5 NA  0.162 NA NA
## 
## $Item_5
##         a1     d  g  u
## par      1 0.650  0  1
## CI_2.5  NA 0.498 NA NA
## CI_97.5 NA 0.803 NA NA
## 
## $Item_6
##         a1      d  g  u
## par      1 -0.088  0  1
## CI_2.5  NA -0.232 NA NA
## CI_97.5 NA  0.056 NA NA
## 
## $Item_7
##         a1      d  g  u
## par      1 -0.572  0  1
## CI_2.5  NA -0.719 NA NA
## CI_97.5 NA -0.424 NA NA
## 
## $Item_8
##         a1      d  g  u
## par      1 -1.083  0  1
## CI_2.5  NA -1.241 NA NA
## CI_97.5 NA -0.924 NA NA
## 
## $Item_9
##         a1      d  g  u
## par      1 -0.900  0  1
## CI_2.5  NA -1.054 NA NA
## CI_97.5 NA -0.747 NA NA
## 
## $Item_10
##         a1     d  g  u
## par      1 2.986  0  1
## CI_2.5  NA 2.691 NA NA
## CI_97.5 NA 3.280 NA NA
## 
## $GroupPars
##         MEAN_1 COV_11
## par          0  0.377
## CI_2.5      NA    NaN
## CI_97.5     NA    NaN
## 
## $group
##         COV_group_group
## par               0.652
## CI_2.5            0.345
## CI_97.5           0.959
</code></pre>

<pre><code class="r">#random groups and random items
rmod2 &lt;- mixedmirt(data, covdata, 1, random = list(~ 1|group, ~ 1|items))
summary(rmod2)
</code></pre>

<pre><code>## 
## Call:
## mixedmirt(data = data, covdata = covdata, model = 1, random = list(~1 | 
##     group, ~1 | items))
## 
## --------------
## FIXED EFFECTS:
##             Estimate Std.Error z.value
## (Intercept)   -0.269       NaN     NaN
## 
## --------------
## RANDOM EFFECT COVARIANCE(S):
## Correlations on upper diagonal
## 
## $Theta
##       F1
## F1 0.321
## 
## $group
##           COV_group
## COV_group     0.646
## 
## $items
##           COV_items
## COV_items      1.11
</code></pre>

<pre><code class="r">eff &lt;- randef(rmod2) #estimate random effects

#random slopes with fixed intercepts (suppressed correlation)
rmod3 &lt;- mixedmirt(data, covdata, 1, fixed = ~ 0 + items, random = ~ -1 + pseudoIQ|group)
summary(rmod3)
</code></pre>

<pre><code>## 
## Call:
## mixedmirt(data = data, covdata = covdata, model = 1, fixed = ~0 + 
##     items, random = ~-1 + pseudoIQ | group)
## 
## 
## --------------
## RANDOM EFFECT COVARIANCE(S):
## Correlations on upper diagonal
## 
## $Theta
##       F1
## F1 0.169
## 
## $group
##              COV_pseudoIQ COV_group
## COV_pseudoIQ        0.442     0.000
## COV_group           0.000     0.557
</code></pre>

<pre><code class="r">(eff &lt;- randef(rmod3))
</code></pre>

<pre><code>## $Theta
##                F1
##   [1,] -0.1635028
##   [2,] -0.1147085
##   [3,] -0.1131332
##   [4,] -0.0647505
##   [5,] -0.3010990
##   [6,] -0.1812289
##   [7,] -0.2202758
##   [8,] -0.2028574
##   [9,] -0.3486875
##  [10,]  0.0330342
##  [11,] -0.0490847
##  [12,] -0.1782585
##  [13,] -0.2593735
##  [14,] -0.1888204
##  [15,]  0.0063090
##  [16,] -0.0007306
##  [17,] -0.1531855
##  [18,] -0.1925334
##  [19,] -0.0873861
##  [20,] -0.0449060
##  [21,] -0.0772400
##  [22,] -0.1001792
##  [23,]  0.0049577
##  [24,] -0.0977616
##  [25,] -0.0881668
##  [26,]  0.2297511
##  [27,] -0.1079298
##  [28,] -0.0412455
##  [29,] -0.1357646
##  [30,] -0.2749696
##  [31,] -0.1466454
##  [32,]  0.0663791
##  [33,] -0.1631978
##  [34,] -0.4134523
##  [35,] -0.0444043
##  [36,] -0.1601643
##  [37,]  0.0080658
##  [38,]  0.1031218
##  [39,] -0.1323271
##  [40,]  0.0679197
##  [41,]  0.0248268
##  [42,] -0.1910613
##  [43,]  0.0180235
##  [44,]  0.3902884
##  [45,] -0.4282958
##  [46,] -0.1005734
##  [47,]  0.0875521
##  [48,] -0.2227385
##  [49,] -0.2684884
##  [50,]  0.0461095
##  [51,] -0.0871797
##  [52,] -0.0705601
##  [53,] -0.2063819
##  [54,]  0.1406199
##  [55,] -0.0977150
##  [56,] -0.1877896
##  [57,]  0.0083198
##  [58,] -0.5040584
##  [59,] -0.1510223
##  [60,] -0.2992247
##  [61,] -0.3851252
##  [62,] -0.1884340
##  [63,] -0.1575866
##  [64,] -0.1691925
##  [65,] -0.1540714
##  [66,] -0.1376576
##  [67,] -0.4305733
##  [68,] -0.1493544
##  [69,] -0.2117112
##  [70,] -0.3015372
##  [71,] -0.1958465
##  [72,] -0.1250000
##  [73,]  0.0575625
##  [74,] -0.1904472
##  [75,] -0.0418084
##  [76,]  0.2545802
##  [77,]  0.1629246
##  [78,]  0.0491914
##  [79,] -0.0612223
##  [80,]  0.3072601
##  [81,]  0.0440715
##  [82,] -0.0585474
##  [83,]  0.2074008
##  [84,] -0.2420341
##  [85,] -0.0914555
##  [86,]  0.0214854
##  [87,] -0.1737605
##  [88,] -0.0145436
##  [89,] -0.0828270
##  [90,] -0.0278293
##  [91,] -0.0130914
##  [92,] -0.1688148
##  [93,]  0.1525993
##  [94,]  0.0115328
##  [95,]  0.0226384
##  [96,]  0.0072106
##  [97,]  0.1393914
##  [98,]  0.0160568
##  [99,] -0.1772070
## [100,] -0.2141878
## [101,]  0.0060623
## [102,]  0.3286782
## [103,] -0.1273057
## [104,] -0.1024389
## [105,] -0.0644244
## [106,] -0.4571810
## [107,] -0.1785020
## [108,] -0.1786923
## [109,] -0.0067864
## [110,] -0.2280412
## [111,] -0.2145028
## [112,] -0.0512380
## [113,] -0.1017211
## [114,] -0.0302170
## [115,] -0.3741071
## [116,]  0.0912595
## [117,] -0.1847511
## [118,] -0.1811212
## [119,] -0.1936344
## [120,] -0.0615229
## [121,] -0.0361835
## [122,] -0.3399097
## [123,] -0.1591998
## [124,] -0.0190087
## [125,] -0.0502470
## [126,] -0.0193630
## [127,]  0.0121720
## [128,]  0.0546152
## [129,] -0.1207432
## [130,] -0.1633620
## [131,]  0.2656412
## [132,] -0.0611788
## [133,]  0.4618211
## [134,]  0.2403859
## [135,] -0.1489010
## [136,] -0.3049924
## [137,] -0.0766967
## [138,] -0.0427455
## [139,] -0.1864111
## [140,] -0.1667717
## [141,] -0.3163464
## [142,] -0.1209226
## [143,] -0.0045673
## [144,] -0.0277602
## [145,] -0.1853278
## [146,] -0.0221366
## [147,] -0.2114524
## [148,] -0.1438811
## [149,] -0.0598290
## [150,] -0.1219090
## [151,] -0.0481034
## [152,] -0.0390599
## [153,]  0.2963458
## [154,] -0.2307624
## [155,] -0.0493061
## [156,] -0.0901441
## [157,] -0.0460936
## [158,] -0.0106313
## [159,] -0.0798722
## [160,] -0.2388813
## [161,] -0.0633722
## [162,]  0.1043459
## [163,] -0.3184959
## [164,] -0.2267828
## [165,] -0.1999012
## [166,] -0.1177305
## [167,]  0.0412129
## [168,] -0.1821142
## [169,]  0.1728865
## [170,]  0.1616394
## [171,] -0.1005177
## [172,] -0.0209785
## [173,]  0.1696392
## [174,]  0.0245194
## [175,]  0.0080073
## [176,]  0.1714865
## [177,]  0.2953435
## [178,]  0.0175140
## [179,]  0.1467642
## [180,]  0.2907025
## [181,] -0.3649139
## [182,]  0.1547246
## [183,] -0.0378209
## [184,] -0.2253666
## [185,]  0.1642995
## [186,]  0.0771850
## [187,] -0.1819438
## [188,]  0.1687210
## [189,]  0.1566547
## [190,] -0.1199522
## [191,] -0.1628075
## [192,]  0.0025947
## [193,]  0.1725469
## [194,]  0.0772402
## [195,] -0.0561580
## [196,]  0.0485244
## [197,]  0.0068982
## [198,]  0.0423125
## [199,] -0.2406234
## [200,] -0.2493176
## [201,]  0.1525182
## [202,] -0.2336687
## [203,]  0.0817433
## [204,]  0.0566927
## [205,] -0.2681994
## [206,] -0.2638043
## [207,] -0.0254097
## [208,] -0.2210405
## [209,] -0.0210588
## [210,] -0.2150113
## [211,] -0.1001719
## [212,]  0.0542273
## [213,] -0.1180912
## [214,]  0.2223044
## [215,]  0.1405347
## [216,]  0.1175255
## [217,] -0.1462212
## [218,] -0.2875325
## [219,]  0.1033400
## [220,] -0.2316146
## [221,] -0.3447036
## [222,] -0.2979444
## [223,] -0.3642829
## [224,] -0.1343048
## [225,] -0.0889919
## [226,]  0.1209533
## [227,] -0.1099054
## [228,]  0.1146286
## [229,] -0.3733976
## [230,]  0.0245879
## [231,] -0.2050784
## [232,]  0.0410088
## [233,] -0.0818256
## [234,] -0.1966601
## [235,]  0.0124724
## [236,]  0.0064691
## [237,] -0.1488210
## [238,]  0.0393821
## [239,] -0.2540921
## [240,] -0.1288019
## [241,]  0.0076430
## [242,] -0.1230363
## [243,] -0.1808270
## [244,] -0.2028698
## [245,] -0.2134688
## [246,]  0.0818120
## [247,] -0.1069909
## [248,] -0.1968845
## [249,] -0.2548282
## [250,] -0.4535172
## [251,] -0.0460794
## [252,] -0.1358285
## [253,] -0.0749748
## [254,] -0.2022788
## [255,]  0.1473900
## [256,] -0.0515192
## [257,] -0.1347371
## [258,]  0.0226547
## [259,] -0.4062345
## [260,] -0.1105508
## [261,] -0.0868625
## [262,]  0.1407167
## [263,] -0.1352501
## [264,] -0.1447156
## [265,] -0.1244427
## [266,] -0.1029786
## [267,] -0.1543864
## [268,]  0.3085304
## [269,]  0.2526032
## [270,] -0.3958146
## [271,] -0.2230136
## [272,] -0.0748052
## [273,]  0.1808199
## [274,] -0.2713050
## [275,] -0.3826857
## [276,] -0.2756176
## [277,] -0.0195671
## [278,] -0.0192367
## [279,]  0.2485409
## [280,]  0.4528169
## [281,]  0.1897177
## [282,]  0.2176629
## [283,] -0.0382164
## [284,] -0.0868461
## [285,] -0.1368399
## [286,] -0.2723556
## [287,] -0.0890233
## [288,] -0.2675855
## [289,] -0.0305419
## [290,] -0.0106210
## [291,] -0.0579925
## [292,]  0.2081362
## [293,] -0.4083998
## [294,] -0.0406558
## [295,] -0.1691050
## [296,]  0.2617261
## [297,]  0.1200812
## [298,] -0.0649795
## [299,]  0.1271315
## [300,] -0.1351885
## [301,] -0.0807553
## [302,]  0.0545909
## [303,] -0.0417648
## [304,]  0.1038937
## [305,]  0.0246338
## [306,] -0.0343327
## [307,]  0.0510126
## [308,]  0.0382024
## [309,]  0.1054452
## [310,] -0.2634352
## [311,] -0.0216397
## [312,] -0.1808363
## [313,] -0.0522525
## [314,]  0.0402986
## [315,]  0.0517654
## [316,] -0.0570415
## [317,] -0.1803000
## [318,] -0.2405027
## [319,] -0.0131659
## [320,] -0.0004833
## [321,] -0.1125353
## [322,] -0.0166258
## [323,] -0.4615585
## [324,]  0.0240513
## [325,]  0.3268964
## [326,]  0.2467483
## [327,]  0.0220805
## [328,] -0.0054287
## [329,]  0.0059745
## [330,]  0.0776827
## [331,]  0.1210293
## [332,] -0.4681211
## [333,] -0.2935462
## [334,]  0.2222646
## [335,] -0.1398704
## [336,] -0.0988393
## [337,] -0.1917685
## [338,]  0.0798218
## [339,] -0.2014847
## [340,]  0.0316364
## [341,] -0.1548699
## [342,] -0.0449359
## [343,] -0.0608952
## [344,]  0.2853656
## [345,] -0.0362090
## [346,]  0.1326967
## [347,] -0.1141670
## [348,] -0.1388615
## [349,] -0.1542529
## [350,]  0.0874382
## [351,] -0.1788761
## [352,] -0.0890477
## [353,] -0.2472688
## [354,]  0.0731899
## [355,]  0.1219459
## [356,] -0.0692149
## [357,]  0.2546089
## [358,] -0.0474818
## [359,] -0.1637130
## [360,]  0.0753160
## [361,]  0.2331344
## [362,]  0.0445370
## [363,]  0.0187927
## [364,]  0.2197698
## [365,] -0.0006868
## [366,] -0.0201776
## [367,]  0.0484770
## [368,] -0.1886428
## [369,]  0.3125429
## [370,] -0.0151208
## [371,] -0.0560869
## [372,] -0.0043359
## [373,]  0.1119788
## [374,] -0.3939104
## [375,]  0.0775987
## [376,] -0.0768837
## [377,] -0.0586896
## [378,]  0.0623230
## [379,]  0.2097269
## [380,]  0.0607323
## [381,] -0.2158980
## [382,] -0.1007382
## [383,] -0.1614120
## [384,]  0.1732220
## [385,]  0.1785884
## [386,] -0.0835396
## [387,]  0.0272568
## [388,] -0.1083983
## [389,]  0.0887387
## [390,]  0.0452102
## [391,] -0.3829856
## [392,] -0.4947957
## [393,] -0.2851595
## [394,] -0.1154683
## [395,] -0.0260790
## [396,]  0.1594525
## [397,]  0.0372577
## [398,] -0.2764917
## [399,] -0.1130131
## [400,] -0.0341099
## [401,] -0.1030798
## [402,] -0.0309644
## [403,] -0.1175538
## [404,] -0.2369256
## [405,] -0.0762806
## [406,] -0.2212179
## [407,]  0.2307974
## [408,]  0.1493102
## [409,] -0.1605929
## [410,] -0.2118613
## [411,] -0.0998224
## [412,] -0.0157490
## [413,] -0.0869190
## [414,] -0.1154804
## [415,]  0.0251916
## [416,]  0.1324174
## [417,]  0.0720007
## [418,]  0.0068160
## [419,] -0.1952969
## [420,]  0.0970197
## [421,] -0.0741098
## [422,]  0.0192450
## [423,] -0.0044708
## [424,]  0.1198676
## [425,]  0.0803397
## [426,] -0.2414542
## [427,]  0.1671538
## [428,]  0.0143051
## [429,] -0.1189747
## [430,] -0.0688201
## [431,] -0.1000632
## [432,] -0.0566246
## [433,]  0.0774373
## [434,]  0.0706667
## [435,]  0.1532600
## [436,] -0.2745900
## [437,]  0.1571285
## [438,]  0.4066444
## [439,]  0.1664261
## [440,] -0.0060879
## [441,]  0.3449328
## [442,]  0.2546645
## [443,] -0.1148315
## [444,] -0.0730660
## [445,] -0.1566522
## [446,] -0.0932352
## [447,]  0.0411683
## [448,]  0.0231290
## [449,]  0.1444325
## [450,]  0.2466099
## [451,]  0.1291622
## [452,]  0.1015641
## [453,] -0.1138855
## [454,] -0.2232373
## [455,]  0.1215483
## [456,]  0.0044782
## [457,] -0.1032318
## [458,]  0.2623032
## [459,] -0.1272523
## [460,] -0.2015329
## [461,]  0.1385503
## [462,] -0.1276234
## [463,] -0.0052665
## [464,]  0.2527441
## [465,]  0.1344157
## [466,] -0.1987038
## [467,]  0.1297885
## [468,]  0.1521405
## [469,]  0.3195947
## [470,] -0.2153506
## [471,]  0.3981399
## [472,]  0.0539345
## [473,]  0.0494430
## [474,]  0.3098614
## [475,] -0.2677992
## [476,]  0.0079452
## [477,]  0.0432735
## [478,]  0.2878893
## [479,] -0.0553124
## [480,]  0.1534791
## [481,] -0.0089275
## [482,] -0.0710250
## [483,] -0.4163875
## [484,]  0.3730995
## [485,]  0.1088492
## [486,]  0.2806617
## [487,]  0.1511729
## [488,] -0.1785184
## [489,]  0.1324504
## [490,]  0.1977686
## [491,]  0.2875788
## [492,] -0.2606977
## [493,] -0.1546235
## [494,] -0.1177162
## [495,] -0.0019320
## [496,]  0.0440552
## [497,]  0.0545528
## [498,]  0.2335833
## [499,]  0.2137348
## [500,]  0.3034961
## [501,] -0.1304411
## [502,]  0.2987608
## [503,] -0.0981798
## [504,] -0.3528888
## [505,]  0.0506194
## [506,] -0.0583329
## [507,] -0.1066916
## [508,]  0.0969394
## [509,]  0.2325193
## [510,]  0.0239187
## [511,]  0.2276812
## [512,] -0.0252324
## [513,] -0.0732784
## [514,]  0.2579699
## [515,]  0.1738877
## [516,]  0.1876039
## [517,]  0.1997125
## [518,]  0.0312293
## [519,]  0.2040394
## [520,] -0.0478930
## [521,] -0.0395593
## [522,]  0.0909971
## [523,]  0.5774813
## [524,]  0.2256186
## [525,]  0.0593236
## [526,] -0.4142964
## [527,]  0.1820265
## [528,]  0.1612838
## [529,]  0.3042758
## [530,]  0.1710407
## [531,] -0.2005722
## [532,]  0.0820552
## [533,]  0.0511035
## [534,]  0.0475661
## [535,]  0.0248560
## [536,]  0.1462987
## [537,]  0.1361163
## [538,]  0.0438006
## [539,]  0.2568771
## [540,]  0.1303299
## [541,] -0.1559088
## [542,] -0.2361886
## [543,]  0.1280921
## [544,] -0.2190531
## [545,]  0.0756552
## [546,]  0.0125778
## [547,]  0.3109444
## [548,]  0.0209140
## [549,]  0.1819610
## [550,]  0.0558670
## [551,]  0.4009461
## [552,]  0.0198653
## [553,]  0.0329166
## [554,] -0.2290409
## [555,] -0.0189059
## [556,] -0.0632596
## [557,] -0.0136418
## [558,]  0.1524318
## [559,] -0.0252650
## [560,]  0.0167244
## [561,]  0.4844489
## [562,]  0.1570163
## [563,]  0.1844041
## [564,] -0.1313221
## [565,]  0.0760759
## [566,] -0.2126809
## [567,]  0.4078714
## [568,]  0.1756552
## [569,]  0.3827766
## [570,]  0.0947699
## [571,] -0.0443438
## [572,] -0.0658484
## [573,]  0.0952590
## [574,]  0.1437154
## [575,]  0.2698584
## [576,]  0.1008771
## [577,]  0.0635944
## [578,]  0.0291047
## [579,]  0.0644612
## [580,]  0.2657080
## [581,] -0.1061676
## [582,]  0.0956980
## [583,]  0.2560430
## [584,] -0.2199373
## [585,]  0.1192355
## [586,]  0.0876343
## [587,] -0.0279893
## [588,] -0.0826077
## [589,]  0.5730605
## [590,] -0.2494480
## [591,] -0.3014551
## [592,]  0.3158872
## [593,] -0.1804013
## [594,] -0.3163402
## [595,] -0.1588007
## [596,]  0.2473718
## [597,]  0.1177342
## [598,]  0.0702435
## [599,] -0.1610420
## [600,]  0.2518513
## [601,] -0.0262903
## [602,]  0.1682965
## [603,] -0.0314010
## [604,]  0.2849017
## [605,]  0.5085344
## [606,] -0.2421842
## [607,] -0.2301154
## [608,] -0.3837481
## [609,] -0.1264018
## [610,] -0.0250703
## [611,]  0.1281530
## [612,] -0.1798957
## [613,] -0.4333412
## [614,]  0.3911669
## [615,] -0.0437669
## [616,]  0.3647131
## [617,]  0.0853744
## [618,]  0.1364465
## [619,]  0.3183176
## [620,]  0.1879290
## [621,]  0.3003707
## [622,] -0.0335436
## [623,]  0.2802064
## [624,]  0.4281691
## [625,]  0.0712332
## [626,] -0.1805249
## [627,]  0.1565577
## [628,]  0.2206649
## [629,]  0.1450469
## [630,]  0.1739862
## [631,]  0.1766719
## [632,]  0.2244337
## [633,] -0.1120003
## [634,] -0.0848738
## [635,] -0.0566618
## [636,] -0.1947196
## [637,] -0.0406294
## [638,] -0.1988610
## [639,] -0.2795507
## [640,]  0.1904552
## [641,] -0.3319685
## [642,]  0.1654400
## [643,] -0.2155955
## [644,]  0.0363417
## [645,] -0.0273860
## [646,]  0.1917412
## [647,] -0.0322998
## [648,] -0.0645620
## [649,]  0.0882859
## [650,] -0.4300787
## [651,] -0.0918453
## [652,]  0.0618004
## [653,] -0.1205766
## [654,]  0.1148759
## [655,] -0.0197871
## [656,] -0.1412915
## [657,] -0.2471598
## [658,] -0.0020160
## [659,]  0.0710587
## [660,]  0.0314224
## [661,] -0.6185196
## [662,] -0.1481140
## [663,] -0.0336321
## [664,]  0.1109698
## [665,] -0.2094086
## [666,]  0.0962918
## [667,] -0.0584246
## [668,] -0.2829742
## [669,] -0.0949713
## [670,]  0.0861988
## [671,]  0.0520574
## [672,] -0.0720389
## [673,]  0.1404833
## [674,]  0.0556559
## [675,] -0.1699833
## [676,]  0.3772007
## [677,]  0.3236710
## [678,]  0.1375180
## [679,] -0.1985587
## [680,]  0.4564448
## [681,]  0.1405540
## [682,]  0.1438403
## [683,]  0.2781819
## [684,]  0.2045489
## [685,]  0.2440192
## [686,] -0.0106967
## [687,] -0.0513348
## [688,]  0.1222046
## [689,]  0.0191352
## [690,]  0.2955205
## [691,]  0.2194048
## [692,] -0.2832823
## [693,] -0.2582780
## [694,] -0.0142265
## [695,]  0.1646686
## [696,] -0.1662380
## [697,]  0.1412419
## [698,]  0.0090115
## [699,] -0.0263817
## [700,] -0.1521389
## [701,]  0.0343620
## [702,]  0.1517245
## [703,] -0.0966873
## [704,] -0.1243060
## [705,] -0.2603482
## [706,]  0.4149614
## [707,] -0.2190036
## [708,]  0.2507318
## [709,]  0.0070028
## [710,]  0.2018639
## [711,]  0.0851897
## [712,]  0.3781788
## [713,] -0.1587699
## [714,]  0.1151821
## [715,]  0.0100107
## [716,]  0.0570543
## [717,]  0.0325089
## [718,] -0.0246439
## [719,] -0.0196476
## [720,]  0.0199146
## [721,]  0.0564879
## [722,]  0.1590187
## [723,]  0.1302225
## [724,]  0.0647518
## [725,] -0.0157649
## [726,]  0.0997836
## [727,]  0.3327895
## [728,]  0.2744491
## [729,]  0.0514450
## [730,]  0.1009202
## [731,]  0.1659864
## [732,]  0.0878057
## [733,]  0.0878285
## [734,]  0.1466245
## [735,] -0.1259032
## [736,]  0.2487891
## [737,]  0.0776011
## [738,]  0.5346749
## [739,]  0.1127118
## [740,]  0.2540309
## [741,]  0.3447046
## [742,]  0.2768249
## [743,]  0.0888245
## [744,]  0.1185448
## [745,]  0.2876870
## [746,]  0.2265273
## [747,]  0.2408122
## [748,] -0.1884798
## [749,]  0.2427869
## [750,]  0.1776360
## 
## $pseudoIQ
##       pseudoIQ     group
## G1  -0.1051525 -1.546798
## G2  -0.2393004 -1.338212
## G3   1.8629157 -0.043919
## G4  -0.4110607 -1.132723
## G5  -0.4690339 -0.901775
## G6   0.4761984 -0.613394
## G7   0.4698360 -1.258868
## G8   0.0250104 -0.736385
## G9   0.9887851 -0.532135
## G10  0.6684475 -0.329896
## G11 -0.2277239 -0.758218
## G12  0.0661191 -1.735933
## G13 -0.3818383 -1.205366
## G14 -0.0200134 -0.419367
## G15 -0.1878307 -0.307431
## G16 -0.0238833 -0.507707
## G17 -1.0770097 -0.537722
## G18  0.0465930 -0.350079
## G19  0.9124008 -0.400229
## G20 -0.1344961 -0.261849
## G21  0.0981736 -0.071358
## G22  0.1712295 -0.268298
## G23  0.0686906 -0.163133
## G24 -0.1665650 -0.323139
## G25  0.2082194  0.167935
## G26 -0.0060664  0.001985
## G27  0.1071998  0.615295
## G28  0.0003408  0.064090
## G29 -0.0977202  0.042761
## G30 -0.2105229  0.293150
## G31 -0.0947883  0.163618
## G32 -0.4964348  0.499478
## G33 -0.0061910  0.210387
## G34 -0.0312135  0.371247
## G35 -0.0697009  0.421306
## G36 -0.0236823  0.555713
## G37  1.0431079  0.533119
## G38  0.1284355  0.316983
## G39 -0.2542178  0.425710
## G40 -0.9799279  1.409737
## G41  1.3064660  0.301266
## G42 -0.2629427  0.683232
## G43  0.3745560  1.078048
## G44  0.0383636  1.437950
## G45  0.4706695  1.366522
## G46 -0.3750156  1.433740
## G47  0.4663086  1.496146
## G48  0.0508463  1.250304
## G49 -0.3594542  1.455109
## G50  0.6211693  0.184785
</code></pre>

<pre><code class="r">###################################################
##LLTM, and 2PL version of LLTM
data(SAT12)
data &lt;- key2binary(SAT12,
                   key = c(1,4,5,2,3,1,2,1,3,1,2,4,2,1,5,3,4,4,1,4,3,3,4,1,3,5,1,3,1,5,4,5))
model &lt;- mirt.model(&#39;Theta = 1-32&#39;)

# Suppose that the first 16 items were suspected to be easier than the last 16 items,
#   and we wish to test this item structure hypothesis (more intercept designs are possible
#   by including more columns).
itemdesign &lt;- data.frame(itemorder = factor(c(rep(&#39;easier&#39;, 16), rep(&#39;harder&#39;, 16))))

#notice that the &#39;fixed = ~ ... + items&#39; argument is omitted
LLTM &lt;- mixedmirt(data, model = model, fixed = ~ 0 + itemorder, itemdesign = itemdesign,
   SE = TRUE) # SE argument ensures that the information matrix is computed accurately
summary(LLTM)
</code></pre>

<pre><code>## 
## Call:
## mixedmirt(data = data, model = model, fixed = ~0 + itemorder, 
##     itemdesign = itemdesign, SE = TRUE)
## 
## --------------
## FIXED EFFECTS:
##                 Estimate Std.Error z.value
## itemordereasier     0.16     0.033   4.852
## itemorderharder     0.45     0.033  13.568
## 
## --------------
## RANDOM EFFECT COVARIANCE(S):
## Correlations on upper diagonal
## 
## $Theta
##       Theta
## Theta 0.342
</code></pre>

<pre><code class="r">coef(LLTM)
</code></pre>

<pre><code>## $Item.1
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.2
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.3
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.4
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.5
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.6
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.7
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.8
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.9
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.10
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.11
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.12
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.13
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.14
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.15
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.16
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.17
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.18
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.19
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.20
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.21
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.22
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.23
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.24
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.25
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.26
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.27
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.28
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.29
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.30
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.31
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $Item.32
##         itemordereasier itemorderharder a1  d  g  u
## par               0.160           0.450  1  0  0  1
## CI_2.5            0.095           0.385 NA NA NA NA
## CI_97.5           0.224           0.515 NA NA NA NA
## 
## $GroupPars
##         MEAN_1 COV_11
## par          0  0.342
## CI_2.5      NA  0.285
## CI_97.5     NA  0.398
</code></pre>

<pre><code class="r">wald(LLTM)
</code></pre>

<pre><code>##                                                                                                                                     1
## infoname itemordereasier.1.7.13.19.25.31.37.43.49.55.61.67.73.79.85.91.97.103.109.115.121.127.133.139.145.151.157.163.169.175.181.187
## par                                                                                                                             0.160
##                                                                                                                                     2
## infoname itemorderharder.2.8.14.20.26.32.38.44.50.56.62.68.74.80.86.92.98.104.110.116.122.128.134.140.146.152.158.164.170.176.182.188
## par                                                                                                                             0.450
##                   3
## infoname COV_11.194
## par           0.342
</code></pre>

<pre><code class="r">L &lt;- matrix(c(-1, 1, 0), 1)
wald(LLTM, L) #first half different from second
</code></pre>

<pre><code>##      W df p
## 1 91.7  1 0
</code></pre>

<pre><code class="r">#compare to items with estimated slopes (2PL)
twoPL &lt;- mixedmirt(data, model = model, fixed = ~ 0 + itemorder, itemtype = &#39;2PL&#39;,
                   itemdesign = itemdesign)
#twoPL not mixing too well (AR should be between .2 and .5), decrease MHcand
twoPL &lt;- mixedmirt(data, model = model, fixed = ~ 0 + itemorder, itemtype = &#39;2PL&#39;,
                  itemdesign = itemdesign, technical = list(MHcand = 0.8))
anova(twoPL, LLTM) #much better fit
</code></pre>

<pre><code>## 
## Model 1: mixedmirt(data = data, model = model, fixed = ~0 + itemorder, 
##     itemdesign = itemdesign, SE = TRUE)
## Model 2: mixedmirt(data = data, model = model, fixed = ~0 + itemorder, 
##     itemtype = &quot;2PL&quot;, itemdesign = itemdesign, technical = list(MHcand = 0.8))
</code></pre>

<pre><code>##     AIC  AICc SABIC   BIC logLik   X2  df   p
## 1 25464 25464 25468 25477 -12729  NaN NaN NaN
## 2 20483 20487 20524 20632 -10207 5043  31   0
</code></pre>

<pre><code class="r">summary(twoPL)
</code></pre>

<pre><code>## 
## Call:
## mixedmirt(data = data, model = model, fixed = ~0 + itemorder, 
##     itemtype = &quot;2PL&quot;, itemdesign = itemdesign, technical = list(MHcand = 0.8))
## 
## --------------
## FIXED EFFECTS:
##                 Estimate Std.Error z.value
## itemordereasier   -1.662     0.076  -21.82
## itemorderharder   -1.637     0.084  -19.57
## 
## --------------
## RANDOM EFFECT COVARIANCE(S):
## Correlations on upper diagonal
## 
## $Theta
##       Theta
## Theta     1
</code></pre>

<pre><code class="r">coef(twoPL)
</code></pre>

<pre><code>## $Item.1
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 0.929  0  0  1
## CI_2.5           -1.811          -1.801 0.708 NA NA NA
## CI_97.5          -1.512          -1.473 1.150 NA NA NA
## 
## $Item.2
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 2.537  0  0  1
## CI_2.5           -1.811          -1.801 2.221 NA NA NA
## CI_97.5          -1.512          -1.473 2.853 NA NA NA
## 
## $Item.3
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 0.997  0  0  1
## CI_2.5           -1.811          -1.801 0.773 NA NA NA
## CI_97.5          -1.512          -1.473 1.222 NA NA NA
## 
## $Item.4
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 1.290  0  0  1
## CI_2.5           -1.811          -1.801 1.052 NA NA NA
## CI_97.5          -1.512          -1.473 1.527 NA NA NA
## 
## $Item.5
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 2.711  0  0  1
## CI_2.5           -1.811          -1.801 2.382 NA NA NA
## CI_97.5          -1.512          -1.473 3.039 NA NA NA
## 
## $Item.6
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 0.420  0  0  1
## CI_2.5           -1.811          -1.801 0.198 NA NA NA
## CI_97.5          -1.512          -1.473 0.642 NA NA NA
## 
## $Item.7
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 3.923  0  0  1
## CI_2.5           -1.811          -1.801 3.504 NA NA NA
## CI_97.5          -1.512          -1.473 4.342 NA NA NA
## 
## $Item.8
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 0.510  0  0  1
## CI_2.5           -1.811          -1.801 0.291 NA NA NA
## CI_97.5          -1.512          -1.473 0.729 NA NA NA
## 
## $Item.9
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 5.478  0  0  1
## CI_2.5           -1.811          -1.801 4.871 NA NA NA
## CI_97.5          -1.512          -1.473 6.086 NA NA NA
## 
## $Item.10
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 1.632  0  0  1
## CI_2.5           -1.811          -1.801 1.377 NA NA NA
## CI_97.5          -1.512          -1.473 1.886 NA NA NA
## 
## $Item.11
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 13.62  0  0  1
## CI_2.5           -1.811          -1.801 10.85 NA NA NA
## CI_97.5          -1.512          -1.473 16.39 NA NA NA
## 
## $Item.12
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 1.240  0  0  1
## CI_2.5           -1.811          -1.801 0.998 NA NA NA
## CI_97.5          -1.512          -1.473 1.482 NA NA NA
## 
## $Item.13
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 3.049  0  0  1
## CI_2.5           -1.811          -1.801 2.692 NA NA NA
## CI_97.5          -1.512          -1.473 3.405 NA NA NA
## 
## $Item.14
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 3.504  0  0  1
## CI_2.5           -1.811          -1.801 3.101 NA NA NA
## CI_97.5          -1.512          -1.473 3.906 NA NA NA
## 
## $Item.15
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 4.776  0  0  1
## CI_2.5           -1.811          -1.801 4.272 NA NA NA
## CI_97.5          -1.512          -1.473 5.280 NA NA NA
## 
## $Item.16
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 1.471  0  0  1
## CI_2.5           -1.811          -1.801 1.222 NA NA NA
## CI_97.5          -1.512          -1.473 1.719 NA NA NA
## 
## $Item.17
##         itemordereasier itemorderharder     a1  d  g  u
## par              -1.662          -1.637  9.983  0  0  1
## CI_2.5           -1.811          -1.801  8.416 NA NA NA
## CI_97.5          -1.512          -1.473 11.551 NA NA NA
## 
## $Item.18
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 1.412  0  0  1
## CI_2.5           -1.811          -1.801 1.164 NA NA NA
## CI_97.5          -1.512          -1.473 1.660 NA NA NA
## 
## $Item.19
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 2.161  0  0  1
## CI_2.5           -1.811          -1.801 1.860 NA NA NA
## CI_97.5          -1.512          -1.473 2.462 NA NA NA
## 
## $Item.20
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 5.827  0  0  1
## CI_2.5           -1.811          -1.801 5.181 NA NA NA
## CI_97.5          -1.512          -1.473 6.473 NA NA NA
## 
## $Item.21
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 6.382  0  0  1
## CI_2.5           -1.811          -1.801 5.656 NA NA NA
## CI_97.5          -1.512          -1.473 7.108 NA NA NA
## 
## $Item.22
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 7.881  0  0  1
## CI_2.5           -1.811          -1.801 6.892 NA NA NA
## CI_97.5          -1.512          -1.473 8.871 NA NA NA
## 
## $Item.23
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 0.981  0  0  1
## CI_2.5           -1.811          -1.801 0.752 NA NA NA
## CI_97.5          -1.512          -1.473 1.211 NA NA NA
## 
## $Item.24
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 3.636  0  0  1
## CI_2.5           -1.811          -1.801 3.228 NA NA NA
## CI_97.5          -1.512          -1.473 4.044 NA NA NA
## 
## $Item.25
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 1.295  0  0  1
## CI_2.5           -1.811          -1.801 1.048 NA NA NA
## CI_97.5          -1.512          -1.473 1.543 NA NA NA
## 
## $Item.26
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 1.908  0  0  1
## CI_2.5           -1.811          -1.801 1.631 NA NA NA
## CI_97.5          -1.512          -1.473 2.184 NA NA NA
## 
## $Item.27
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 5.705  0  0  1
## CI_2.5           -1.811          -1.801 5.071 NA NA NA
## CI_97.5          -1.512          -1.473 6.339 NA NA NA
## 
## $Item.28
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 2.127  0  0  1
## CI_2.5           -1.811          -1.801 1.827 NA NA NA
## CI_97.5          -1.512          -1.473 2.426 NA NA NA
## 
## $Item.29
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 1.162  0  0  1
## CI_2.5           -1.811          -1.801 0.923 NA NA NA
## CI_97.5          -1.512          -1.473 1.401 NA NA NA
## 
## $Item.30
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 1.438  0  0  1
## CI_2.5           -1.811          -1.801 1.182 NA NA NA
## CI_97.5          -1.512          -1.473 1.694 NA NA NA
## 
## $Item.31
##         itemordereasier itemorderharder    a1  d  g  u
## par              -1.662          -1.637 5.271  0  0  1
## CI_2.5           -1.811          -1.801 4.700 NA NA NA
## CI_97.5          -1.512          -1.473 5.843 NA NA NA
## 
## $Item.32
##         itemordereasier itemorderharder     a1  d  g  u
## par              -1.662          -1.637  0.093  0  0  1
## CI_2.5           -1.811          -1.801 -0.158 NA NA NA
## CI_97.5          -1.512          -1.473  0.343 NA NA NA
## 
## $GroupPars
##         MEAN_1 COV_11
## par          0      1
## CI_2.5      NA     NA
## CI_97.5     NA     NA
</code></pre>

<pre><code class="r">wald(twoPL)
</code></pre>

<pre><code>##                                                                                                                                     1
## infoname itemordereasier.1.7.13.19.25.31.37.43.49.55.61.67.73.79.85.91.97.103.109.115.121.127.133.139.145.151.157.163.169.175.181.187
## par                                                                                                                            -1.662
##                                                                                                                                     2
## infoname itemorderharder.2.8.14.20.26.32.38.44.50.56.62.68.74.80.86.92.98.104.110.116.122.128.134.140.146.152.158.164.170.176.182.188
## par                                                                                                                            -1.637
##               3      4      5      6      7      8      9     10     11
## infoname   a1.3   a1.9  a1.15  a1.21  a1.27  a1.33  a1.39  a1.45  a1.51
## par       0.929  2.537  0.997  1.290  2.711  0.420  3.923  0.510  5.478
##              12     13     14     15     16     17     18     19     20
## infoname  a1.57  a1.63  a1.69  a1.75  a1.81  a1.87  a1.93  a1.99 a1.105
## par       1.632 13.620  1.240  3.049  3.504  4.776  1.471  9.983  1.412
##              21     22     23     24     25     26     27     28     29
## infoname a1.111 a1.117 a1.123 a1.129 a1.135 a1.141 a1.147 a1.153 a1.159
## par       2.161  5.827  6.382  7.881  0.981  3.636  1.295  1.908  5.705
##              30     31     32     33     34
## infoname a1.165 a1.171 a1.177 a1.183 a1.189
## par       2.127  1.162  1.438  5.271  0.093
</code></pre>

<pre><code class="r">L &lt;- matrix(0, 1, 34)
L[1, 1] &lt;- 1
L[1, 2] &lt;- -1
wald(twoPL, L) #n.s., which is the correct conclusion. Rasch approach gave wrong inference
</code></pre>

<pre><code>##         W df      p
## 1 0.07072  1 0.7903
</code></pre>

<pre><code class="r">##LLTM with item error term
LLTMwithError &lt;- mixedmirt(data, model = model, fixed = ~ 0 + itemorder, random = ~ 1|items,
    itemdesign = itemdesign)
summary(LLTMwithError)
</code></pre>

<pre><code>## 
## Call:
## mixedmirt(data = data, model = model, fixed = ~0 + itemorder, 
##     random = ~1 | items, itemdesign = itemdesign)
## 
## --------------
## FIXED EFFECTS:
##                 Estimate Std.Error z.value
## itemordereasier    0.141       NaN     NaN
## itemorderharder    0.655     0.019   34.04
## 
## --------------
## RANDOM EFFECT COVARIANCE(S):
## Correlations on upper diagonal
## 
## $Theta
##       Theta
## Theta 0.785
## 
## $items
##           COV_items
## COV_items      2.12
</code></pre>

<pre><code class="r">#large item level variance after itemorder is regressed; not a great predictor of item difficulty
coef(LLTMwithError)
</code></pre>

<pre><code>## $Item.1
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.2
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.3
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.4
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.5
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.6
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.7
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.8
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.9
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.10
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.11
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.12
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.13
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.14
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.15
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.16
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.17
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.18
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.19
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.20
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.21
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.22
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.23
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.24
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.25
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.26
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.27
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.28
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.29
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.30
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.31
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $Item.32
##         itemordereasier itemorderharder a1  d  g  u
## par               0.141           0.655  1  0  0  1
## CI_2.5              NaN           0.617 NA NA NA NA
## CI_97.5             NaN           0.692 NA NA NA NA
## 
## $GroupPars
##         MEAN_1 COV_11
## par          0  0.785
## CI_2.5      NA  0.270
## CI_97.5     NA  1.300
## 
## $items
##         COV_items_items
## par               2.123
## CI_2.5            0.770
## CI_97.5           3.475
</code></pre>

<pre><code class="r">###################################################
### Polytomous example

#make an arbitrary group difference
covdat &lt;- data.frame(group = rep(c(&#39;m&#39;, &#39;f&#39;), nrow(Science)/2))

#partial credit model
mod &lt;- mixedmirt(Science, covdat, model=1, fixed = ~ 0 + group)
coef(mod)
</code></pre>

<pre><code>## $Comfort
##         groupm a1 ak0 ak1 ak2 ak3 d0    d1    d2    d3
## par     -0.044  1   0   1   2   3  0 3.050 5.639 4.273
## CI_2.5  -0.294 NA  NA  NA  NA  NA NA 2.004 4.554 3.164
## CI_97.5  0.207 NA  NA  NA  NA  NA NA 4.096 6.724 5.382
## 
## $Work
##         groupm a1 ak0 ak1 ak2 ak3 d0    d1    d2    d3
## par     -0.044  1   0   1   2   3  0 1.881 2.796 0.969
## CI_2.5  -0.294 NA  NA  NA  NA  NA NA 1.404 2.255 0.297
## CI_97.5  0.207 NA  NA  NA  NA  NA NA 2.359 3.337 1.641
## 
## $Future
##         groupm a1 ak0 ak1 ak2 ak3 d0    d1    d2    d3
## par     -0.044  1   0   1   2   3  0 2.624 4.044 2.933
## CI_2.5  -0.294 NA  NA  NA  NA  NA NA 1.959 3.317 2.150
## CI_97.5  0.207 NA  NA  NA  NA  NA NA 3.289 4.771 3.715
## 
## $Benefit
##         groupm a1 ak0 ak1 ak2 ak3 d0    d1    d2    d3
## par     -0.044  1   0   1   2   3  0 2.431 3.332 2.002
## CI_2.5  -0.294 NA  NA  NA  NA  NA NA 1.875 2.711 1.294
## CI_97.5  0.207 NA  NA  NA  NA  NA NA 2.986 3.954 2.710
## 
## $GroupPars
##         MEAN_1 COV_11
## par          0  0.955
## CI_2.5      NA  0.527
## CI_97.5     NA  1.383
</code></pre>

<pre><code class="r">#gpcm to estimate slopes
mod2 &lt;- mixedmirt(Science, covdat, model=1, fixed = ~ 0 + group,
                 itemtype = &#39;gpcm&#39;)
summary(mod2)
</code></pre>

<pre><code>## 
## Call:
## mixedmirt(data = Science, covdata = covdat, model = 1, fixed = ~0 + 
##     group, itemtype = &quot;gpcm&quot;)
## 
## --------------
## FIXED EFFECTS:
##        Estimate Std.Error z.value
## groupm   -0.162     0.093  -1.738
## 
## --------------
## RANDOM EFFECT COVARIANCE(S):
## Correlations on upper diagonal
## 
## $Theta
##    F1
## F1  1
</code></pre>

<pre><code class="r">anova(mod, mod2)
</code></pre>

<pre><code>## 
## Model 1: mixedmirt(data = Science, covdata = covdat, model = 1, fixed = ~0 + 
##     group)
## Model 2: mixedmirt(data = Science, covdata = covdat, model = 1, fixed = ~0 + 
##     group, itemtype = &quot;gpcm&quot;)
</code></pre>

<pre><code>##    AIC AICc SABIC  BIC logLik    X2  df      p
## 1 3268 3269  3280 3324  -1620   NaN NaN    NaN
## 2 3259 3260  3272 3326  -1612 15.68   3 0.0013
</code></pre>

<pre><code class="r">#graded model
mod3 &lt;- mixedmirt(Science, covdat, model=1, fixed = ~ 0 + group,
                 itemtype = &#39;graded&#39;)
coef(mod3)
</code></pre>

<pre><code>## $Comfort
##         groupm    a1    d1    d2     d3
## par     -0.198 0.996 4.912 2.702 -1.354
## CI_2.5  -0.590 0.614 3.953 2.248 -1.753
## CI_97.5  0.194 1.378 5.872 3.157 -0.956
## 
## $Work
##         groupm    a1    d1    d2     d3
## par     -0.198 1.216 3.007 0.990 -2.165
## CI_2.5  -0.590 0.875 2.489 0.629 -2.619
## CI_97.5  0.194 1.556 3.526 1.351 -1.712
## 
## $Future
##         groupm    a1    d1    d2     d3
## par     -0.198 2.520 5.631 2.442 -1.998
## CI_2.5  -0.590 1.394 3.681 1.409 -2.682
## CI_97.5  0.194 3.646 7.581 3.476 -1.314
## 
## $Benefit
##         groupm    a1    d1    d2     d3
## par     -0.198 1.055 3.408 1.072 -1.575
## CI_2.5  -0.590 0.694 2.863 0.739 -1.988
## CI_97.5  0.194 1.416 3.954 1.406 -1.162
## 
## $GroupPars
##         MEAN_1 COV_11
## par          0      1
## CI_2.5      NA     NA
## CI_97.5     NA     NA
</code></pre>

</body>

</html>
