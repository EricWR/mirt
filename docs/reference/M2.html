<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute the M2 model fit statistic — M2 • mirt</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute the M2 model fit statistic — M2" />
<meta property="og:description" content="Computes the M2 (Maydeu-Olivares &amp;amp; Joe, 2006) statistic when all data are dichotomous,
the collapsed M2* statistic (collapsing over univariate and bivariate response categories;
see Cai and Hansen, 2013), and the hybrid C2 statistic which only collapses only the bivariate
moments (Cai and Monro, 2014). The C2 variant is mainly useful when polytomous response models
do not have sufficient degrees of freedom to compute M2*. This function
also computes associated fit indices that are based on
fitting the null model. Supports single and multiple-group models.
If the latent trait density was approximated (e.g., Davidian curves, Empirical histograms, etc)
then passing use_dentype_estimate = TRUE will use the internally saved quadrature and
density components (where applicable)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mirt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.32.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mirt-vignettes.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/philchalmers/mirt/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute the M2 model fit statistic</h1>
    <small class="dont-index">Source: <a href='https://github.com/philchalmers/mirt/blob/master/R/M2.R'><code>R/M2.R</code></a></small>
    <div class="hidden name"><code>M2.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes the M2 (Maydeu-Olivares &amp; Joe, 2006) statistic when all data are dichotomous,
the collapsed M2* statistic (collapsing over univariate and bivariate response categories;
see Cai and Hansen, 2013), and the hybrid C2 statistic which only collapses only the bivariate
moments (Cai and Monro, 2014). The C2 variant is mainly useful when polytomous response models
do not have sufficient degrees of freedom to compute M2*. This function
also computes associated fit indices that are based on
fitting the null model. Supports single and multiple-group models.
If the latent trait density was approximated (e.g., Davidian curves, Empirical histograms, etc)
then passing <code>use_dentype_estimate = TRUE</code> will use the internally saved quadrature and
density components (where applicable).</p>
    </div>

    <pre class="usage"><span class='fu'>M2</span><span class='op'>(</span>
  <span class='va'>obj</span>,
  type <span class='op'>=</span> <span class='st'>"M2*"</span>,
  calcNull <span class='op'>=</span> <span class='cn'>TRUE</span>,
  na.rm <span class='op'>=</span> <span class='cn'>FALSE</span>,
  quadpts <span class='op'>=</span> <span class='cn'>NULL</span>,
  theta_lim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>6</span>, <span class='fl'>6</span><span class='op'>)</span>,
  CI <span class='op'>=</span> <span class='fl'>0.9</span>,
  residmat <span class='op'>=</span> <span class='cn'>FALSE</span>,
  QMC <span class='op'>=</span> <span class='cn'>FALSE</span>,
  suppress <span class='op'>=</span> <span class='fl'>1</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>obj</th>
      <td><p>an estimated model object from the mirt package</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>type of fit statistic to compute. Options are "M2", "M2*" for the univariate and
bivariate collapsed version of the M2 statistic ("M2" currently limited to dichotomous
response data only), and "C2" for a hybrid between
M2 and M2* where only the bivariate moments are collapsed</p></td>
    </tr>
    <tr>
      <th>calcNull</th>
      <td><p>logical; calculate statistics for the null model as well?
Allows for statistics such as the limited information TLI and CFI. Only valid when items all
have a suitable null model (e.g., those created via <code><a href='createItem.html'>createItem</a></code> will not)</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p>logical; remove rows with any missing values? The M2 family of statistics
requires a complete dataset in order to be well defined</p></td>
    </tr>
    <tr>
      <th>quadpts</th>
      <td><p>number of quadrature points to use during estimation. If <code>NULL</code>,
a suitable value will be chosen based
on the rubric found in <code><a href='fscores.html'>fscores</a></code></p></td>
    </tr>
    <tr>
      <th>theta_lim</th>
      <td><p>lower and upper range to evaluate latent trait integral for each dimension</p></td>
    </tr>
    <tr>
      <th>CI</th>
      <td><p>numeric value from 0 to 1 indicating the range of the confidence interval for
RMSEA. Default returns the 90% interval</p></td>
    </tr>
    <tr>
      <th>residmat</th>
      <td><p>logical; return the residual matrix used to compute the SRMSR statistic?
Only the lower triangle of the residual correlation matrix will be returned
(the upper triangle is filled with NA's)</p></td>
    </tr>
    <tr>
      <th>QMC</th>
      <td><p>logical; use quasi-Monte Carlo integration? Useful for higher dimensional models.
If <code>quadpts</code> not specified, 5000 nodes are used by default</p></td>
    </tr>
    <tr>
      <th>suppress</th>
      <td><p>a numeric value indicating which parameter residual dependency combinations
to flag as being too high. Absolute values for the standardized residuals greater than
this value will be returned, while all values less than this value will be set to NA.
Must be used in conjunction with the argument <code>residmat = TRUE</code></p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments to pass</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a data.frame object with the M2-type statistic, along with the degrees of freedom,
  p-value, RMSEA (with 90% confidence interval), SRMSR for each group (if all items were ordinal),
  and optionally the TLI and CFI model fit statistics if <code>calcNull = TRUE</code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Cai, L. &amp; Hansen, M. (2013). Limited-information goodness-of-fit testing of
hierarchical item factor models. <em>British Journal of Mathematical and Statistical
Psychology, 66</em>, 245-276.</p>
<p>Cai, L. &amp; Monro, S. (2014). <em>A new statistic for evaluating item response theory
models for ordinal data</em>. National Center for Research on Evaluation, Standards,
&amp; Student Testing. Technical Report.</p>
<p>Chalmers, R., P. (2012). mirt: A Multidimensional Item Response Theory
Package for the R Environment. <em>Journal of Statistical Software, 48</em>(6), 1-29.
doi: <a href='https://doi.org/10.18637/jss.v048.i06'>10.18637/jss.v048.i06</a></p>
<p>Maydeu-Olivares, A. &amp; Joe, H. (2006). Limited information goodness-of-fit testing in
multidimensional contingency tables. <em>Psychometrika, 71</em>, 713-732.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Phil Chalmers <a href='mailto:rphilip.chalmers@gmail.com'>rphilip.chalmers@gmail.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='fu'><a href='expand.table.html'>expand.table</a></span><span class='op'>(</span><span class='va'>LSAT7</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>(</span><span class='va'>mod1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mirt.html'>mirt</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; mirt(data = dat, model = 1)
#&gt; 
#&gt; Full-information item factor analysis with 1 factor(s).
#&gt; Converged within 1e-04 tolerance after 28 EM iterations.
#&gt; mirt version: 1.32.9 
#&gt; M-step optimizer: BFGS 
#&gt; EM acceleration: Ramsay 
#&gt; Number of rectangular quadrature: 61
#&gt; Latent density type: Gaussian 
#&gt; 
#&gt; Log-likelihood = -2658.805
#&gt; Estimated parameters: 10 
#&gt; AIC = 5337.61; AICc = 5337.833
#&gt; BIC = 5386.688; SABIC = 5354.927
#&gt; G2 (21) = 31.7, p = 0.0628
#&gt; RMSEA = 0.023, CFI = NaN, TLI = NaN</div><div class='input'><span class='fu'>M2</span><span class='op'>(</span><span class='va'>mod1</span><span class='op'>)</span>
</div><div class='output co'>#&gt;             M2 df          p     RMSEA     RMSEA_5   RMSEA_95      SRMSR
#&gt; stats 11.93769  5 0.03565165 0.0372683 0.008950922 0.06496573 0.03195919
#&gt;             TLI       CFI
#&gt; stats 0.9369332 0.9684666</div><div class='input'><span class='fu'>M2</span><span class='op'>(</span><span class='va'>mod1</span>, residmat<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span> <span class='co'>#lower triangle of residual correlation matrix</span>
</div><div class='output co'>#&gt;             Item.1      Item.2       Item.3       Item.4 Item.5
#&gt; Item.1          NA          NA           NA           NA     NA
#&gt; Item.2 -0.02212010          NA           NA           NA     NA
#&gt; Item.3 -0.03265942  0.03335601           NA           NA     NA
#&gt; Item.4  0.05155184 -0.01642572 -0.012476892           NA     NA
#&gt; Item.5  0.05443241 -0.03867705 -0.001860395 7.235426e-05     NA</div><div class='input'>
<span class='co'>#M2 with missing data present</span>
<span class='va'>dat</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/prod.html'>prod</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span><span class='op'>)</span>, <span class='fl'>250</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
<span class='va'>mod2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mirt.html'>mirt</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span><span class='op'>)</span>
<span class='co'># Compute stats by removing missing data row-wise</span>
<span class='fu'>M2</span><span class='op'>(</span><span class='va'>mod2</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Sample size after row-wise response data removal: 773</span></div><div class='output co'>#&gt;             M2 df          p      RMSEA    RMSEA_5   RMSEA_95      SRMSR
#&gt; stats 13.13517  5 0.02214451 0.04590813 0.01594371 0.07697174 0.04017033
#&gt;             TLI       CFI
#&gt; stats 0.9088344 0.9544172</div><div class='input'>
<span class='co'># C2 statistic (useful when polytomous IRT models have too few df)</span>
<span class='va'>pmod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mirt.html'>mirt</a></span><span class='op'>(</span><span class='va'>Science</span>, <span class='fl'>1</span><span class='op'>)</span>
<span class='co'># This fails with too few df:</span>
<span class='co'># M2(pmod)</span>
<span class='co'># This, however, works:</span>
<span class='fu'>M2</span><span class='op'>(</span><span class='va'>pmod</span>, type <span class='op'>=</span> <span class='st'>'C2'</span><span class='op'>)</span>
</div><div class='output co'>#&gt;             M2 df           p     RMSEA    RMSEA_5  RMSEA_95      SRMSR
#&gt; stats 19.17929  2 6.84337e-05 0.1482174 0.09234204 0.2116368 0.07257313
#&gt;             TLI       CFI
#&gt; stats 0.7300952 0.9100317</div><div class='input'>
<span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


