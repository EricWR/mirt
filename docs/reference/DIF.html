<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Differential item functioning statistics — DIF • mirt</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Differential item functioning statistics — DIF" />
<meta property="og:description" content="This function runs the Wald and likelihood-ratio approaches for testing differential
item functioning (DIF). This is primarily a convenience wrapper to the
multipleGroup function for performing standard DIF procedures. Independent
models can be estimated in parallel by defining a parallel object with mirtCluster,
which will help to decrease the runtime. For best results, the baseline model should contain
a set of 'anchor' items and have freely estimated hyper-parameters in the focal groups." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mirt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.32.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mirt-vignettes.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/philchalmers/mirt/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Differential item functioning statistics</h1>
    <small class="dont-index">Source: <a href='https://github.com/philchalmers/mirt/blob/master/R/DIF.R'><code>R/DIF.R</code></a></small>
    <div class="hidden name"><code>DIF.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function runs the Wald and likelihood-ratio approaches for testing differential
item functioning (DIF). This is primarily a convenience wrapper to the
<code><a href='multipleGroup.html'>multipleGroup</a></code> function for performing standard DIF procedures. Independent
models can be estimated in parallel by defining a parallel object with <code><a href='mirtCluster.html'>mirtCluster</a></code>,
which will help to decrease the runtime. For best results, the baseline model should contain
a set of 'anchor' items and have freely estimated hyper-parameters in the focal groups.</p>
    </div>

    <pre class="usage"><span class='fu'>DIF</span><span class='op'>(</span>
  <span class='va'>MGmodel</span>,
  <span class='va'>which.par</span>,
  scheme <span class='op'>=</span> <span class='st'>"add"</span>,
  items2test <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='extract.mirt.html'>extract.mirt</a></span><span class='op'>(</span><span class='va'>MGmodel</span>, <span class='st'>"nitems"</span><span class='op'>)</span>,
  seq_stat <span class='op'>=</span> <span class='st'>"SABIC"</span>,
  Wald <span class='op'>=</span> <span class='cn'>FALSE</span>,
  p.adjust <span class='op'>=</span> <span class='st'>"none"</span>,
  return_models <span class='op'>=</span> <span class='cn'>FALSE</span>,
  return_seq_model <span class='op'>=</span> <span class='cn'>FALSE</span>,
  max_run <span class='op'>=</span> <span class='cn'>Inf</span>,
  plotdif <span class='op'>=</span> <span class='cn'>FALSE</span>,
  type <span class='op'>=</span> <span class='st'>"trace"</span>,
  simplify <span class='op'>=</span> <span class='cn'>TRUE</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>MGmodel</th>
      <td><p>an object returned from <code><a href='multipleGroup.html'>multipleGroup</a></code> to be used as the reference
model</p></td>
    </tr>
    <tr>
      <th>which.par</th>
      <td><p>a character vector containing the parameter names which will be inspected for
DIF</p></td>
    </tr>
    <tr>
      <th>scheme</th>
      <td><p>type of DIF analysis to perform, either by adding or dropping constraints across
  groups. These can be:</p><dl>
  <dt>'add'</dt><dd><p>parameters in <code>which.par</code> will be constrained each item one at a time for
    items that are specified in <code>items2test</code>. This is beneficial when examining DIF from a
    model with parameters freely estimated across groups, and when inspecting differences via
    the Wald test</p></dd>
  <dt>'drop'</dt><dd><p>parameters in <code>which.par</code> will be freely estimated for items that are
    specified in <code>items2test</code>. This is useful when supplying an overly restrictive model
    and attempting to detect DIF with a slightly less restrictive model</p></dd>
  <dt>'add_sequential'</dt><dd><p>sequentially loop over the items being tested, and at the end of the
    loop treat DIF tests that satisfy the <code>seq_stat</code> criteria as invariant. The loop is
    then re-run on the remaining invariant items to determine if they are now displaying DIF in
    the less constrained model, and when no new invariant item is found the algorithm stops and
    returns the items that displayed DIF. Note that the DIF statistics are relative to this final,
    less constrained model which includes the DIF effects</p></dd>
  <dt>'drop_sequential'</dt><dd><p>sequentially loop over the items being tested, and at the end of the
    loop treat items that violate the <code>seq_stat</code> criteria as demonstrating DIF. The loop is
    then re-run, leaving the items that previously demonstrated DIF as variable across groups,
    and the remaining test items that previously showed invariance are re-tested. The algorithm
    stops when no more items showing DIF are found and returns the items that displayed DIF.
    Note that the DIF statistics are relative to this final,
    less constrained model which includes the DIF effects</p></dd>

</dl></td>
    </tr>
    <tr>
      <th>items2test</th>
      <td><p>a numeric vector, or character vector containing the item names, indicating
which items will be tested for DIF. In models where anchor items are known, omit them from
this vector. For example, if items 1 and 2 are anchors in a 10 item test, then
<code>items2test = 3:10</code> would work for testing the remaining items (important to remember
when using sequential schemes)</p></td>
    </tr>
    <tr>
      <th>seq_stat</th>
      <td><p>select a statistic to test for in the sequential schemes. Potential values are
(in descending order of power) <code>'AIC'</code>, <code>'AICc'</code>, <code>'SABIC'</code>, <code>'HQ'</code>, and <code>'BIC'</code>.
If a numeric value is input that ranges between 0 and 1, the 'p' value will be tested
(e.g., <code>seq_stat = .05</code> will test for the difference of p &lt; .05 in the add scheme,
or p &gt; .05 in the drop scheme), along with the specified <code>p.adjust</code> input.
For models fitted with prior distributions <code>'DIC'</code> is also supported, though for these models
the p-value approach is not</p></td>
    </tr>
    <tr>
      <th>Wald</th>
      <td><p>logical; perform Wald tests for DIF instead of likelihood ratio test?</p></td>
    </tr>
    <tr>
      <th>p.adjust</th>
      <td><p>string to be passed to the <code><a href='https://rdrr.io/r/stats/p.adjust.html'>p.adjust</a></code> function to adjust p-values.
Adjustments are located in the <code>adj_pvals</code> element in the returned list</p></td>
    </tr>
    <tr>
      <th>return_models</th>
      <td><p>logical; return estimated model objects for further analysis?
Default is FALSE</p></td>
    </tr>
    <tr>
      <th>return_seq_model</th>
      <td><p>logical; on the last iteration of the sequential schemes, return
the fitted multiple-group model containing the freely estimated parameters indicative of
DIF? This is generally only useful when <code>scheme = 'add_sequential'</code>. Default is FALSE</p></td>
    </tr>
    <tr>
      <th>max_run</th>
      <td><p>a number indicating the maximum number of cycles to perform in sequential
searches. The default is to perform search until no further DIF is found</p></td>
    </tr>
    <tr>
      <th>plotdif</th>
      <td><p>logical; create item plots for items that are displaying DIF according to the
<code>seq_stat</code> criteria? Only available for 'add' type schemes</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>the <code>type</code> of plot argument passed to <code><a href='https://rdrr.io/r/graphics/plot.html'>plot()</a></code>. Default is 'trace', though
another good option is 'infotrace'. For ease of viewing, the <code>facet_item</code> argument to
mirt's <code><a href='https://rdrr.io/r/graphics/plot.html'>plot()</a></code> function is set to <code>TRUE</code></p></td>
    </tr>
    <tr>
      <th>simplify</th>
      <td><p>logical; simplify the output by returning a data.frame object with
the differences between AIC, BIC, etc, as well as the chi-squared test (X2) and associated
df and p-values</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical print extra information to the console?</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments to be passed to <code><a href='multipleGroup.html'>multipleGroup</a></code> and <code>plot</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Generally, the precomputed baseline model should have been
configured with two estimation properties: 1) a set of 'anchor' items,
where the anchor items have various parameters that have been constrained to be equal
across the groups, and 2) contain freely estimated latent mean and variance terms in
all but one group (the so-called 'reference' group).
These two properties help to fix the metric of the groups so that
item parameter estimates do not contain latent distribution characteristics.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Chalmers, R., P. (2012). mirt: A Multidimensional Item Response Theory
Package for the R Environment. <em>Journal of Statistical Software, 48</em>(6), 1-29.
doi: <a href='https://doi.org/10.18637/jss.v048.i06'>10.18637/jss.v048.i06</a></p>
<p>Chalmers, R. P., Counsell, A., and Flora, D. B. (2016). It might not
  make a big DIF: Improved Differential Test Functioning statistics that account for
  sampling variability. <em>Educational and Psychological Measurement, 76</em>, 114-140.
  doi: <a href='https://doi.org/10.1177/0013164415584576'>10.1177/0013164415584576</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='multipleGroup.html'>multipleGroup</a></code>, <code><a href='DRF.html'>DRF</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Phil Chalmers <a href='mailto:rphilip.chalmers@gmail.com'>rphilip.chalmers@gmail.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>

<span class='co'># simulate data where group 2 has a smaller slopes and more extreme intercepts</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span>
<span class='va'>a1</span> <span class='op'>&lt;-</span> <span class='va'>a2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>15</span>,<span class='fl'>1</span>,<span class='fl'>.3</span><span class='op'>)</span><span class='op'>)</span>, ncol<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>d1</span> <span class='op'>&lt;-</span> <span class='va'>d2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>15</span>,<span class='fl'>0</span>,<span class='fl'>.7</span><span class='op'>)</span>,ncol<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>a2</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span>, <span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>a1</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span>, <span class='op'>]</span><span class='op'>/</span><span class='fl'>3</span>
<span class='va'>d1</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>3</span><span class='op'>)</span>, <span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>d2</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>3</span><span class='op'>)</span>, <span class='op'>]</span><span class='op'>/</span><span class='fl'>4</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>a.group1 <span class='op'>=</span> <span class='va'>a1</span>, a.group2 <span class='op'>=</span> <span class='va'>a2</span>, d.group1 <span class='op'>=</span> <span class='va'>d1</span>, d.group2 <span class='op'>=</span> <span class='va'>d2</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    a.group1  a.group2    d.group1   d.group2
#&gt; 1 1.1756586 0.3918862  0.14295747  0.5718299
#&gt; 2 1.2128398 0.4042799 -0.62045026 -0.6204503
#&gt; 3 0.9672090 0.9672090 -0.05802608 -0.2321043
#&gt; 4 0.8639508 0.8639508  0.78449886  0.7844989
#&gt; 5 1.1817662 1.1817662  0.20910659  0.2091066
#&gt; 6 0.4546132 0.4546132  0.54573535  0.5457353</div><div class='input'><span class='va'>itemtype</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'2PL'</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>a1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>1000</span>
<span class='va'>dataset1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a1</span>, <span class='va'>d1</span>, <span class='va'>N</span>, <span class='va'>itemtype</span><span class='op'>)</span>
<span class='va'>dataset2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a2</span>, <span class='va'>d2</span>, <span class='va'>N</span>, <span class='va'>itemtype</span>, mu <span class='op'>=</span> <span class='fl'>.1</span>, sigma <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>1.5</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>dataset1</span>, <span class='va'>dataset2</span><span class='op'>)</span>
<span class='va'>group</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'D1'</span>, <span class='va'>N</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'D2'</span>, <span class='va'>N</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#### no anchors, all items tested for DIF by adding item constrains one item at a time.</span>
<span class='co'># define a parallel cluster (optional) to help speed up internal functions</span>
<span class='fu'><a href='mirtCluster.html'>mirtCluster</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='co'># Information matrix with Oakes' identity (not controlling for latent group differences)</span>
<span class='co'># NOTE: Without properly equating the groups the following example code is not testing for DIF,</span>
     <span class='co'># but instead reflects a combination of DIF + latent-trait distribution effects</span>
<span class='va'>model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='multipleGroup.html'>multipleGroup</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span>, <span class='va'>group</span>, SE <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># Likelihood-ratio test for DIF (as well as model information)</span>
<span class='fu'>DIF</span><span class='op'>(</span><span class='va'>model</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'a1'</span>, <span class='st'>'d'</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>No hyper-parameters were estimated in the DIF model. For effective DIF testing, freeing the focal group hyper-parameters is recommended.</span></div><div class='output co'>#&gt;             AIC    AICc   SABIC      HQ     BIC     X2 df     p
#&gt; Item_1  -34.621 -34.371 -29.773 -30.507 -23.419 38.621  2 0.000
#&gt; Item_2  -20.364 -20.115 -15.516 -16.251  -9.162 24.364  2 0.000
#&gt; Item_3  -10.101  -9.852  -5.253  -5.988   1.101 14.101  2 0.001
#&gt; Item_4   -0.356  -0.106   4.492   3.757  10.846  4.356  2 0.113
#&gt; Item_5    0.968   1.217   5.815   5.081  12.169  3.032  2 0.220
#&gt; Item_6    3.441   3.690   8.289   7.554  14.643  0.559  2 0.756
#&gt; Item_7    3.340   3.589   8.188   7.453  14.542  0.660  2 0.719
#&gt; Item_8   -2.371  -2.122   2.477   1.742   8.831  6.371  2 0.041
#&gt; Item_9    0.546   0.795   5.393   4.659  11.748  3.454  2 0.178
#&gt; Item_10   3.215   3.464   8.062   7.328  14.416  0.785  2 0.675
#&gt; Item_11  -4.853  -4.604  -0.006  -0.740   6.348  8.853  2 0.012
#&gt; Item_12   1.497   1.746   6.345   5.610  12.699  2.503  2 0.286
#&gt; Item_13   1.854   2.103   6.702   5.967  13.056  2.146  2 0.342
#&gt; Item_14  -4.350  -4.101   0.498  -0.237   6.852  8.350  2 0.015
#&gt; Item_15   3.831   4.080   8.679   7.944  15.033  0.169  2 0.919</div><div class='input'><span class='fu'>DIF</span><span class='op'>(</span><span class='va'>model</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'a1'</span>, <span class='st'>'d'</span><span class='op'>)</span>, simplify<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='co'># return list output</span>
</div><div class='output co'>#&gt; <span class='message'>No hyper-parameters were estimated in the DIF model. For effective DIF testing, freeing the focal group hyper-parameters is recommended.</span></div><div class='output co'>#&gt; $Item_1
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik     X2  df   p
#&gt; 1 36327.60 36331.12 36468.18 36446.87 36652.45 -18105.80    NaN NaN NaN
#&gt; 2 36292.97 36296.75 36438.41 36416.37 36629.03 -18086.49 38.621   2   0
#&gt; 
#&gt; $Item_2
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik     X2  df   p
#&gt; 1 36313.34 36316.86 36453.92 36432.62 36638.19 -18098.67    NaN NaN NaN
#&gt; 2 36292.97 36296.75 36438.41 36416.37 36629.03 -18086.49 24.364   2   0
#&gt; 
#&gt; $Item_3
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik     X2  df     p
#&gt; 1 36303.07 36306.60 36443.66 36422.35 36627.93 -18093.54    NaN NaN   NaN
#&gt; 2 36292.97 36296.75 36438.41 36416.37 36629.03 -18086.49 14.101   2 0.001
#&gt; 
#&gt; $Item_4
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 36293.33 36296.86 36433.91 36412.61 36618.18 -18088.67   NaN NaN   NaN
#&gt; 2 36292.97 36296.75 36438.41 36416.37 36629.03 -18086.49 4.356   2 0.113
#&gt; 
#&gt; $Item_5
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df    p
#&gt; 1 36292.01 36295.53 36432.59 36411.29 36616.86 -18088.00   NaN NaN  NaN
#&gt; 2 36292.97 36296.75 36438.41 36416.37 36629.03 -18086.49 3.032   2 0.22
#&gt; 
#&gt; $Item_6
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 36289.53 36293.06 36430.12 36408.81 36614.39 -18086.77   NaN NaN   NaN
#&gt; 2 36292.97 36296.75 36438.41 36416.37 36629.03 -18086.49 0.559   2 0.756
#&gt; 
#&gt; $Item_7
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik   X2  df     p
#&gt; 1 36289.63 36293.16 36430.22 36408.91 36614.49 -18086.82  NaN NaN   NaN
#&gt; 2 36292.97 36296.75 36438.41 36416.37 36629.03 -18086.49 0.66   2 0.719
#&gt; 
#&gt; $Item_8
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 36295.35 36298.87 36435.93 36414.62 36620.20 -18089.67   NaN NaN   NaN
#&gt; 2 36292.97 36296.75 36438.41 36416.37 36629.03 -18086.49 6.371   2 0.041
#&gt; 
#&gt; $Item_9
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 36292.43 36295.96 36433.01 36411.71 36617.28 -18088.21   NaN NaN   NaN
#&gt; 2 36292.97 36296.75 36438.41 36416.37 36629.03 -18086.49 3.454   2 0.178
#&gt; 
#&gt; $Item_10
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 36289.76 36293.29 36430.34 36409.04 36614.61 -18086.88   NaN NaN   NaN
#&gt; 2 36292.97 36296.75 36438.41 36416.37 36629.03 -18086.49 0.785   2 0.675
#&gt; 
#&gt; $Item_11
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 36297.83 36301.35 36438.41 36417.11 36622.68 -18090.91   NaN NaN   NaN
#&gt; 2 36292.97 36296.75 36438.41 36416.37 36629.03 -18086.49 8.853   2 0.012
#&gt; 
#&gt; $Item_12
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 36291.48 36295.00 36432.06 36410.76 36616.33 -18087.74   NaN NaN   NaN
#&gt; 2 36292.97 36296.75 36438.41 36416.37 36629.03 -18086.49 2.503   2 0.286
#&gt; 
#&gt; $Item_13
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 36291.12 36294.65 36431.70 36410.40 36615.97 -18087.56   NaN NaN   NaN
#&gt; 2 36292.97 36296.75 36438.41 36416.37 36629.03 -18086.49 2.146   2 0.342
#&gt; 
#&gt; $Item_14
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik   X2  df     p
#&gt; 1 36297.32 36300.85 36437.91 36416.60 36622.18 -18090.66  NaN NaN   NaN
#&gt; 2 36292.97 36296.75 36438.41 36416.37 36629.03 -18086.49 8.35   2 0.015
#&gt; 
#&gt; $Item_15
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 36289.14 36292.67 36429.73 36408.42 36614.00 -18086.57   NaN NaN   NaN
#&gt; 2 36292.97 36296.75 36438.41 36416.37 36629.03 -18086.49 0.169   2 0.919
#&gt; </div><div class='input'>
<span class='co'># same as above, but using Wald tests with Benjamini &amp; Hochberg adjustment</span>
<span class='fu'>DIF</span><span class='op'>(</span><span class='va'>model</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'a1'</span>, <span class='st'>'d'</span><span class='op'>)</span>, Wald <span class='op'>=</span> <span class='cn'>TRUE</span>, p.adjust <span class='op'>=</span> <span class='st'>'fdr'</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>No hyper-parameters were estimated in the DIF model. For effective DIF testing, freeing the focal group hyper-parameters is recommended.</span></div><div class='output co'>#&gt;              W df     p adj_pvals
#&gt; Item_1  36.513  2 0.000     0.000
#&gt; Item_2  22.089  2 0.000     0.000
#&gt; Item_3  13.444  2 0.001     0.006
#&gt; Item_4   4.293  2 0.117     0.251
#&gt; Item_5   3.009  2 0.222     0.370
#&gt; Item_6   0.558  2 0.756     0.810
#&gt; Item_7   0.658  2 0.720     0.810
#&gt; Item_8   6.238  2 0.044     0.111
#&gt; Item_9   3.438  2 0.179     0.336
#&gt; Item_10  0.785  2 0.675     0.810
#&gt; Item_11  8.621  2 0.013     0.050
#&gt; Item_12  2.485  2 0.289     0.433
#&gt; Item_13  2.133  2 0.344     0.469
#&gt; Item_14  8.062  2 0.018     0.053
#&gt; Item_15  0.168  2 0.919     0.919</div><div class='input'>
<span class='co'># equate the groups by assuming the last 5 items have no DIF</span>
<span class='va'>itemnames</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span>
<span class='va'>model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='multipleGroup.html'>multipleGroup</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span>, <span class='va'>group</span>, SE <span class='op'>=</span> <span class='cn'>TRUE</span>,
   invariance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>itemnames</span><span class='op'>[</span><span class='fl'>11</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span><span class='op'>]</span>, <span class='st'>'free_means'</span>, <span class='st'>'free_var'</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># test whether adding slopes and intercepts constraints results in DIF. Plot items showing DIF</span>
<span class='va'>resulta1d</span> <span class='op'>&lt;-</span> <span class='fu'>DIF</span><span class='op'>(</span><span class='va'>model</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'a1'</span>, <span class='st'>'d'</span><span class='op'>)</span>, plotdif <span class='op'>=</span> <span class='cn'>TRUE</span>, items2test<span class='op'>=</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span>
</div><div class='img'><img src='DIF-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>resulta1d</span>
</div><div class='output co'>#&gt;             AIC    AICc   SABIC      HQ     BIC     X2 df     p
#&gt; Item_1  -43.490 -43.276 -38.642 -39.377 -32.288 47.490  2 0.000
#&gt; Item_2  -33.840 -33.626 -28.993 -29.727 -22.638 37.840  2 0.000
#&gt; Item_3   -5.497  -5.282  -0.649  -1.384   5.705  9.497  2 0.009
#&gt; Item_4    2.395   2.609   7.242   6.508  13.596  1.605  2 0.448
#&gt; Item_5    3.140   3.354   7.988   7.253  14.342  0.860  2 0.651
#&gt; Item_6    1.122   1.336   5.970   5.235  12.324  2.878  2 0.237
#&gt; Item_7    3.083   3.297   7.931   7.196  14.285  0.917  2 0.632
#&gt; Item_8    2.857   3.071   7.705   6.970  14.059  1.143  2 0.565
#&gt; Item_9    3.674   3.888   8.521   7.787  14.875  0.326  2 0.849
#&gt; Item_10   3.154   3.368   8.001   7.267  14.355  0.846  2 0.655</div><div class='input'>
<span class='co'># test whether adding only slope constraints results in DIF for all items</span>
<span class='fu'>DIF</span><span class='op'>(</span><span class='va'>model</span>, <span class='st'>'a1'</span>, items2test<span class='op'>=</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span>
</div><div class='output co'>#&gt;             AIC    AICc   SABIC      HQ     BIC     X2 df     p
#&gt; Item_1  -20.871 -20.763 -18.447 -18.815 -15.270 22.871  1 0.000
#&gt; Item_2  -34.676 -34.567 -32.252 -32.619 -29.075 36.676  1 0.000
#&gt; Item_3    0.435   0.543   2.859   2.492   6.036  1.565  1 0.211
#&gt; Item_4    1.980   2.088   4.404   4.036   7.581  0.020  1 0.887
#&gt; Item_5    1.754   1.862   4.178   3.811   7.355  0.246  1 0.620
#&gt; Item_6   -0.564  -0.456   1.860   1.492   5.037  2.564  1 0.109
#&gt; Item_7    1.093   1.202   3.517   3.150   6.694  0.907  1 0.341
#&gt; Item_8    1.431   1.540   3.855   3.488   7.032  0.569  1 0.451
#&gt; Item_9    1.863   1.972   4.287   3.920   7.464  0.137  1 0.712
#&gt; Item_10   1.775   1.884   4.199   3.832   7.376  0.225  1 0.636</div><div class='input'>
<span class='co'># Determine whether it's a1 or d parameter causing DIF (could be joint, however)</span>
<span class='op'>(</span><span class='va'>a1s</span> <span class='op'>&lt;-</span> <span class='fu'>DIF</span><span class='op'>(</span><span class='va'>model</span>, <span class='st'>'a1'</span>, items2test <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;            AIC    AICc   SABIC      HQ     BIC     X2 df     p
#&gt; Item_1 -20.871 -20.763 -18.447 -18.815 -15.270 22.871  1 0.000
#&gt; Item_2 -34.676 -34.567 -32.252 -32.619 -29.075 36.676  1 0.000
#&gt; Item_3   0.435   0.543   2.859   2.492   6.036  1.565  1 0.211</div><div class='input'><span class='op'>(</span><span class='va'>ds</span> <span class='op'>&lt;-</span> <span class='fu'>DIF</span><span class='op'>(</span><span class='va'>model</span>, <span class='st'>'d'</span>, items2test <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;            AIC    AICc   SABIC      HQ     BIC     X2 df     p
#&gt; Item_1 -18.568 -18.460 -16.145 -16.512 -12.968 20.568  1 0.000
#&gt; Item_2   1.843   1.951   4.266   3.899   7.443  0.157  1 0.691
#&gt; Item_3  -6.229  -6.121  -3.805  -4.173  -0.628  8.229  1 0.004</div><div class='input'>
<span class='co'>### drop down approach (freely estimating parameters across groups) when</span>
<span class='co'>### specifying a highly constrained model with estimated latent parameters</span>
<span class='va'>model_constrained</span> <span class='op'>&lt;-</span> <span class='fu'><a href='multipleGroup.html'>multipleGroup</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span>, <span class='va'>group</span>,
  invariance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span>, <span class='st'>'free_means'</span>, <span class='st'>'free_var'</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dropdown</span> <span class='op'>&lt;-</span> <span class='fu'>DIF</span><span class='op'>(</span><span class='va'>model_constrained</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'a1'</span>, <span class='st'>'d'</span><span class='op'>)</span>, scheme <span class='op'>=</span> <span class='st'>'drop'</span><span class='op'>)</span>
<span class='va'>dropdown</span>
</div><div class='output co'>#&gt;             AIC    AICc   SABIC      HQ     BIC     X2 df     p
#&gt; Item_1  -43.297 -43.160 -38.450 -39.184 -32.096 47.297  2 0.000
#&gt; Item_2  -32.642 -32.504 -27.794 -28.529 -21.440 36.642  2 0.000
#&gt; Item_3  -10.510 -10.372  -5.662  -6.397   0.692 14.510  2 0.001
#&gt; Item_4    1.885   2.023   6.733   5.998  13.087  2.115  2 0.347
#&gt; Item_5    3.155   3.293   8.003   7.268  14.357  0.845  2 0.655
#&gt; Item_6    1.914   2.051   6.761   6.027  13.116  2.086  2 0.352
#&gt; Item_7    3.887   4.025   8.735   8.000  15.089  0.113  2 0.945
#&gt; Item_8    0.703   0.840   5.550   4.816  11.905  3.297  2 0.192
#&gt; Item_9    3.059   3.197   7.907   7.172  14.261  0.941  2 0.625
#&gt; Item_10   3.631   3.769   8.479   7.744  14.833  0.369  2 0.832
#&gt; Item_11  -0.765  -0.627   4.083   3.348  10.437  4.765  2 0.092
#&gt; Item_12   3.511   3.649   8.359   7.624  14.713  0.489  2 0.783
#&gt; Item_13   3.416   3.553   8.263   7.529  14.618  0.584  2 0.747
#&gt; Item_14  -0.690  -0.553   4.157   3.423  10.511  4.690  2 0.096
#&gt; Item_15   3.599   3.737   8.447   7.712  14.801  0.401  2 0.818</div><div class='input'>
<span class='co'>### sequential schemes (add constraints)</span>

<span class='co'>### sequential searches using SABIC as the selection criteria</span>
<span class='co'># starting from completely different models</span>
<span class='va'>stepup</span> <span class='op'>&lt;-</span> <span class='fu'>DIF</span><span class='op'>(</span><span class='va'>model</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'a1'</span>, <span class='st'>'d'</span><span class='op'>)</span>, scheme <span class='op'>=</span> <span class='st'>'add_sequential'</span>,
              items2test<span class='op'>=</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Checking for DIF in 3 more items
#&gt; Computing final DIF estimates...</div><div class='input'><span class='va'>stepup</span>
</div><div class='output co'>#&gt;            AIC    AICc   SABIC      HQ     BIC     X2 df     p
#&gt; Item_1 -43.161 -43.007 -38.314 -39.048 -31.959 47.161  2 0.000
#&gt; Item_2 -34.224 -34.070 -29.377 -30.111 -23.022 38.224  2 0.000
#&gt; Item_3  -7.368  -7.214  -2.520  -3.255   3.834 11.368  2 0.003</div><div class='input'>
<span class='co'># step down procedure for highly constrained model</span>
<span class='va'>stepdown</span> <span class='op'>&lt;-</span> <span class='fu'>DIF</span><span class='op'>(</span><span class='va'>model_constrained</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'a1'</span>, <span class='st'>'d'</span><span class='op'>)</span>, scheme <span class='op'>=</span> <span class='st'>'drop_sequential'</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Checking for DIF in 12 more items
#&gt; Computing final DIF estimates...</div><div class='input'><span class='va'>stepdown</span>
</div><div class='output co'>#&gt;            AIC    AICc   SABIC      HQ     BIC     X2 df     p
#&gt; Item_1 -43.161 -43.007 -38.314 -39.048 -31.959 47.161  2 0.000
#&gt; Item_2 -34.224 -34.070 -29.377 -30.111 -23.022 38.224  2 0.000
#&gt; Item_3  -7.368  -7.214  -2.520  -3.255   3.834 11.368  2 0.003</div><div class='input'>
<span class='co'># view final MG model (only useful when scheme is 'add_sequential')</span>
<span class='va'>updated_mod</span> <span class='op'>&lt;-</span> <span class='fu'>DIF</span><span class='op'>(</span><span class='va'>model</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'a1'</span>, <span class='st'>'d'</span><span class='op'>)</span>, scheme <span class='op'>=</span> <span class='st'>'add_sequential'</span>,
               return_seq_model<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Checking for DIF in 3 more items
#&gt; Computing final DIF estimates...</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>updated_mod</span>, type<span class='op'>=</span><span class='st'>'trace'</span><span class='op'>)</span>
</div><div class='img'><img src='DIF-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


