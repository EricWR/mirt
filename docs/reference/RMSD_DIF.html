<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>RMSD effect size statistic to quantify category-level DIF — RMSD_DIF • mirt</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="RMSD effect size statistic to quantify category-level DIF — RMSD_DIF" />
<meta property="og:description" content="This function computes a set of RMSD &quot;badness-of-fit&quot; statistics when investing
DIF across a set of grouping variables. In a first step, a (potentially highly constrained)
multiple group model is fitted, while in a second step the item (and person) parameters
are estimated based on all examines across all groups. Category level DIF is assessed
based on how well the pseudo-table of counts match the (constrained) probability functions
implied by the original multiple group model (while also weighing across the implied density
function of the latent traits). If the RSMD fit is poor, indicating non-ignorable DIF,
then the multiple-group model should be adjusted to better account for the large response bias
due to using a pooled model. See Lee and von Davier (2020) and Buchholz and Hartig (2019) for details." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mirt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.32.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mirt-vignettes.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/philchalmers/mirt/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>RMSD effect size statistic to quantify category-level DIF</h1>
    <small class="dont-index">Source: <a href='https://github.com/philchalmers/mirt/blob/master/R/RMSD_DIF.R'><code>R/RMSD_DIF.R</code></a></small>
    <div class="hidden name"><code>RMSD_DIF.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function computes a set of RMSD "badness-of-fit" statistics when investing
DIF across a set of grouping variables. In a first step, a (potentially highly constrained)
multiple group model is fitted, while in a second step the item (and person) parameters
are estimated based on all examines across all groups. Category level DIF is assessed
based on how well the pseudo-table of counts match the (constrained) probability functions
implied by the original multiple group model (while also weighing across the implied density
function of the latent traits). If the RSMD fit is poor, indicating non-ignorable DIF,
then the multiple-group model should be adjusted to better account for the large response bias
due to using a pooled model. See Lee and von Davier (2020) and Buchholz and Hartig (2019) for details.</p>
    </div>

    <pre class="usage"><span class='fu'>RMSD_DIF</span><span class='op'>(</span><span class='va'>pooled_mod</span>, flag <span class='op'>=</span> <span class='fl'>0</span>, probfun <span class='op'>=</span> <span class='cn'>TRUE</span>, dentype <span class='op'>=</span> <span class='st'>"norm"</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>pooled_mod</th>
      <td><p>a multiple-group model (used to compute the model-implied
probability in the goodness-of-fit test)</p></td>
    </tr>
    <tr>
      <th>flag</th>
      <td><p>a numeric value used as a cut-off to help flag larger RMSD values
(e.g., <code>flag = .03</code> will highlight only categories with RMSD values greater than
.03)</p></td>
    </tr>
    <tr>
      <th>probfun</th>
      <td><p>logical; use probability functions to compute RMSD? If FALSE, the expected score
functions will be integrated instead, which may be useful for collapsing across the
categories in polytomous items</p></td>
    </tr>
    <tr>
      <th>dentype</th>
      <td><p>density to use for the latent trait.
Can be <code>'norm'</code> to use a normal Gaussian density where the mean/variance are extracted
from the model object(default), <code>'snorm'</code> for a standard normal distribution,
or <code>'empirical'</code> to use the density estimate obtained via the E-table</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Buchholz, J., and Hartig, J. (2019). Comparing Attitudes Across Groups: An IRT-Based Item-Fit Statistic
  for the Analysis of Measurement Invariance. <em>Applied Psychological Measurement, 43</em>(3), 241-250.</p>
<p>Lee, S. S., and von Davier, M. (2020). Improving measurement properties of the PISA home
  possessions scale through partial invariance modeling.
  <em>Psychological test and assessment modeling</em>, 62(1):55-83.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='DIF.html'>DIF</a></code>, <code><a href='DRF.html'>DRF</a></code>, <code><a href='multipleGroup.html'>multipleGroup</a></code>, <code><a href='empirical_ES.html'>empirical_ES</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Phil Chalmers <a href='mailto:rphilip.chalmers@gmail.com'>rphilip.chalmers@gmail.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># \donttest{</span>

<span class='co'>#----- generate some data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span>
<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='va'>a2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>15</span>,<span class='fl'>1</span>,<span class='fl'>.3</span><span class='op'>)</span><span class='op'>)</span>, ncol<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='va'>d2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>15</span>,<span class='fl'>0</span>,<span class='fl'>.7</span><span class='op'>)</span>,ncol<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>

<span class='co'># item 1 has DIF</span>
<span class='va'>d2</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>d</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>-</span> <span class='fl'>.5</span>
<span class='va'>a2</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>a</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>+</span> <span class='fl'>1</span>

<span class='va'>itemtype</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'2PL'</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>a</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>1000</span>
<span class='va'>dataset1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='va'>N</span>, <span class='va'>itemtype</span><span class='op'>)</span>
<span class='va'>dataset2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a2</span>, <span class='va'>d2</span>, <span class='va'>N</span>, <span class='va'>itemtype</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>dataset1</span>, <span class='va'>dataset2</span><span class='op'>)</span>
<span class='va'>group</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'D1'</span>, <span class='va'>N</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'D2'</span>, <span class='va'>N</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#-----</span>

<span class='co'># fully pooled model</span>
<span class='va'>pooled_mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='multipleGroup.html'>multipleGroup</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span>, group<span class='op'>=</span><span class='va'>group</span>,
   invariance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span>, <span class='st'>'free_mean'</span>, <span class='st'>'free_var'</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>pooled_mod</span>, simplify<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $D1
#&gt; $items
#&gt;            a1      d g u
#&gt; Item_1  1.441  0.358 0 1
#&gt; Item_2  1.136 -0.590 0 1
#&gt; Item_3  0.996 -0.237 0 1
#&gt; Item_4  0.902  0.921 0 1
#&gt; Item_5  1.060  0.153 0 1
#&gt; Item_6  0.440  0.637 0 1
#&gt; Item_7  1.170  1.023 0 1
#&gt; Item_8  0.904 -0.353 0 1
#&gt; Item_9  0.875 -0.978 0 1
#&gt; Item_10 0.665 -1.120 0 1
#&gt; Item_11 0.939  1.243 0 1
#&gt; Item_12 1.336 -0.194 0 1
#&gt; Item_13 1.250  0.481 0 1
#&gt; Item_14 1.050  0.444 0 1
#&gt; Item_15 0.778 -0.064 0 1
#&gt; 
#&gt; $means
#&gt; F1 
#&gt;  0 
#&gt; 
#&gt; $cov
#&gt;    F1
#&gt; F1  1
#&gt; 
#&gt; 
#&gt; $D2
#&gt; $items
#&gt;            a1      d g u
#&gt; Item_1  1.441  0.358 0 1
#&gt; Item_2  1.136 -0.590 0 1
#&gt; Item_3  0.996 -0.237 0 1
#&gt; Item_4  0.902  0.921 0 1
#&gt; Item_5  1.060  0.153 0 1
#&gt; Item_6  0.440  0.637 0 1
#&gt; Item_7  1.170  1.023 0 1
#&gt; Item_8  0.904 -0.353 0 1
#&gt; Item_9  0.875 -0.978 0 1
#&gt; Item_10 0.665 -1.120 0 1
#&gt; Item_11 0.939  1.243 0 1
#&gt; Item_12 1.336 -0.194 0 1
#&gt; Item_13 1.250  0.481 0 1
#&gt; Item_14 1.050  0.444 0 1
#&gt; Item_15 0.778 -0.064 0 1
#&gt; 
#&gt; $means
#&gt;    F1 
#&gt; -0.08 
#&gt; 
#&gt; $cov
#&gt;       F1
#&gt; F1 1.167
#&gt; 
#&gt; </div><div class='input'>
<span class='fu'>RMSD_DIF</span><span class='op'>(</span><span class='va'>pooled_mod</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $D1
#&gt;           P.0   P.1
#&gt; Item_1  0.033 0.033
#&gt; Item_2  0.018 0.018
#&gt; Item_3  0.012 0.012
#&gt; Item_4  0.017 0.017
#&gt; Item_5  0.012 0.012
#&gt; Item_6  0.021 0.021
#&gt; Item_7  0.007 0.007
#&gt; Item_8  0.020 0.020
#&gt; Item_9  0.025 0.025
#&gt; Item_10 0.024 0.024
#&gt; Item_11 0.014 0.014
#&gt; Item_12 0.009 0.009
#&gt; Item_13 0.017 0.017
#&gt; Item_14 0.007 0.007
#&gt; Item_15 0.015 0.015
#&gt; 
#&gt; $D2
#&gt;           P.0   P.1
#&gt; Item_1  0.028 0.028
#&gt; Item_2  0.024 0.024
#&gt; Item_3  0.010 0.010
#&gt; Item_4  0.015 0.015
#&gt; Item_5  0.007 0.007
#&gt; Item_6  0.050 0.050
#&gt; Item_7  0.009 0.009
#&gt; Item_8  0.019 0.019
#&gt; Item_9  0.019 0.019
#&gt; Item_10 0.021 0.021
#&gt; Item_11 0.012 0.012
#&gt; Item_12 0.011 0.011
#&gt; Item_13 0.008 0.008
#&gt; Item_14 0.003 0.003
#&gt; Item_15 0.012 0.012
#&gt; </div><div class='input'><span class='fu'>RMSD_DIF</span><span class='op'>(</span><span class='va'>pooled_mod</span>, dentype <span class='op'>=</span> <span class='st'>'empirical'</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $D1
#&gt;           P.0   P.1
#&gt; Item_1  0.056 0.056
#&gt; Item_2  0.018 0.018
#&gt; Item_3  0.014 0.014
#&gt; Item_4  0.019 0.019
#&gt; Item_5  0.010 0.010
#&gt; Item_6  0.021 0.021
#&gt; Item_7  0.016 0.016
#&gt; Item_8  0.017 0.017
#&gt; Item_9  0.019 0.019
#&gt; Item_10 0.018 0.018
#&gt; Item_11 0.013 0.013
#&gt; Item_12 0.014 0.014
#&gt; Item_13 0.018 0.018
#&gt; Item_14 0.009 0.009
#&gt; Item_15 0.011 0.011
#&gt; 
#&gt; $D2
#&gt;           P.0   P.1
#&gt; Item_1  0.052 0.052
#&gt; Item_2  0.021 0.021
#&gt; Item_3  0.013 0.013
#&gt; Item_4  0.016 0.016
#&gt; Item_5  0.009 0.009
#&gt; Item_6  0.022 0.022
#&gt; Item_7  0.017 0.017
#&gt; Item_8  0.016 0.016
#&gt; Item_9  0.017 0.017
#&gt; Item_10 0.014 0.014
#&gt; Item_11 0.021 0.021
#&gt; Item_12 0.013 0.013
#&gt; Item_13 0.011 0.011
#&gt; Item_14 0.004 0.004
#&gt; Item_15 0.014 0.014
#&gt; </div><div class='input'><span class='fu'>RMSD_DIF</span><span class='op'>(</span><span class='va'>pooled_mod</span>, flag <span class='op'>=</span> <span class='fl'>.03</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $D1
#&gt;           P.0   P.1
#&gt; Item_1  0.033 0.033
#&gt; Item_2     NA    NA
#&gt; Item_3     NA    NA
#&gt; Item_4     NA    NA
#&gt; Item_5     NA    NA
#&gt; Item_6     NA    NA
#&gt; Item_7     NA    NA
#&gt; Item_8     NA    NA
#&gt; Item_9     NA    NA
#&gt; Item_10    NA    NA
#&gt; Item_11    NA    NA
#&gt; Item_12    NA    NA
#&gt; Item_13    NA    NA
#&gt; Item_14    NA    NA
#&gt; Item_15    NA    NA
#&gt; 
#&gt; $D2
#&gt;          P.0  P.1
#&gt; Item_1    NA   NA
#&gt; Item_2    NA   NA
#&gt; Item_3    NA   NA
#&gt; Item_4    NA   NA
#&gt; Item_5    NA   NA
#&gt; Item_6  0.05 0.05
#&gt; Item_7    NA   NA
#&gt; Item_8    NA   NA
#&gt; Item_9    NA   NA
#&gt; Item_10   NA   NA
#&gt; Item_11   NA   NA
#&gt; Item_12   NA   NA
#&gt; Item_13   NA   NA
#&gt; Item_14   NA   NA
#&gt; Item_15   NA   NA
#&gt; </div><div class='input'>
<span class='co'># more freely estimated model (item 1 has 2 parameters estimated)</span>
<span class='va'>MGmod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='multipleGroup.html'>multipleGroup</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span>, group<span class='op'>=</span><span class='va'>group</span>,
                       invariance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, <span class='st'>'free_mean'</span>, <span class='st'>'free_var'</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>MGmod</span>, simplify<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $D1
#&gt; $items
#&gt;            a1      d g u
#&gt; Item_1  1.071  0.525 0 1
#&gt; Item_2  1.178 -0.615 0 1
#&gt; Item_3  1.031 -0.258 0 1
#&gt; Item_4  0.933  0.902 0 1
#&gt; Item_5  1.099  0.130 0 1
#&gt; Item_6  0.455  0.627 0 1
#&gt; Item_7  1.217  1.001 0 1
#&gt; Item_8  0.926 -0.372 0 1
#&gt; Item_9  0.905 -0.997 0 1
#&gt; Item_10 0.692 -1.136 0 1
#&gt; Item_11 0.967  1.222 0 1
#&gt; Item_12 1.373 -0.222 0 1
#&gt; Item_13 1.302  0.456 0 1
#&gt; Item_14 1.079  0.421 0 1
#&gt; Item_15 0.804 -0.080 0 1
#&gt; 
#&gt; $means
#&gt; F1 
#&gt;  0 
#&gt; 
#&gt; $cov
#&gt;    F1
#&gt; F1  1
#&gt; 
#&gt; 
#&gt; $D2
#&gt; $items
#&gt;            a1      d g u
#&gt; Item_1  2.100  0.083 0 1
#&gt; Item_2  1.178 -0.615 0 1
#&gt; Item_3  1.031 -0.258 0 1
#&gt; Item_4  0.933  0.902 0 1
#&gt; Item_5  1.099  0.130 0 1
#&gt; Item_6  0.455  0.627 0 1
#&gt; Item_7  1.217  1.001 0 1
#&gt; Item_8  0.926 -0.372 0 1
#&gt; Item_9  0.905 -0.997 0 1
#&gt; Item_10 0.692 -1.136 0 1
#&gt; Item_11 0.967  1.222 0 1
#&gt; Item_12 1.373 -0.222 0 1
#&gt; Item_13 1.302  0.456 0 1
#&gt; Item_14 1.079  0.421 0 1
#&gt; Item_15 0.804 -0.080 0 1
#&gt; 
#&gt; $means
#&gt;     F1 
#&gt; -0.036 
#&gt; 
#&gt; $cov
#&gt;       F1
#&gt; F1 1.033
#&gt; 
#&gt; </div><div class='input'>
<span class='co'># RMSD in item.1 now reduced (MG model accounts for DIF)</span>
<span class='fu'>RMSD_DIF</span><span class='op'>(</span><span class='va'>MGmod</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $D1
#&gt;           P.0   P.1
#&gt; Item_1  0.007 0.007
#&gt; Item_2  0.016 0.016
#&gt; Item_3  0.012 0.012
#&gt; Item_4  0.017 0.017
#&gt; Item_5  0.013 0.013
#&gt; Item_6  0.022 0.022
#&gt; Item_7  0.005 0.005
#&gt; Item_8  0.023 0.023
#&gt; Item_9  0.024 0.024
#&gt; Item_10 0.023 0.023
#&gt; Item_11 0.016 0.016
#&gt; Item_12 0.006 0.006
#&gt; Item_13 0.016 0.016
#&gt; Item_14 0.011 0.011
#&gt; Item_15 0.014 0.014
#&gt; 
#&gt; $D2
#&gt;           P.0   P.1
#&gt; Item_1  0.004 0.004
#&gt; Item_2  0.023 0.023
#&gt; Item_3  0.011 0.011
#&gt; Item_4  0.014 0.014
#&gt; Item_5  0.008 0.008
#&gt; Item_6  0.047 0.047
#&gt; Item_7  0.007 0.007
#&gt; Item_8  0.018 0.018
#&gt; Item_9  0.019 0.019
#&gt; Item_10 0.020 0.020
#&gt; Item_11 0.011 0.011
#&gt; Item_12 0.008 0.008
#&gt; Item_13 0.007 0.007
#&gt; Item_14 0.006 0.006
#&gt; Item_15 0.011 0.011
#&gt; </div><div class='input'><span class='fu'>RMSD_DIF</span><span class='op'>(</span><span class='va'>MGmod</span>, flag <span class='op'>=</span> <span class='fl'>.03</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $D1
#&gt;         P.0 P.1
#&gt; Item_1   NA  NA
#&gt; Item_2   NA  NA
#&gt; Item_3   NA  NA
#&gt; Item_4   NA  NA
#&gt; Item_5   NA  NA
#&gt; Item_6   NA  NA
#&gt; Item_7   NA  NA
#&gt; Item_8   NA  NA
#&gt; Item_9   NA  NA
#&gt; Item_10  NA  NA
#&gt; Item_11  NA  NA
#&gt; Item_12  NA  NA
#&gt; Item_13  NA  NA
#&gt; Item_14  NA  NA
#&gt; Item_15  NA  NA
#&gt; 
#&gt; $D2
#&gt;           P.0   P.1
#&gt; Item_1     NA    NA
#&gt; Item_2     NA    NA
#&gt; Item_3     NA    NA
#&gt; Item_4     NA    NA
#&gt; Item_5     NA    NA
#&gt; Item_6  0.047 0.047
#&gt; Item_7     NA    NA
#&gt; Item_8     NA    NA
#&gt; Item_9     NA    NA
#&gt; Item_10    NA    NA
#&gt; Item_11    NA    NA
#&gt; Item_12    NA    NA
#&gt; Item_13    NA    NA
#&gt; Item_14    NA    NA
#&gt; Item_15    NA    NA
#&gt; </div><div class='input'>

<span class='co'>#################</span>
<span class='co'># polytomous example</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span>
<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='va'>a2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Lognormal.html'>rlnorm</a></span><span class='op'>(</span><span class='fl'>20</span>,<span class='fl'>.2</span>,<span class='fl'>.3</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># for the graded model, ensure that there is enough space between the intercepts,</span>
<span class='co'># otherwise closer categories will not be selected often (minimum distance of 0.3 here)</span>
<span class='va'>diffs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>20</span><span class='op'>*</span><span class='fl'>4</span>, <span class='fl'>.3</span>, <span class='fl'>1</span><span class='op'>)</span>, <span class='fl'>20</span><span class='op'>)</span>, <span class='fl'>1</span>, <span class='va'>cumsum</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>diffs</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='op'>(</span><span class='va'>diffs</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowMeans</a></span><span class='op'>(</span><span class='va'>diffs</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='va'>d2</span> <span class='op'>&lt;-</span> <span class='va'>diffs</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>20</span><span class='op'>)</span>

<span class='co'># item 1 has slope + dif for first intercept parameter</span>
<span class='va'>d2</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>d</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>-</span> <span class='fl'>.5</span>
<span class='va'>a2</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>a</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>+</span> <span class='fl'>1</span>

<span class='va'>itemtype</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'graded'</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>a</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>1000</span>
<span class='va'>dataset1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='va'>N</span>, <span class='va'>itemtype</span><span class='op'>)</span>
<span class='va'>dataset2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a2</span>, <span class='va'>d2</span>, <span class='va'>N</span>, <span class='va'>itemtype</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>dataset1</span>, <span class='va'>dataset2</span><span class='op'>)</span>
<span class='va'>group</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'D1'</span>, <span class='va'>N</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'D2'</span>, <span class='va'>N</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#-----</span>

<span class='co'># fully pooled model</span>
<span class='va'>pooled_mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='multipleGroup.html'>multipleGroup</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span>, group<span class='op'>=</span><span class='va'>group</span>,
         invariance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span>, <span class='st'>'free_mean'</span>, <span class='st'>'free_var'</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>pooled_mod</span>, simplify<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $D1
#&gt; $items
#&gt;            a1     d1     d2     d3     d4
#&gt; Item_1  1.708  1.205  0.527 -0.453 -0.948
#&gt; Item_2  1.517 -0.518 -0.992 -1.653 -2.434
#&gt; Item_3  1.187  1.757  0.681  0.375 -0.638
#&gt; Item_4  1.167  2.719  1.868  1.539  0.808
#&gt; Item_5  1.410  0.485 -0.466 -0.867 -1.581
#&gt; Item_6  0.683 -0.984 -1.396 -1.940 -2.910
#&gt; Item_7  1.387  2.128  1.234  0.341 -0.386
#&gt; Item_8  0.985  2.332  1.994  1.374  0.440
#&gt; Item_9  1.043  1.597  0.850  0.024 -0.373
#&gt; Item_10 0.906 -0.284 -1.281 -1.573 -2.038
#&gt; Item_11 1.128  1.269  0.470 -0.460 -1.184
#&gt; Item_12 2.016  0.268 -0.318 -1.128 -1.716
#&gt; Item_13 1.356 -0.202 -0.835 -1.233 -2.016
#&gt; Item_14 1.261  3.169  2.581  1.916  1.334
#&gt; Item_15 0.928  2.307  1.956  1.151  0.268
#&gt; Item_16 1.479  2.080  1.345  0.682 -0.305
#&gt; Item_17 0.815  2.163  1.208  0.410 -0.557
#&gt; Item_18 1.113  0.333 -0.481 -1.357 -2.072
#&gt; Item_19 1.604  1.256  0.584  0.240 -0.145
#&gt; Item_20 1.333  1.876  1.439  0.858  0.241
#&gt; 
#&gt; $means
#&gt; F1 
#&gt;  0 
#&gt; 
#&gt; $cov
#&gt;    F1
#&gt; F1  1
#&gt; 
#&gt; 
#&gt; $D2
#&gt; $items
#&gt;            a1     d1     d2     d3     d4
#&gt; Item_1  1.708  1.205  0.527 -0.453 -0.948
#&gt; Item_2  1.517 -0.518 -0.992 -1.653 -2.434
#&gt; Item_3  1.187  1.757  0.681  0.375 -0.638
#&gt; Item_4  1.167  2.719  1.868  1.539  0.808
#&gt; Item_5  1.410  0.485 -0.466 -0.867 -1.581
#&gt; Item_6  0.683 -0.984 -1.396 -1.940 -2.910
#&gt; Item_7  1.387  2.128  1.234  0.341 -0.386
#&gt; Item_8  0.985  2.332  1.994  1.374  0.440
#&gt; Item_9  1.043  1.597  0.850  0.024 -0.373
#&gt; Item_10 0.906 -0.284 -1.281 -1.573 -2.038
#&gt; Item_11 1.128  1.269  0.470 -0.460 -1.184
#&gt; Item_12 2.016  0.268 -0.318 -1.128 -1.716
#&gt; Item_13 1.356 -0.202 -0.835 -1.233 -2.016
#&gt; Item_14 1.261  3.169  2.581  1.916  1.334
#&gt; Item_15 0.928  2.307  1.956  1.151  0.268
#&gt; Item_16 1.479  2.080  1.345  0.682 -0.305
#&gt; Item_17 0.815  2.163  1.208  0.410 -0.557
#&gt; Item_18 1.113  0.333 -0.481 -1.357 -2.072
#&gt; Item_19 1.604  1.256  0.584  0.240 -0.145
#&gt; Item_20 1.333  1.876  1.439  0.858  0.241
#&gt; 
#&gt; $means
#&gt;     F1 
#&gt; -0.022 
#&gt; 
#&gt; $cov
#&gt;       F1
#&gt; F1 1.182
#&gt; 
#&gt; </div><div class='input'>
<span class='co'># Item_1 fits poorly in several categories (RMSD &gt; .05)</span>
<span class='fu'>RMSD_DIF</span><span class='op'>(</span><span class='va'>pooled_mod</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $D1
#&gt;           P.1   P.2   P.3   P.4   P.5
#&gt; Item_1  0.045 0.044 0.017 0.026 0.052
#&gt; Item_2  0.019 0.005 0.019 0.012 0.018
#&gt; Item_3  0.014 0.023 0.012 0.017 0.032
#&gt; Item_4  0.014 0.005 0.007 0.007 0.016
#&gt; Item_5  0.028 0.019 0.007 0.032 0.035
#&gt; Item_6  0.013 0.025 0.026 0.037 0.041
#&gt; Item_7  0.012 0.011 0.024 0.020 0.022
#&gt; Item_8  0.011 0.005 0.013 0.036 0.024
#&gt; Item_9  0.013 0.014 0.011 0.019 0.025
#&gt; Item_10 0.032 0.013 0.020 0.028 0.074
#&gt; Item_11 0.010 0.015 0.019 0.020 0.020
#&gt; Item_12 0.011 0.010 0.027 0.019 0.018
#&gt; Item_13 0.020 0.011 0.013 0.030 0.021
#&gt; Item_14 0.005 0.004 0.004 0.015 0.018
#&gt; Item_15 0.009 0.008 0.017 0.012 0.022
#&gt; Item_16 0.007 0.018 0.013 0.024 0.015
#&gt; Item_17 0.014 0.014 0.023 0.028 0.053
#&gt; Item_18 0.016 0.019 0.025 0.023 0.043
#&gt; Item_19 0.022 0.017 0.014 0.011 0.016
#&gt; Item_20 0.017 0.006 0.009 0.009 0.014
#&gt; 
#&gt; $D2
#&gt;           P.1   P.2   P.3   P.4   P.5
#&gt; Item_1  0.051 0.038 0.031 0.021 0.050
#&gt; Item_2  0.006 0.017 0.006 0.015 0.014
#&gt; Item_3  0.011 0.015 0.007 0.020 0.017
#&gt; Item_4  0.010 0.014 0.007 0.007 0.015
#&gt; Item_5  0.012 0.017 0.014 0.009 0.015
#&gt; Item_6  0.056 0.019 0.011 0.024 0.038
#&gt; Item_7  0.007 0.009 0.011 0.020 0.017
#&gt; Item_8  0.012 0.013 0.015 0.016 0.027
#&gt; Item_9  0.021 0.009 0.010 0.012 0.028
#&gt; Item_10 0.029 0.015 0.018 0.032 0.033
#&gt; Item_11 0.015 0.014 0.015 0.015 0.024
#&gt; Item_12 0.010 0.007 0.020 0.009 0.016
#&gt; Item_13 0.010 0.015 0.015 0.021 0.029
#&gt; Item_14 0.011 0.007 0.012 0.009 0.012
#&gt; Item_15 0.011 0.006 0.012 0.016 0.020
#&gt; Item_16 0.009 0.009 0.011 0.014 0.017
#&gt; Item_17 0.015 0.012 0.018 0.046 0.040
#&gt; Item_18 0.017 0.032 0.042 0.017 0.068
#&gt; Item_19 0.019 0.011 0.013 0.009 0.023
#&gt; Item_20 0.011 0.005 0.015 0.007 0.015
#&gt; </div><div class='input'><span class='fu'>RMSD_DIF</span><span class='op'>(</span><span class='va'>pooled_mod</span>, flag <span class='op'>=</span> <span class='fl'>.05</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $D1
#&gt;         P.1 P.2 P.3 P.4   P.5
#&gt; Item_1   NA  NA  NA  NA 0.052
#&gt; Item_2   NA  NA  NA  NA    NA
#&gt; Item_3   NA  NA  NA  NA    NA
#&gt; Item_4   NA  NA  NA  NA    NA
#&gt; Item_5   NA  NA  NA  NA    NA
#&gt; Item_6   NA  NA  NA  NA    NA
#&gt; Item_7   NA  NA  NA  NA    NA
#&gt; Item_8   NA  NA  NA  NA    NA
#&gt; Item_9   NA  NA  NA  NA    NA
#&gt; Item_10  NA  NA  NA  NA 0.074
#&gt; Item_11  NA  NA  NA  NA    NA
#&gt; Item_12  NA  NA  NA  NA    NA
#&gt; Item_13  NA  NA  NA  NA    NA
#&gt; Item_14  NA  NA  NA  NA    NA
#&gt; Item_15  NA  NA  NA  NA    NA
#&gt; Item_16  NA  NA  NA  NA    NA
#&gt; Item_17  NA  NA  NA  NA 0.053
#&gt; Item_18  NA  NA  NA  NA    NA
#&gt; Item_19  NA  NA  NA  NA    NA
#&gt; Item_20  NA  NA  NA  NA    NA
#&gt; 
#&gt; $D2
#&gt;           P.1 P.2 P.3 P.4   P.5
#&gt; Item_1  0.051  NA  NA  NA 0.050
#&gt; Item_2     NA  NA  NA  NA    NA
#&gt; Item_3     NA  NA  NA  NA    NA
#&gt; Item_4     NA  NA  NA  NA    NA
#&gt; Item_5     NA  NA  NA  NA    NA
#&gt; Item_6  0.056  NA  NA  NA    NA
#&gt; Item_7     NA  NA  NA  NA    NA
#&gt; Item_8     NA  NA  NA  NA    NA
#&gt; Item_9     NA  NA  NA  NA    NA
#&gt; Item_10    NA  NA  NA  NA    NA
#&gt; Item_11    NA  NA  NA  NA    NA
#&gt; Item_12    NA  NA  NA  NA    NA
#&gt; Item_13    NA  NA  NA  NA    NA
#&gt; Item_14    NA  NA  NA  NA    NA
#&gt; Item_15    NA  NA  NA  NA    NA
#&gt; Item_16    NA  NA  NA  NA    NA
#&gt; Item_17    NA  NA  NA  NA    NA
#&gt; Item_18    NA  NA  NA  NA 0.068
#&gt; Item_19    NA  NA  NA  NA    NA
#&gt; Item_20    NA  NA  NA  NA    NA
#&gt; </div><div class='input'><span class='fu'>RMSD_DIF</span><span class='op'>(</span><span class='va'>pooled_mod</span>, flag <span class='op'>=</span> <span class='fl'>.1</span>, probfun <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='co'># use expected score function</span>
</div><div class='output co'>#&gt; $D1
#&gt;         S(theta)
#&gt; Item_1     0.136
#&gt; Item_2        NA
#&gt; Item_3        NA
#&gt; Item_4        NA
#&gt; Item_5        NA
#&gt; Item_6        NA
#&gt; Item_7        NA
#&gt; Item_8        NA
#&gt; Item_9        NA
#&gt; Item_10    0.181
#&gt; Item_11       NA
#&gt; Item_12       NA
#&gt; Item_13       NA
#&gt; Item_14       NA
#&gt; Item_15       NA
#&gt; Item_16       NA
#&gt; Item_17    0.105
#&gt; Item_18       NA
#&gt; Item_19       NA
#&gt; Item_20       NA
#&gt; 
#&gt; $D2
#&gt;         S(theta)
#&gt; Item_1     0.132
#&gt; Item_2        NA
#&gt; Item_3        NA
#&gt; Item_4        NA
#&gt; Item_5        NA
#&gt; Item_6     0.179
#&gt; Item_7        NA
#&gt; Item_8        NA
#&gt; Item_9        NA
#&gt; Item_10       NA
#&gt; Item_11       NA
#&gt; Item_12       NA
#&gt; Item_13       NA
#&gt; Item_14       NA
#&gt; Item_15       NA
#&gt; Item_16       NA
#&gt; Item_17       NA
#&gt; Item_18    0.178
#&gt; Item_19       NA
#&gt; Item_20       NA
#&gt; </div><div class='input'>
<span class='co'># more freely estimated model (item 1 has more parameters estimated)</span>
<span class='va'>MGmod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='multipleGroup.html'>multipleGroup</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span>, group<span class='op'>=</span><span class='va'>group</span>,
                       invariance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, <span class='st'>'free_mean'</span>, <span class='st'>'free_var'</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>MGmod</span>, simplify<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $D1
#&gt; $items
#&gt;            a1     d1     d2     d3     d4
#&gt; Item_1  1.293  1.471  0.527 -0.408 -0.925
#&gt; Item_2  1.553 -0.527 -1.000 -1.659 -2.439
#&gt; Item_3  1.226  1.753  0.675  0.368 -0.648
#&gt; Item_4  1.201  2.716  1.864  1.534  0.802
#&gt; Item_5  1.447  0.476 -0.475 -0.876 -1.590
#&gt; Item_6  0.702 -0.989 -1.400 -1.944 -2.915
#&gt; Item_7  1.426  2.122  1.227  0.333 -0.395
#&gt; Item_8  1.009  2.325  1.987  1.368  0.433
#&gt; Item_9  1.076  1.593  0.846  0.017 -0.380
#&gt; Item_10 0.936 -0.290 -1.289 -1.581 -2.047
#&gt; Item_11 1.157  1.261  0.463 -0.468 -1.191
#&gt; Item_12 2.070  0.255 -0.331 -1.141 -1.728
#&gt; Item_13 1.392 -0.211 -0.844 -1.242 -2.025
#&gt; Item_14 1.290  3.158  2.571  1.905  1.324
#&gt; Item_15 0.952  2.301  1.951  1.145  0.262
#&gt; Item_16 1.516  2.070  1.334  0.671 -0.315
#&gt; Item_17 0.835  2.158  1.202  0.405 -0.562
#&gt; Item_18 1.141  0.326 -0.487 -1.363 -2.078
#&gt; Item_19 1.643  1.245  0.573  0.230 -0.155
#&gt; Item_20 1.371  1.869  1.432  0.851  0.234
#&gt; 
#&gt; $means
#&gt; F1 
#&gt;  0 
#&gt; 
#&gt; $cov
#&gt;    F1
#&gt; F1  1
#&gt; 
#&gt; 
#&gt; $D2
#&gt; $items
#&gt;            a1     d1     d2     d3     d4
#&gt; Item_1  2.523  0.906  0.519 -0.587 -1.079
#&gt; Item_2  1.553 -0.527 -1.000 -1.659 -2.439
#&gt; Item_3  1.226  1.753  0.675  0.368 -0.648
#&gt; Item_4  1.201  2.716  1.864  1.534  0.802
#&gt; Item_5  1.447  0.476 -0.475 -0.876 -1.590
#&gt; Item_6  0.702 -0.989 -1.400 -1.944 -2.915
#&gt; Item_7  1.426  2.122  1.227  0.333 -0.395
#&gt; Item_8  1.009  2.325  1.987  1.368  0.433
#&gt; Item_9  1.076  1.593  0.846  0.017 -0.380
#&gt; Item_10 0.936 -0.290 -1.289 -1.581 -2.047
#&gt; Item_11 1.157  1.261  0.463 -0.468 -1.191
#&gt; Item_12 2.070  0.255 -0.331 -1.141 -1.728
#&gt; Item_13 1.392 -0.211 -0.844 -1.242 -2.025
#&gt; Item_14 1.290  3.158  2.571  1.905  1.324
#&gt; Item_15 0.952  2.301  1.951  1.145  0.262
#&gt; Item_16 1.516  2.070  1.334  0.671 -0.315
#&gt; Item_17 0.835  2.158  1.202  0.405 -0.562
#&gt; Item_18 1.141  0.326 -0.487 -1.363 -2.078
#&gt; Item_19 1.643  1.245  0.573  0.230 -0.155
#&gt; Item_20 1.371  1.869  1.432  0.851  0.234
#&gt; 
#&gt; $means
#&gt;     F1 
#&gt; -0.009 
#&gt; 
#&gt; $cov
#&gt;       F1
#&gt; F1 1.071
#&gt; 
#&gt; </div><div class='input'>
<span class='co'># RMSDs in Item_1 now reduced (MG model better accounts for DIF)</span>
<span class='fu'>RMSD_DIF</span><span class='op'>(</span><span class='va'>MGmod</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $D1
#&gt;           P.1   P.2   P.3   P.4   P.5
#&gt; Item_1  0.006 0.016 0.014 0.017 0.009
#&gt; Item_2  0.022 0.006 0.018 0.012 0.021
#&gt; Item_3  0.013 0.022 0.012 0.016 0.028
#&gt; Item_4  0.013 0.005 0.007 0.008 0.014
#&gt; Item_5  0.026 0.020 0.008 0.033 0.039
#&gt; Item_6  0.011 0.027 0.026 0.038 0.037
#&gt; Item_7  0.012 0.011 0.025 0.019 0.023
#&gt; Item_8  0.011 0.005 0.013 0.037 0.025
#&gt; Item_9  0.012 0.014 0.011 0.019 0.022
#&gt; Item_10 0.030 0.014 0.020 0.027 0.070
#&gt; Item_11 0.011 0.015 0.018 0.021 0.019
#&gt; Item_12 0.009 0.010 0.029 0.017 0.021
#&gt; Item_13 0.016 0.010 0.014 0.030 0.024
#&gt; Item_14 0.006 0.004 0.004 0.016 0.020
#&gt; Item_15 0.009 0.008 0.017 0.013 0.022
#&gt; Item_16 0.006 0.017 0.013 0.026 0.018
#&gt; Item_17 0.014 0.015 0.021 0.028 0.050
#&gt; Item_18 0.016 0.019 0.023 0.023 0.036
#&gt; Item_19 0.023 0.017 0.014 0.011 0.017
#&gt; Item_20 0.016 0.006 0.009 0.008 0.013
#&gt; 
#&gt; $D2
#&gt;           P.1   P.2   P.3   P.4   P.5
#&gt; Item_1  0.021 0.003 0.015 0.007 0.009
#&gt; Item_2  0.007 0.018 0.007 0.013 0.020
#&gt; Item_3  0.012 0.016 0.007 0.021 0.017
#&gt; Item_4  0.010 0.014 0.007 0.008 0.014
#&gt; Item_5  0.015 0.016 0.014 0.010 0.017
#&gt; Item_6  0.052 0.018 0.011 0.023 0.035
#&gt; Item_7  0.008 0.008 0.013 0.019 0.014
#&gt; Item_8  0.011 0.013 0.016 0.017 0.026
#&gt; Item_9  0.020 0.008 0.010 0.013 0.026
#&gt; Item_10 0.027 0.015 0.018 0.030 0.032
#&gt; Item_11 0.015 0.014 0.014 0.014 0.021
#&gt; Item_12 0.009 0.007 0.021 0.009 0.020
#&gt; Item_13 0.009 0.014 0.014 0.020 0.025
#&gt; Item_14 0.012 0.007 0.012 0.010 0.011
#&gt; Item_15 0.011 0.006 0.012 0.017 0.022
#&gt; Item_16 0.010 0.010 0.011 0.014 0.020
#&gt; Item_17 0.016 0.012 0.019 0.042 0.036
#&gt; Item_18 0.020 0.029 0.040 0.019 0.060
#&gt; Item_19 0.018 0.011 0.014 0.008 0.023
#&gt; Item_20 0.009 0.006 0.015 0.007 0.013
#&gt; </div><div class='input'><span class='fu'>RMSD_DIF</span><span class='op'>(</span><span class='va'>MGmod</span>, flag <span class='op'>=</span> <span class='fl'>.05</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $D1
#&gt;         P.1 P.2 P.3 P.4  P.5
#&gt; Item_1   NA  NA  NA  NA   NA
#&gt; Item_2   NA  NA  NA  NA   NA
#&gt; Item_3   NA  NA  NA  NA   NA
#&gt; Item_4   NA  NA  NA  NA   NA
#&gt; Item_5   NA  NA  NA  NA   NA
#&gt; Item_6   NA  NA  NA  NA   NA
#&gt; Item_7   NA  NA  NA  NA   NA
#&gt; Item_8   NA  NA  NA  NA   NA
#&gt; Item_9   NA  NA  NA  NA   NA
#&gt; Item_10  NA  NA  NA  NA 0.07
#&gt; Item_11  NA  NA  NA  NA   NA
#&gt; Item_12  NA  NA  NA  NA   NA
#&gt; Item_13  NA  NA  NA  NA   NA
#&gt; Item_14  NA  NA  NA  NA   NA
#&gt; Item_15  NA  NA  NA  NA   NA
#&gt; Item_16  NA  NA  NA  NA   NA
#&gt; Item_17  NA  NA  NA  NA 0.05
#&gt; Item_18  NA  NA  NA  NA   NA
#&gt; Item_19  NA  NA  NA  NA   NA
#&gt; Item_20  NA  NA  NA  NA   NA
#&gt; 
#&gt; $D2
#&gt;           P.1 P.2 P.3 P.4  P.5
#&gt; Item_1     NA  NA  NA  NA   NA
#&gt; Item_2     NA  NA  NA  NA   NA
#&gt; Item_3     NA  NA  NA  NA   NA
#&gt; Item_4     NA  NA  NA  NA   NA
#&gt; Item_5     NA  NA  NA  NA   NA
#&gt; Item_6  0.052  NA  NA  NA   NA
#&gt; Item_7     NA  NA  NA  NA   NA
#&gt; Item_8     NA  NA  NA  NA   NA
#&gt; Item_9     NA  NA  NA  NA   NA
#&gt; Item_10    NA  NA  NA  NA   NA
#&gt; Item_11    NA  NA  NA  NA   NA
#&gt; Item_12    NA  NA  NA  NA   NA
#&gt; Item_13    NA  NA  NA  NA   NA
#&gt; Item_14    NA  NA  NA  NA   NA
#&gt; Item_15    NA  NA  NA  NA   NA
#&gt; Item_16    NA  NA  NA  NA   NA
#&gt; Item_17    NA  NA  NA  NA   NA
#&gt; Item_18    NA  NA  NA  NA 0.06
#&gt; Item_19    NA  NA  NA  NA   NA
#&gt; Item_20    NA  NA  NA  NA   NA
#&gt; </div><div class='input'><span class='fu'>RMSD_DIF</span><span class='op'>(</span><span class='va'>MGmod</span>, probfun <span class='op'>=</span> <span class='cn'>FALSE</span>, flag <span class='op'>=</span> <span class='fl'>.1</span><span class='op'>)</span> <span class='co'># use expected score function</span>
</div><div class='output co'>#&gt; $D1
#&gt;         S(theta)
#&gt; Item_1        NA
#&gt; Item_2        NA
#&gt; Item_3        NA
#&gt; Item_4        NA
#&gt; Item_5        NA
#&gt; Item_6        NA
#&gt; Item_7        NA
#&gt; Item_8        NA
#&gt; Item_9        NA
#&gt; Item_10    0.168
#&gt; Item_11       NA
#&gt; Item_12       NA
#&gt; Item_13       NA
#&gt; Item_14       NA
#&gt; Item_15       NA
#&gt; Item_16       NA
#&gt; Item_17       NA
#&gt; Item_18       NA
#&gt; Item_19       NA
#&gt; Item_20       NA
#&gt; 
#&gt; $D2
#&gt;         S(theta)
#&gt; Item_1        NA
#&gt; Item_2        NA
#&gt; Item_3        NA
#&gt; Item_4        NA
#&gt; Item_5        NA
#&gt; Item_6     0.164
#&gt; Item_7        NA
#&gt; Item_8        NA
#&gt; Item_9        NA
#&gt; Item_10       NA
#&gt; Item_11       NA
#&gt; Item_12       NA
#&gt; Item_13       NA
#&gt; Item_14       NA
#&gt; Item_15       NA
#&gt; Item_16       NA
#&gt; Item_17       NA
#&gt; Item_18    0.159
#&gt; Item_19       NA
#&gt; Item_20       NA
#&gt; </div><div class='input'>
<span class='co'># }</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


