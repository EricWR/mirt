<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Differential Response Functioning statistics — DRF • mirt</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Differential Response Functioning statistics — DRF" />
<meta property="og:description" content="Function performs various omnibus differential item (DIF), bundle (DBF), and test (DTF)
functioning procedures on an object
estimated with multipleGroup(). The compensatory and non-compensatory statistics provided
are described in Chalmers (2018), which generally can be interpreted as IRT generalizations
of the SIBTEST and CSIBTEST statistics. These require the ACOV matrix to be computed in the
fitted multiple-group model (otherwise, sets of plausible draws from the posterior are explicitly
required)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mirt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.32.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mirt-vignettes.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/philchalmers/mirt/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Differential Response Functioning statistics</h1>
    <small class="dont-index">Source: <a href='https://github.com/philchalmers/mirt/blob/master/R/DRF.R'><code>R/DRF.R</code></a></small>
    <div class="hidden name"><code>DRF.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function performs various omnibus differential item (DIF), bundle (DBF), and test (DTF)
functioning procedures on an object
estimated with <code><a href='multipleGroup.html'>multipleGroup()</a></code>. The compensatory and non-compensatory statistics provided
are described in Chalmers (2018), which generally can be interpreted as IRT generalizations
of the SIBTEST and CSIBTEST statistics. These require the ACOV matrix to be computed in the
fitted multiple-group model (otherwise, sets of plausible draws from the posterior are explicitly
required).</p>
    </div>

    <pre class="usage"><span class='fu'>DRF</span><span class='op'>(</span>
  <span class='va'>mod</span>,
  draws <span class='op'>=</span> <span class='cn'>NULL</span>,
  focal_items <span class='op'>=</span> <span class='fl'>1L</span><span class='op'>:</span><span class='fu'><a href='extract.mirt.html'>extract.mirt</a></span><span class='op'>(</span><span class='va'>mod</span>, <span class='st'>"nitems"</span><span class='op'>)</span>,
  param_set <span class='op'>=</span> <span class='cn'>NULL</span>,
  CI <span class='op'>=</span> <span class='fl'>0.95</span>,
  npts <span class='op'>=</span> <span class='fl'>1000</span>,
  quadpts <span class='op'>=</span> <span class='cn'>NULL</span>,
  theta_lim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>6</span>, <span class='fl'>6</span><span class='op'>)</span>,
  Theta_nodes <span class='op'>=</span> <span class='cn'>NULL</span>,
  plot <span class='op'>=</span> <span class='cn'>FALSE</span>,
  DIF <span class='op'>=</span> <span class='cn'>FALSE</span>,
  p.adjust <span class='op'>=</span> <span class='st'>"none"</span>,
  par.strip.text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>cex <span class='op'>=</span> <span class='fl'>0.7</span><span class='op'>)</span>,
  par.settings <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>strip.background <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"#9ECAE1"</span><span class='op'>)</span>, strip.border <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>col
    <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span><span class='op'>)</span>,
  auto.key <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>space <span class='op'>=</span> <span class='st'>"right"</span>, points <span class='op'>=</span> <span class='cn'>FALSE</span>, lines <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mod</th>
      <td><p>a multipleGroup object which estimated only 2 groups</p></td>
    </tr>
    <tr>
      <th>draws</th>
      <td><p>a number indicating how many draws to take to form a suitable multiple imputation
or bootstrap estimate of the expected test scores (100 or more). If <code>boot = FALSE</code>,
requires an estimated parameter information matrix. Returns a list containing the
bootstrap/imputation distribution and null hypothesis test for the sDRF statistics</p></td>
    </tr>
    <tr>
      <th>focal_items</th>
      <td><p>a numeric vector indicating which items to include in the DRF tests. The
default uses all of the items (note that including anchors in the focal items has no effect
because they are exactly equal across groups). Selecting fewer items will result in tests of
'differential bundle functioning'</p></td>
    </tr>
    <tr>
      <th>param_set</th>
      <td><p>an N x p matrix of parameter values drawn from the posterior (e.g., using the
parametric sampling approach, bootstrap, of MCMC). If supplied, then these will be used to compute
the DRF measures. Can be much more efficient to pre-compute these values if DIF, DBF, or DTF are
being evaluated within the same model (especially when using the bootstrap method).
See <code><a href='draw_parameters.html'>draw_parameters</a></code></p></td>
    </tr>
    <tr>
      <th>CI</th>
      <td><p>range of confidence interval when using draws input</p></td>
    </tr>
    <tr>
      <th>npts</th>
      <td><p>number of points to use for plotting. Default is 1000</p></td>
    </tr>
    <tr>
      <th>quadpts</th>
      <td><p>number of quadrature nodes to use when constructing DRF statistics. Default is extracted from
the input model object</p></td>
    </tr>
    <tr>
      <th>theta_lim</th>
      <td><p>lower and upper limits of the latent trait (theta) to be evaluated, and is
used in conjunction with <code>quadpts</code> and <code>npts</code></p></td>
    </tr>
    <tr>
      <th>Theta_nodes</th>
      <td><p>an optional matrix of Theta values to be evaluated in the draws for the
sDRF statistics. However, these values are not averaged across, and instead give the bootstrap
confidence intervals at the respective Theta nodes. Useful when following up a large
sDRF or uDRF statistic, for example, to determine where the difference between the test curves are large
(while still accounting for sampling variability). Returns a matrix with observed
variability</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>logical; plot the 'sDRF' functions for the evaluated sDBF or sDTF values across the
integration grid or, if <code>DIF = TRUE</code>, the selected items as a faceted plot of individual items?
If plausible parameter sets were obtained/supplied then imputed confidence intervals will be included</p></td>
    </tr>
    <tr>
      <th>DIF</th>
      <td><p>logical; return a list of item-level imputation properties using the DRF statistics?
These can generally be used as a DIF detection method and as a graphical display for
understanding DIF within each item</p></td>
    </tr>
    <tr>
      <th>p.adjust</th>
      <td><p>string to be passed to the <code><a href='https://rdrr.io/r/stats/p.adjust.html'>p.adjust</a></code> function to adjust p-values.
Adjustments are located in the <code>adj_pvals</code> element in the returned list. Only applicable when
<code>DIF = TRUE</code></p></td>
    </tr>
    <tr>
      <th>par.strip.text</th>
      <td><p>plotting argument passed to <code>lattice</code></p></td>
    </tr>
    <tr>
      <th>par.settings</th>
      <td><p>plotting argument passed to <code>lattice</code></p></td>
    </tr>
    <tr>
      <th>auto.key</th>
      <td><p>plotting argument passed to <code>lattice</code></p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments to be passed to <code>lattice</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Chalmers, R. P. (2018). Model-Based Measures for Detecting and Quantifying Response Bias.
  <em>Psychometrika, 83</em>(3), 696-732. doi: <a href='https://doi.org/10.1007/s11336-018-9626-9'>10.1007/s11336-018-9626-9</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='multipleGroup.html'>multipleGroup</a></code>, <code><a href='DIF.html'>DIF</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Phil Chalmers <a href='mailto:rphilip.chalmers@gmail.com'>rphilip.chalmers@gmail.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span>
<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>30</span>
<span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>500</span>

<span class='co'># only first 5 items as anchors</span>
<span class='va'>model</span> <span class='op'>&lt;-</span> <span class='st'>'F = 1-30
          CONSTRAINB = (1-5, a1), (1-5, d)'</span>

<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='va'>n</span><span class='op'>)</span>
<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>, <span class='va'>n</span><span class='op'>)</span>
<span class='va'>group</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'Group_1'</span>, <span class='va'>N</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'Group_2'</span>, <span class='va'>N</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## -------------</span>
<span class='co'># groups completely equal</span>
<span class='va'>dat1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='va'>N</span>, itemtype <span class='op'>=</span> <span class='st'>'dich'</span><span class='op'>)</span>
<span class='va'>dat2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='va'>N</span>, itemtype <span class='op'>=</span> <span class='st'>'dich'</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>dat1</span>, <span class='va'>dat2</span><span class='op'>)</span>
<span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='multipleGroup.html'>multipleGroup</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>model</span>, group<span class='op'>=</span><span class='va'>group</span>, SE<span class='op'>=</span><span class='cn'>TRUE</span>,
                     invariance<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'free_means'</span>, <span class='st'>'free_var'</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>mod</span><span class='op'>)</span>
</div><div class='img'><img src='DRF-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>mod</span>, which.items <span class='op'>=</span> <span class='fl'>6</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span> <span class='co'>#DBF</span>
</div><div class='img'><img src='DRF-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>mod</span>, type <span class='op'>=</span> <span class='st'>'itemscore'</span><span class='op'>)</span>
</div><div class='img'><img src='DRF-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>mod</span>, type <span class='op'>=</span> <span class='st'>'itemscore'</span>, which.items <span class='op'>=</span> <span class='fl'>10</span><span class='op'>:</span><span class='fl'>15</span><span class='op'>)</span>
</div><div class='img'><img src='DRF-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   n_focal_items      sDRF      uDRF
#&gt; 1            30 0.3259068 0.3259072</div><div class='input'><span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, focal_items <span class='op'>=</span> <span class='fl'>6</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span> <span class='co'>#DBF</span>
</div><div class='output co'>#&gt;   n_focal_items       sDRF       uDRF
#&gt; 1             5 0.06949048 0.07136551</div><div class='input'><span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, DIF<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt;             sDIF        uDIF
#&gt; 1   0.000000e+00 0.000000000
#&gt; 2   0.000000e+00 0.000000000
#&gt; 3   0.000000e+00 0.000000000
#&gt; 4   0.000000e+00 0.000000000
#&gt; 5   0.000000e+00 0.000000000
#&gt; 6   6.438132e-05 0.015749408
#&gt; 7   2.610643e-02 0.026159781
#&gt; 8   7.678371e-03 0.007678372
#&gt; 9   2.583815e-02 0.026275361
#&gt; 10  9.803141e-03 0.035753335
#&gt; 11  5.558443e-02 0.058810878
#&gt; 12  1.599366e-02 0.016005343
#&gt; 13  1.485693e-02 0.022427623
#&gt; 14  3.337543e-02 0.046160533
#&gt; 15  4.546167e-02 0.045463284
#&gt; 16  3.046381e-02 0.030463813
#&gt; 17 -1.767682e-02 0.019055697
#&gt; 18 -1.086906e-02 0.012956165
#&gt; 19  4.512152e-02 0.093761482
#&gt; 20  7.803226e-03 0.009532902
#&gt; 21  6.958597e-02 0.069601295
#&gt; 22 -1.738086e-02 0.019757391
#&gt; 23 -3.606043e-02 0.063774220
#&gt; 24 -4.004255e-02 0.040082054
#&gt; 25 -2.106582e-03 0.018483788
#&gt; 26  1.872518e-02 0.047067547
#&gt; 27  4.883397e-02 0.048833972
#&gt; 28 -2.656416e-02 0.028764762
#&gt; 29 -7.358206e-03 0.025327769
#&gt; 30  2.866925e-02 0.030823229</div><div class='input'><span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, DIF<span class='op'>=</span><span class='cn'>TRUE</span>, focal_items <span class='op'>=</span> <span class='fl'>10</span><span class='op'>:</span><span class='fl'>15</span><span class='op'>)</span>
</div><div class='output co'>#&gt;           sDIF       uDIF
#&gt; 10 0.009803141 0.03575334
#&gt; 11 0.055584431 0.05881088
#&gt; 12 0.015993661 0.01600534
#&gt; 13 0.014856926 0.02242762
#&gt; 14 0.033375426 0.04616053
#&gt; 15 0.045461673 0.04546328</div><div class='input'>
<span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, plot <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='DRF-5.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, focal_items <span class='op'>=</span> <span class='fl'>6</span><span class='op'>:</span><span class='fl'>10</span>, plot <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='co'>#DBF</span>
</div><div class='img'><img src='DRF-6.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, DIF<span class='op'>=</span><span class='cn'>TRUE</span>, plot <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='DRF-7.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, DIF<span class='op'>=</span><span class='cn'>TRUE</span>, focal_items <span class='op'>=</span> <span class='fl'>10</span><span class='op'>:</span><span class='fl'>15</span>, plot <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='DRF-8.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='mirtCluster.html'>mirtCluster</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>mirtCluster() has already been defined</span></div><div class='input'><span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, draws <span class='op'>=</span> <span class='fl'>500</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      n_focal_items      stat      CI_2.5   CI_97.5        X2 df         p
#&gt; sDRF            30 0.3259068 -0.30899180 0.9688795 0.9623051  1 0.3266068
#&gt; uDRF            30 0.3259072  0.08150238 0.9916118 0.9623647  2 0.6180522</div><div class='input'><span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, draws <span class='op'>=</span> <span class='fl'>500</span>, plot<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='DRF-9.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># pre-draw parameter set to save computations</span>
<span class='va'>param_set</span> <span class='op'>&lt;-</span> <span class='fu'><a href='draw_parameters.html'>draw_parameters</a></span><span class='op'>(</span><span class='va'>mod</span>, draws <span class='op'>=</span> <span class='fl'>500</span><span class='op'>)</span>
<span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, focal_items <span class='op'>=</span> <span class='fl'>6</span>, param_set<span class='op'>=</span><span class='va'>param_set</span><span class='op'>)</span> <span class='co'>#DIF</span>
</div><div class='output co'>#&gt;      n_focal_items         stat       CI_2.5    CI_97.5           X2 df
#&gt; sDRF             1 6.438132e-05 -0.058453572 0.06313558 4.322731e-06  1
#&gt; uDRF             1 1.574941e-02  0.005530459 0.08165227 2.964557e-01  2
#&gt;              p
#&gt; sDRF 0.9983411
#&gt; uDRF 0.8622346</div><div class='input'><span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, DIF<span class='op'>=</span><span class='cn'>TRUE</span>, param_set<span class='op'>=</span><span class='va'>param_set</span><span class='op'>)</span> <span class='co'>#DIF</span>
</div><div class='output co'>#&gt; $sDIF
#&gt;             sDIF       CI_2.5    CI_97.5           X2 df          p
#&gt; 1   0.000000e+00  0.000000000 0.00000000           NA NA         NA
#&gt; 2   0.000000e+00  0.000000000 0.00000000           NA NA         NA
#&gt; 3   0.000000e+00  0.000000000 0.00000000           NA NA         NA
#&gt; 4   0.000000e+00  0.000000000 0.00000000           NA NA         NA
#&gt; 5   0.000000e+00  0.000000000 0.00000000           NA NA         NA
#&gt; 6   6.438132e-05 -0.058453572 0.06313558 4.322731e-06  1 0.99834111
#&gt; 7   2.610643e-02 -0.038579504 0.08411752 6.985720e-01  1 0.40326395
#&gt; 8   7.678371e-03 -0.054227671 0.06797779 5.925556e-02  1 0.80767645
#&gt; 9   2.583815e-02 -0.041168943 0.08931998 6.242390e-01  1 0.42947641
#&gt; 10  9.803141e-03 -0.050514524 0.06196940 1.099324e-01  1 0.74022109
#&gt; 11  5.558443e-02 -0.006735119 0.12094141 2.784714e+00  1 0.09516767
#&gt; 12  1.599366e-02 -0.047022781 0.07509292 2.765161e-01  1 0.59899384
#&gt; 13  1.485693e-02 -0.040069963 0.06968603 2.844329e-01  1 0.59381032
#&gt; 14  3.337543e-02 -0.025588186 0.09358734 1.158378e+00  1 0.28180228
#&gt; 15  4.546167e-02 -0.020091223 0.10557304 2.125874e+00  1 0.14483018
#&gt; 16  3.046381e-02 -0.034165635 0.09583173 8.527729e-01  1 0.35576908
#&gt; 17 -1.767682e-02 -0.074082180 0.03720417 3.802018e-01  1 0.53749527
#&gt; 18 -1.086906e-02 -0.071717057 0.04865136 1.307235e-01  1 0.71768306
#&gt; 19  4.512152e-02 -0.021421752 0.10561520 1.995953e+00  1 0.15771986
#&gt; 20  7.803226e-03 -0.034314416 0.04627994 1.518706e-01  1 0.69675412
#&gt; 21  6.958597e-02  0.013356150 0.12935851 5.251379e+00  1 0.02192938
#&gt; 22 -1.738086e-02 -0.071252138 0.04589003 3.287646e-01  1 0.56638746
#&gt; 23 -3.606043e-02 -0.100752464 0.02481763 1.288549e+00  1 0.25631561
#&gt; 24 -4.004255e-02 -0.102106258 0.02464356 1.557956e+00  1 0.21196474
#&gt; 25 -2.106582e-03 -0.063417410 0.06006986 4.712443e-03  1 0.94527042
#&gt; 26  1.872518e-02 -0.041398467 0.06738003 4.675927e-01  1 0.49409673
#&gt; 27  4.883397e-02 -0.020014739 0.10839306 2.431363e+00  1 0.11892948
#&gt; 28 -2.656416e-02 -0.077532895 0.03480302 8.736937e-01  1 0.34993476
#&gt; 29 -7.358206e-03 -0.072101888 0.05801669 5.378160e-02  1 0.81660900
#&gt; 30  2.866925e-02 -0.024396941 0.08422854 1.028129e+00  1 0.31059854
#&gt; 
#&gt; $uDIF
#&gt;           uDIF      CI_2.5    CI_97.5         X2 df           p
#&gt; 1  0.000000000 0.000000000 0.00000000         NA NA          NA
#&gt; 2  0.000000000 0.000000000 0.00000000         NA NA          NA
#&gt; 3  0.000000000 0.000000000 0.00000000         NA NA          NA
#&gt; 4  0.000000000 0.000000000 0.00000000         NA NA          NA
#&gt; 5  0.000000000 0.000000000 0.00000000         NA NA          NA
#&gt; 6  0.015749408 0.005530459 0.08165227 0.29645572  2 0.862234625
#&gt; 7  0.026159781 0.008093708 0.08697359 0.71272050  2 0.700220321
#&gt; 8  0.007678372 0.004520219 0.08256682 0.05925628  2 0.970806470
#&gt; 9  0.026275361 0.008565099 0.09456472 0.69303237  2 0.707147375
#&gt; 10 0.035753335 0.008965804 0.09365099 1.64827991  2 0.438612057
#&gt; 11 0.058810878 0.017480388 0.12425095 3.43873823  2 0.179179153
#&gt; 12 0.016005343 0.006220820 0.08416318 0.27946646  2 0.869590186
#&gt; 13 0.022427623 0.007220475 0.07986987 0.73994277  2 0.690754098
#&gt; 14 0.046160533 0.012781077 0.10692571 2.65533580  2 0.265094768
#&gt; 15 0.045463284 0.010353713 0.10598746 2.12841323  2 0.345001464
#&gt; 16 0.030463813 0.008137477 0.10155719 0.85279292  2 0.652857458
#&gt; 17 0.019055697 0.006826064 0.08209515 0.48781622  2 0.783559634
#&gt; 18 0.012956165 0.006365371 0.07826069 0.22325577  2 0.894377008
#&gt; 19 0.093761482 0.046184197 0.15163863 9.86533034  2 0.007207269
#&gt; 20 0.009532902 0.003581211 0.05338815 0.27162852  2 0.873004767
#&gt; 21 0.069601295 0.025193366 0.13043737 5.27283848  2 0.071617255
#&gt; 22 0.019757391 0.007199267 0.07862866 0.49679845  2 0.780048468
#&gt; 23 0.063774220 0.021771716 0.12229951 4.63965169  2 0.098290702
#&gt; 24 0.040082054 0.009483747 0.10321645 1.58046954  2 0.453738260
#&gt; 25 0.018483788 0.005462973 0.08420776 0.41681352  2 0.811876730
#&gt; 26 0.047067547 0.012587370 0.09724191 3.23246741  2 0.198645449
#&gt; 27 0.048833972 0.011436588 0.10845617 2.43136314  2 0.296507855
#&gt; 28 0.028764762 0.006617923 0.08429786 1.14275148  2 0.564747957
#&gt; 29 0.025327769 0.007858227 0.08834417 0.71739119  2 0.698586973
#&gt; 30 0.030823229 0.011208325 0.08929620 1.34754734  2 0.509781198
#&gt; </div><div class='input'><span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, focal_items <span class='op'>=</span> <span class='fl'>6</span><span class='op'>:</span><span class='fl'>10</span>, param_set<span class='op'>=</span><span class='va'>param_set</span><span class='op'>)</span> <span class='co'>#DBF</span>
</div><div class='output co'>#&gt;      n_focal_items       stat     CI_2.5   CI_97.5        X2 df         p
#&gt; sDRF             5 0.06949048 -0.1214734 0.2327058 0.5632852  1 0.4529396
#&gt; uDRF             5 0.07136551  0.0232153 0.2663033 0.6522604  2 0.7217112</div><div class='input'><span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, param_set<span class='op'>=</span><span class='va'>param_set</span><span class='op'>)</span> <span class='co'>#DTF</span>
</div><div class='output co'>#&gt;      n_focal_items      stat      CI_2.5   CI_97.5        X2 df         p
#&gt; sDRF            30 0.3259068 -0.37546745 0.9469391 0.8682655  1 0.3514359
#&gt; uDRF            30 0.3259072  0.08663966 0.9720209 0.8683147  2 0.6478103</div><div class='input'>
<span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, focal_items <span class='op'>=</span> <span class='fl'>6</span><span class='op'>:</span><span class='fl'>10</span>, draws<span class='op'>=</span><span class='fl'>500</span><span class='op'>)</span> <span class='co'>#DBF</span>
</div><div class='output co'>#&gt;      n_focal_items       stat      CI_2.5   CI_97.5        X2 df         p
#&gt; sDRF             5 0.06949048 -0.09438015 0.2439824 0.6209404  1 0.4306981
#&gt; uDRF             5 0.07136551  0.02456375 0.2694312 0.7164917  2 0.6989012</div><div class='input'><span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, focal_items <span class='op'>=</span> <span class='fl'>10</span><span class='op'>:</span><span class='fl'>15</span>, draws<span class='op'>=</span><span class='fl'>500</span><span class='op'>)</span> <span class='co'>#DBF</span>
</div><div class='output co'>#&gt;      n_focal_items      stat      CI_2.5   CI_97.5       X2 df          p
#&gt; sDRF             6 0.1750753 -0.02433989 0.3528574 3.146044  1 0.07611129
#&gt; uDRF             6 0.1750789  0.03986196 0.3647100 3.148272  2 0.20718652</div><div class='input'>
<span class='va'>DIFs</span> <span class='op'>&lt;-</span> <span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, draws <span class='op'>=</span> <span class='fl'>500</span>, DIF<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>DIFs</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $sDIF
#&gt;             sDIF       CI_2.5    CI_97.5           X2 df          p
#&gt; 1   0.000000e+00  0.000000000 0.00000000           NA NA         NA
#&gt; 2   0.000000e+00  0.000000000 0.00000000           NA NA         NA
#&gt; 3   0.000000e+00  0.000000000 0.00000000           NA NA         NA
#&gt; 4   0.000000e+00  0.000000000 0.00000000           NA NA         NA
#&gt; 5   0.000000e+00  0.000000000 0.00000000           NA NA         NA
#&gt; 6   6.438132e-05 -0.065294588 0.05731113 4.260421e-06  1 0.99835310
#&gt; 7   2.610643e-02 -0.031254432 0.08505672 7.259543e-01  1 0.39419771
#&gt; 8   7.678371e-03 -0.053238860 0.07383808 5.551644e-02  1 0.81372812
#&gt; 9   2.583815e-02 -0.041131743 0.08640406 5.970596e-01  1 0.43970211
#&gt; 10  9.803141e-03 -0.048727852 0.07524566 1.039073e-01  1 0.74719022
#&gt; 11  5.558443e-02 -0.009647363 0.11295444 3.085319e+00  1 0.07900178
#&gt; 12  1.599366e-02 -0.040588498 0.06958481 3.350900e-01  1 0.56267718
#&gt; 13  1.485693e-02 -0.040239621 0.07030548 2.525557e-01  1 0.61528127
#&gt; 14  3.337543e-02 -0.035253113 0.09233170 1.053262e+00  1 0.30475694
#&gt; 15  4.546167e-02 -0.017058167 0.10905947 2.077586e+00  1 0.14947641
#&gt; 16  3.046381e-02 -0.029304330 0.09303213 9.287100e-01  1 0.33519835
#&gt; 17 -1.767682e-02 -0.078780263 0.04362091 3.244048e-01  1 0.56897249
#&gt; 18 -1.086906e-02 -0.067078922 0.04422147 1.473941e-01  1 0.70103818
#&gt; 19  4.512152e-02 -0.012424703 0.10185924 2.383523e+00  1 0.12262072
#&gt; 20  7.803226e-03 -0.029860702 0.04810700 1.617674e-01  1 0.68753452
#&gt; 21  6.958597e-02  0.013024953 0.13598497 4.925245e+00  1 0.02646705
#&gt; 22 -1.738086e-02 -0.076711279 0.04657324 3.215659e-01  1 0.57066814
#&gt; 23 -3.606043e-02 -0.098285683 0.02742548 1.346504e+00  1 0.24589019
#&gt; 24 -4.004255e-02 -0.105114112 0.02447221 1.517003e+00  1 0.21807358
#&gt; 25 -2.106582e-03 -0.064340305 0.05672747 4.709993e-03  1 0.94528463
#&gt; 26  1.872518e-02 -0.039104291 0.07237604 4.011177e-01  1 0.52651257
#&gt; 27  4.883397e-02 -0.018492832 0.10955917 2.225609e+00  1 0.13573913
#&gt; 28 -2.656416e-02 -0.081940977 0.03058326 8.296572e-01  1 0.36237166
#&gt; 29 -7.358206e-03 -0.078536212 0.05885229 4.857118e-02  1 0.82556845
#&gt; 30  2.866925e-02 -0.030801827 0.09873731 8.548676e-01  1 0.35517896
#&gt; 
#&gt; $uDIF
#&gt;           uDIF      CI_2.5    CI_97.5          X2 df           p
#&gt; 1  0.000000000 0.000000000 0.00000000          NA NA          NA
#&gt; 2  0.000000000 0.000000000 0.00000000          NA NA          NA
#&gt; 3  0.000000000 0.000000000 0.00000000          NA NA          NA
#&gt; 4  0.000000000 0.000000000 0.00000000          NA NA          NA
#&gt; 5  0.000000000 0.000000000 0.00000000          NA NA          NA
#&gt; 6  0.015749408 0.004499297 0.08155617  0.29660002  2 0.862172415
#&gt; 7  0.026159781 0.008532276 0.08789674  0.74156260  2 0.690194871
#&gt; 8  0.007678372 0.005187238 0.08029275  0.05551676  2 0.972623342
#&gt; 9  0.026275361 0.007687238 0.09088521  0.65701308  2 0.719998218
#&gt; 10 0.035753335 0.008858159 0.09709827  1.54347323  2 0.462209691
#&gt; 11 0.058810878 0.017869850 0.11854087  3.75705100  2 0.152815266
#&gt; 12 0.016005343 0.006509202 0.07459391  0.33942861  2 0.843905883
#&gt; 13 0.022427623 0.006438118 0.07837381  0.68705619  2 0.709263555
#&gt; 14 0.046160533 0.010012576 0.09761907  2.47112496  2 0.290671220
#&gt; 15 0.045463284 0.010098121 0.10936722  2.07927187  2 0.353583386
#&gt; 16 0.030463813 0.007837194 0.09571846  0.92872850  2 0.628534570
#&gt; 17 0.019055697 0.006416781 0.08220880  0.44164835  2 0.801857656
#&gt; 18 0.012956165 0.007532701 0.07835877  0.25219257  2 0.881529963
#&gt; 19 0.093761482 0.046246970 0.14811480 11.20341523  2 0.003691555
#&gt; 20 0.009532902 0.003983347 0.05315847  0.28671874  2 0.866442640
#&gt; 21 0.069601295 0.023650641 0.13598740  4.94622568  2 0.084321969
#&gt; 22 0.019757391 0.006801603 0.08203920  0.47510331  2 0.788556159
#&gt; 23 0.063774220 0.019875601 0.11921586  4.87944194  2 0.087185175
#&gt; 24 0.040082054 0.009743323 0.10583934  1.54449705  2 0.461973142
#&gt; 25 0.018483788 0.006654440 0.08814216  0.38858683  2 0.823416267
#&gt; 26 0.047067547 0.010325657 0.10102008  2.89875949  2 0.234715826
#&gt; 27 0.048833972 0.011215057 0.11033625  2.22560898  2 0.328636011
#&gt; 28 0.028764762 0.007553182 0.09068419  1.08630634  2 0.580913641
#&gt; 29 0.025327769 0.006842801 0.09308736  0.66892859  2 0.715721398
#&gt; 30 0.030823229 0.008425256 0.09874081  1.16101093  2 0.559615430
#&gt; </div><div class='input'><span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, draws <span class='op'>=</span> <span class='fl'>500</span>, DIF<span class='op'>=</span><span class='cn'>TRUE</span>, plot<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='DRF-10.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='va'>DIFs</span> <span class='op'>&lt;-</span> <span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, draws <span class='op'>=</span> <span class='fl'>500</span>, DIF<span class='op'>=</span><span class='cn'>TRUE</span>, focal_items <span class='op'>=</span> <span class='fl'>6</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>DIFs</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $sDIF
#&gt;            sDIF      CI_2.5    CI_97.5           X2 df         p
#&gt; 6  6.438132e-05 -0.06752147 0.06090674 4.014969e-06  1 0.9984012
#&gt; 7  2.610643e-02 -0.03495229 0.08463758 6.661601e-01  1 0.4143936
#&gt; 8  7.678371e-03 -0.05133638 0.06945888 6.007071e-02  1 0.8063842
#&gt; 9  2.583815e-02 -0.03161356 0.09049732 7.317465e-01  1 0.3923177
#&gt; 10 9.803141e-03 -0.05094609 0.07215565 9.579574e-02  1 0.7569345
#&gt; 
#&gt; $uDIF
#&gt;           uDIF      CI_2.5    CI_97.5         X2 df         p
#&gt; 6  0.015749408 0.008508353 0.08121427 0.28827932  2 0.8657668
#&gt; 7  0.026159781 0.007791079 0.09087971 0.67870377  2 0.7122318
#&gt; 8  0.007678372 0.006797147 0.07735370 0.06007135  2 0.9704109
#&gt; 9  0.026275361 0.008412816 0.09234613 0.80922598  2 0.6672350
#&gt; 10 0.035753335 0.011483639 0.09319771 1.50317180  2 0.4716180
#&gt; </div><div class='input'><span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, draws <span class='op'>=</span> <span class='fl'>500</span>, DIF<span class='op'>=</span><span class='cn'>TRUE</span>, focal_items <span class='op'>=</span> <span class='fl'>6</span><span class='op'>:</span><span class='fl'>10</span>, plot <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='DRF-11.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, DIF<span class='op'>=</span><span class='cn'>TRUE</span>, focal_items <span class='op'>=</span> <span class='fl'>6</span><span class='op'>)</span>
</div><div class='output co'>#&gt;           sDIF       uDIF
#&gt; 6 6.438132e-05 0.01574941</div><div class='input'><span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, draws<span class='op'>=</span><span class='fl'>500</span>, DIF<span class='op'>=</span><span class='cn'>TRUE</span>, focal_items <span class='op'>=</span> <span class='fl'>6</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $sDIF
#&gt;           sDIF      CI_2.5    CI_97.5           X2 df         p
#&gt; 6 6.438132e-05 -0.06097947 0.05882269 4.070173e-06  1 0.9983903
#&gt; 
#&gt; $uDIF
#&gt;         uDIF      CI_2.5    CI_97.5        X2 df         p
#&gt; 6 0.01574941 0.006040111 0.08144644 0.2763606  2 0.8709416
#&gt; </div><div class='input'>
<span class='co'># evaluate specific values for sDRF</span>
<span class='va'>Theta_nodes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>6</span>,<span class='fl'>6</span>,length.out <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>sDTF</span> <span class='op'>&lt;-</span> <span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, Theta_nodes<span class='op'>=</span><span class='va'>Theta_nodes</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>sDTF</span><span class='op'>)</span>
</div><div class='output co'>#&gt;            Theta         sDRF
#&gt; sDRF.1 -6.000000 -0.005776586
#&gt; sDRF.2 -5.878788 -0.006152846
#&gt; sDRF.3 -5.757576 -0.006538671
#&gt; sDRF.4 -5.636364 -0.006930010
#&gt; sDRF.5 -5.515152 -0.007321376
#&gt; sDRF.6 -5.393939 -0.007705492</div><div class='input'><span class='va'>sDTF</span> <span class='op'>&lt;-</span> <span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, Theta_nodes<span class='op'>=</span><span class='va'>Theta_nodes</span>, draws<span class='op'>=</span><span class='fl'>200</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>sDTF</span><span class='op'>)</span>
</div><div class='output co'>#&gt;            Theta         sDRF     CI_2.5    CI_97.5
#&gt; sDRF.1 -6.000000 -0.005776586 -0.2044718 0.07225588
#&gt; sDRF.2 -5.878788 -0.006152846 -0.2171697 0.07845840
#&gt; sDRF.3 -5.757576 -0.006538671 -0.2300578 0.08516987
#&gt; sDRF.4 -5.636364 -0.006930010 -0.2428113 0.09242874
#&gt; sDRF.5 -5.515152 -0.007321376 -0.2597278 0.10081222
#&gt; sDRF.6 -5.393939 -0.007705492 -0.2754785 0.11256754</div><div class='input'>
<span class='co'># sDIF (isolate single item)</span>
<span class='va'>sDIF</span> <span class='op'>&lt;-</span> <span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, Theta_nodes<span class='op'>=</span><span class='va'>Theta_nodes</span>, focal_items<span class='op'>=</span><span class='fl'>6</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>sDIF</span><span class='op'>)</span>
</div><div class='output co'>#&gt;            Theta         sDRF
#&gt; sDRF.1 -6.000000 -0.001155176
#&gt; sDRF.2 -5.878788 -0.001302176
#&gt; sDRF.3 -5.757576 -0.001467153
#&gt; sDRF.4 -5.636364 -0.001652160
#&gt; sDRF.5 -5.515152 -0.001859454
#&gt; sDRF.6 -5.393939 -0.002091510</div><div class='input'><span class='va'>sDIF</span> <span class='op'>&lt;-</span> <span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, Theta_nodes<span class='op'>=</span><span class='va'>Theta_nodes</span>, focal_items <span class='op'>=</span> <span class='fl'>6</span>, draws<span class='op'>=</span><span class='fl'>200</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>sDIF</span><span class='op'>)</span>
</div><div class='output co'>#&gt;            Theta         sDRF      CI_2.5     CI_97.5
#&gt; sDRF.1 -6.000000 -0.001155176 -0.01963416 0.005018858
#&gt; sDRF.2 -5.878788 -0.001302176 -0.02114750 0.005491261
#&gt; sDRF.3 -5.757576 -0.001467153 -0.02276410 0.006003684
#&gt; sDRF.4 -5.636364 -0.001652160 -0.02448883 0.006642257
#&gt; sDRF.5 -5.515152 -0.001859454 -0.02632646 0.007407769
#&gt; sDRF.6 -5.393939 -0.002091510 -0.02828149 0.008257209</div><div class='input'>
<span class='co'>## -------------</span>
<span class='co'>## random slopes and intercepts for 15 items, and latent mean difference</span>
<span class='co'>##    (no systematic DTF should exist, but DIF will be present)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span>
<span class='va'>dat1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='va'>N</span>, itemtype <span class='op'>=</span> <span class='st'>'dich'</span>, mu<span class='op'>=</span><span class='fl'>.50</span>, sigma<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>1.5</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dat2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='fl'>15</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>-</span><span class='fl'>15</span>, <span class='fl'>0</span>, <span class='fl'>.25</span><span class='op'>)</span><span class='op'>)</span>,
                <span class='va'>d</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='fl'>15</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>-</span><span class='fl'>15</span>, <span class='fl'>0</span>, <span class='fl'>.5</span><span class='op'>)</span><span class='op'>)</span>, <span class='va'>N</span>, itemtype <span class='op'>=</span> <span class='st'>'dich'</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>dat1</span>, <span class='va'>dat2</span><span class='op'>)</span>
<span class='va'>mod1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='multipleGroup.html'>multipleGroup</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span>, group<span class='op'>=</span><span class='va'>group</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>mod1</span><span class='op'>)</span>
</div><div class='img'><img src='DRF-12.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod1</span><span class='op'>)</span> <span class='co'>#does not account for group differences! Need anchors</span>
</div><div class='output co'>#&gt; <span class='message'>No hyper-parameters were estimated in the DIF model. For effective</span>
#&gt; <span class='message'>                	DRF testing freeing the focal group hyper-parameters is recommended.</span></div><div class='output co'>#&gt;   n_focal_items     sDRF     uDRF
#&gt; 1            30 3.249892 3.267577</div><div class='input'>
<span class='va'>mod2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='multipleGroup.html'>multipleGroup</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>model</span>, group<span class='op'>=</span><span class='va'>group</span>, SE<span class='op'>=</span><span class='cn'>TRUE</span>,
                      invariance<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'free_means'</span>, <span class='st'>'free_var'</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>mod2</span><span class='op'>)</span>
</div><div class='img'><img src='DRF-13.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#significant DIF in multiple items....</span>
<span class='co'># DIF(mod2, which.par=c('a1', 'd'), items2test=16:30)</span>
<span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod2</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   n_focal_items      sDRF     uDRF
#&gt; 1            30 0.4236706 0.423671</div><div class='input'><span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod2</span>, draws<span class='op'>=</span><span class='fl'>500</span><span class='op'>)</span> <span class='co'>#non-sig DTF due to item cancellation</span>
</div><div class='output co'>#&gt;      n_focal_items      stat     CI_2.5  CI_97.5       X2 df         p
#&gt; sDRF            30 0.4236706 -0.3225258 1.022851 1.569794  1 0.2102369
#&gt; uDRF            30 0.4236710  0.1463710 1.140907 1.569854  2 0.4561530</div><div class='input'>
<span class='co'>## -------------</span>
<span class='co'>## systematic differing slopes and intercepts (clear DTF)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span>
<span class='va'>dat1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='va'>N</span>, itemtype <span class='op'>=</span> <span class='st'>'dich'</span>, mu<span class='op'>=</span><span class='fl'>.50</span>, sigma<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>1.5</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dat2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='fl'>15</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>-</span><span class='fl'>15</span>, <span class='fl'>1</span>, <span class='fl'>.25</span><span class='op'>)</span><span class='op'>)</span>, <span class='va'>d</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='fl'>15</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>-</span><span class='fl'>15</span>, <span class='fl'>1</span>, <span class='fl'>.5</span><span class='op'>)</span><span class='op'>)</span>,
                <span class='va'>N</span>, itemtype <span class='op'>=</span> <span class='st'>'dich'</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>dat1</span>, <span class='va'>dat2</span><span class='op'>)</span>
<span class='va'>mod3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='multipleGroup.html'>multipleGroup</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>model</span>, group<span class='op'>=</span><span class='va'>group</span>, SE<span class='op'>=</span><span class='cn'>TRUE</span>,
                      invariance<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'free_means'</span>, <span class='st'>'free_var'</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>mod3</span><span class='op'>)</span> <span class='co'>#visable DTF happening</span>
</div><div class='img'><img src='DRF-14.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># DIF(mod3, c('a1', 'd'), items2test=16:30)</span>
<span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod3</span><span class='op'>)</span> <span class='co'>#unsigned bias. Signed bias indicates group 2 scores generally higher on average</span>
</div><div class='output co'>#&gt;   n_focal_items     sDRF     uDRF
#&gt; 1            30 -1.98022 2.190883</div><div class='input'><span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod3</span>, draws<span class='op'>=</span><span class='fl'>500</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      n_focal_items      stat    CI_2.5   CI_97.5       X2 df            p
#&gt; sDRF            30 -1.980220 -2.708741 -1.249580 29.38496  1 5.933646e-08
#&gt; uDRF            30  2.190883  1.613357  2.783593 42.01197  2 7.537299e-10</div><div class='input'><span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod3</span>, draws<span class='op'>=</span><span class='fl'>500</span>, plot<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span> <span class='co'>#multiple DRF areas along Theta</span>
</div><div class='img'><img src='DRF-15.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># plot the DIF</span>
<span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod3</span>, draws<span class='op'>=</span><span class='fl'>500</span>, DIF<span class='op'>=</span><span class='cn'>TRUE</span>, plot<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='DRF-16.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># evaluate specific values for sDRF</span>
<span class='va'>Theta_nodes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>6</span>,<span class='fl'>6</span>,length.out <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>sDTF</span> <span class='op'>&lt;-</span> <span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod3</span>, Theta_nodes<span class='op'>=</span><span class='va'>Theta_nodes</span>, draws<span class='op'>=</span><span class='fl'>200</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>sDTF</span><span class='op'>)</span>
</div><div class='output co'>#&gt;            Theta       sDRF      CI_2.5    CI_97.5
#&gt; sDRF.1 -6.000000 0.01165886 -0.01552299 0.07784484
#&gt; sDRF.2 -5.878788 0.01372653 -0.01500127 0.08766108
#&gt; sDRF.3 -5.757576 0.01616425 -0.01413027 0.09865836
#&gt; sDRF.4 -5.636364 0.01903831 -0.01419153 0.11096369
#&gt; sDRF.5 -5.515152 0.02242663 -0.01419422 0.12471399
#&gt; sDRF.6 -5.393939 0.02642073 -0.01400217 0.14005594</div><div class='input'>
<span class='co'># DIF</span>
<span class='va'>sDIF</span> <span class='op'>&lt;-</span> <span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod3</span>, Theta_nodes<span class='op'>=</span><span class='va'>Theta_nodes</span>, focal_items <span class='op'>=</span> <span class='fl'>30</span>, draws<span class='op'>=</span><span class='fl'>200</span><span class='op'>)</span>
<span class='fu'>car</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/car/man/some.html'>some</a></span><span class='op'>(</span><span class='va'>sDIF</span><span class='op'>)</span>
</div><div class='output co'>#&gt;              Theta         sDRF        CI_2.5      CI_97.5
#&gt; sDRF.5  -5.5151515  0.000430581 -4.448691e-05  0.002535833
#&gt; sDRF.25 -3.0909091  0.008429818 -5.036804e-03  0.027651274
#&gt; sDRF.40 -1.2727273 -0.014770028 -1.170415e-01  0.053457168
#&gt; sDRF.45 -0.6666667 -0.134295934 -2.489299e-01 -0.045577480
#&gt; sDRF.64  1.6363636 -0.128901263 -4.265657e-04  0.007424417
#&gt; sDRF.67  2.0000000 -0.086162768 -8.792029e-04  0.010680584
#&gt; sDRF.81  3.6969697 -0.010231937 -1.686965e-02  0.050268074
#&gt; sDRF.87  4.4242424 -0.003928347 -6.533574e-02  0.063278257
#&gt; sDRF.91  4.9090909 -0.002066809 -1.376504e-01  0.039571593
#&gt; sDRF.92  5.0303030 -0.001759730 -1.649933e-01  0.028218417</div><div class='input'>
<span class='co'>## ----------------------------------------------------------------</span>
<span class='co'>### multidimensional DTF</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span>
<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>50</span>
<span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>1000</span>

<span class='co'># only first 5 items as anchors within each dimension</span>
<span class='va'>model</span> <span class='op'>&lt;-</span> <span class='st'>'F1 = 1-25
          F2 = 26-50
          COV = F1*F2
          CONSTRAINB = (1-5, a1), (1-5, 26-30, d), (26-30, a2)'</span>

<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>25</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='fl'>50</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>25</span><span class='op'>)</span><span class='op'>)</span>, <span class='va'>n</span><span class='op'>)</span>
<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>, <span class='va'>n</span><span class='op'>)</span>
<span class='va'>group</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'Group_1'</span>, <span class='va'>N</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'Group_2'</span>, <span class='va'>N</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>Cov</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>.5</span>, <span class='fl'>.5</span>, <span class='fl'>1.5</span><span class='op'>)</span>, <span class='fl'>2</span><span class='op'>)</span>
<span class='va'>Mean</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.5</span><span class='op'>)</span>

<span class='co'># groups completely equal</span>
<span class='va'>dat1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='va'>N</span>, itemtype <span class='op'>=</span> <span class='st'>'dich'</span>, sigma <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cov2cor</a></span><span class='op'>(</span><span class='va'>Cov</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dat2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='va'>N</span>, itemtype <span class='op'>=</span> <span class='st'>'dich'</span>, sigma <span class='op'>=</span> <span class='va'>Cov</span>, mu <span class='op'>=</span> <span class='va'>Mean</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>dat1</span>, <span class='va'>dat2</span><span class='op'>)</span>
<span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='multipleGroup.html'>multipleGroup</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>model</span>, group<span class='op'>=</span><span class='va'>group</span>, SE<span class='op'>=</span><span class='cn'>TRUE</span>,
                     invariance<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'free_means'</span>, <span class='st'>'free_var'</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>mod</span>, simplify<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $Group_1
#&gt; $items
#&gt;            a1    a2      d g u
#&gt; Item_1  1.006 0.000 -1.208 0 1
#&gt; Item_2  1.080 0.000  0.301 0 1
#&gt; Item_3  0.833 0.000  1.127 0 1
#&gt; Item_4  0.977 0.000 -2.342 0 1
#&gt; Item_5  1.006 0.000  0.410 0 1
#&gt; Item_6  0.864 0.000  0.428 0 1
#&gt; Item_7  1.014 0.000 -0.495 0 1
#&gt; Item_8  1.133 0.000 -0.472 0 1
#&gt; Item_9  0.945 0.000 -0.585 0 1
#&gt; Item_10 1.001 0.000 -0.787 0 1
#&gt; Item_11 1.009 0.000 -0.390 0 1
#&gt; Item_12 0.920 0.000 -1.061 0 1
#&gt; Item_13 1.189 0.000 -0.711 0 1
#&gt; Item_14 1.125 0.000  0.067 0 1
#&gt; Item_15 1.122 0.000  0.896 0 1
#&gt; Item_16 1.094 0.000 -0.203 0 1
#&gt; Item_17 1.041 0.000 -0.479 0 1
#&gt; Item_18 1.011 0.000 -0.849 0 1
#&gt; Item_19 0.962 0.000 -0.768 0 1
#&gt; Item_20 0.937 0.000  2.372 0 1
#&gt; Item_21 0.935 0.000  0.082 0 1
#&gt; Item_22 0.886 0.000 -0.482 0 1
#&gt; Item_23 0.921 0.000 -0.443 0 1
#&gt; Item_24 0.937 0.000  0.521 0 1
#&gt; Item_25 0.959 0.000 -0.674 0 1
#&gt; Item_26 0.000 0.999 -1.498 0 1
#&gt; Item_27 0.000 0.978  0.590 0 1
#&gt; Item_28 0.000 0.997 -1.035 0 1
#&gt; Item_29 0.000 0.917 -0.055 0 1
#&gt; Item_30 0.000 0.982 -0.970 0 1
#&gt; Item_31 0.000 0.891  0.931 0 1
#&gt; Item_32 0.000 0.863 -0.453 0 1
#&gt; Item_33 0.000 1.140 -0.759 0 1
#&gt; Item_34 0.000 0.943 -0.469 0 1
#&gt; Item_35 0.000 1.289 -1.852 0 1
#&gt; Item_36 0.000 0.791 -1.064 0 1
#&gt; Item_37 0.000 0.980 -2.323 0 1
#&gt; Item_38 0.000 1.051 -1.367 0 1
#&gt; Item_39 0.000 1.097 -0.113 0 1
#&gt; Item_40 0.000 0.908 -0.522 0 1
#&gt; Item_41 0.000 1.059  1.708 0 1
#&gt; Item_42 0.000 1.146 -1.078 0 1
#&gt; Item_43 0.000 1.086 -0.967 0 1
#&gt; Item_44 0.000 1.095 -0.415 0 1
#&gt; Item_45 0.000 0.984 -1.066 0 1
#&gt; Item_46 0.000 0.996 -0.726 0 1
#&gt; Item_47 0.000 1.330 -1.037 0 1
#&gt; Item_48 0.000 1.072 -1.147 0 1
#&gt; Item_49 0.000 0.898 -0.428 0 1
#&gt; Item_50 0.000 1.078 -0.525 0 1
#&gt; 
#&gt; $means
#&gt; F1 F2 
#&gt;  0  0 
#&gt; 
#&gt; $cov
#&gt;       F1    F2
#&gt; F1 1.000 0.453
#&gt; F2 0.453 1.000
#&gt; 
#&gt; 
#&gt; $Group_2
#&gt; $items
#&gt;            a1    a2      d g u
#&gt; Item_1  1.006 0.000 -1.208 0 1
#&gt; Item_2  1.080 0.000  0.301 0 1
#&gt; Item_3  0.833 0.000  1.127 0 1
#&gt; Item_4  0.977 0.000 -2.342 0 1
#&gt; Item_5  1.006 0.000  0.410 0 1
#&gt; Item_6  0.886 0.000  0.558 0 1
#&gt; Item_7  0.967 0.000 -0.583 0 1
#&gt; Item_8  0.988 0.000 -0.613 0 1
#&gt; Item_9  0.962 0.000 -0.467 0 1
#&gt; Item_10 0.866 0.000 -0.999 0 1
#&gt; Item_11 1.076 0.000 -0.448 0 1
#&gt; Item_12 1.145 0.000 -1.198 0 1
#&gt; Item_13 0.991 0.000 -0.789 0 1
#&gt; Item_14 1.039 0.000  0.071 0 1
#&gt; Item_15 1.201 0.000  1.071 0 1
#&gt; Item_16 0.989 0.000 -0.084 0 1
#&gt; Item_17 0.995 0.000 -0.569 0 1
#&gt; Item_18 0.932 0.000 -0.925 0 1
#&gt; Item_19 0.866 0.000 -0.789 0 1
#&gt; Item_20 1.123 0.000  2.463 0 1
#&gt; Item_21 1.055 0.000  0.200 0 1
#&gt; Item_22 1.107 0.000 -0.610 0 1
#&gt; Item_23 0.992 0.000 -0.512 0 1
#&gt; Item_24 0.992 0.000  0.388 0 1
#&gt; Item_25 0.934 0.000 -0.794 0 1
#&gt; Item_26 0.000 0.999 -1.498 0 1
#&gt; Item_27 0.000 0.978  0.590 0 1
#&gt; Item_28 0.000 0.997 -1.035 0 1
#&gt; Item_29 0.000 0.917 -0.055 0 1
#&gt; Item_30 0.000 0.982 -0.970 0 1
#&gt; Item_31 0.000 1.015  0.962 0 1
#&gt; Item_32 0.000 1.115 -0.595 0 1
#&gt; Item_33 0.000 1.096 -0.874 0 1
#&gt; Item_34 0.000 0.857 -0.486 0 1
#&gt; Item_35 0.000 1.138 -1.636 0 1
#&gt; Item_36 0.000 1.085 -1.353 0 1
#&gt; Item_37 0.000 1.115 -2.169 0 1
#&gt; Item_38 0.000 1.146 -1.450 0 1
#&gt; Item_39 0.000 1.130 -0.441 0 1
#&gt; Item_40 0.000 0.978 -0.632 0 1
#&gt; Item_41 0.000 1.202  1.439 0 1
#&gt; Item_42 0.000 0.942 -0.943 0 1
#&gt; Item_43 0.000 1.033 -0.899 0 1
#&gt; Item_44 0.000 1.145 -0.339 0 1
#&gt; Item_45 0.000 0.844 -0.728 0 1
#&gt; Item_46 0.000 1.068 -1.045 0 1
#&gt; Item_47 0.000 0.953 -1.123 0 1
#&gt; Item_48 0.000 1.019 -1.316 0 1
#&gt; Item_49 0.000 0.881 -0.381 0 1
#&gt; Item_50 0.000 1.093 -0.605 0 1
#&gt; 
#&gt; $means
#&gt;    F1    F2 
#&gt; 0.071 0.505 
#&gt; 
#&gt; $cov
#&gt;       F1    F2
#&gt; F1 1.067 0.518
#&gt; F2 0.518 1.415
#&gt; 
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>mod</span>, degrees <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>45</span>,<span class='fl'>45</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='DRF-17.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   n_focal_items      sDRF      uDRF
#&gt; 1            50 0.3468044 0.3468044</div><div class='input'>
<span class='co'># some intercepts slightly higher in Group 2</span>
<span class='va'>d2</span> <span class='op'>&lt;-</span> <span class='va'>d</span>
<span class='va'>d2</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>:</span><span class='fl'>15</span>, <span class='fl'>31</span><span class='op'>:</span><span class='fl'>35</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>d2</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>:</span><span class='fl'>15</span>, <span class='fl'>31</span><span class='op'>:</span><span class='fl'>35</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>+</span> <span class='fl'>1</span>
<span class='va'>dat1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='va'>N</span>, itemtype <span class='op'>=</span> <span class='st'>'dich'</span>, sigma <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cov2cor</a></span><span class='op'>(</span><span class='va'>Cov</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dat2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d2</span>, <span class='va'>N</span>, itemtype <span class='op'>=</span> <span class='st'>'dich'</span>, sigma <span class='op'>=</span> <span class='va'>Cov</span>, mu <span class='op'>=</span> <span class='va'>Mean</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>dat1</span>, <span class='va'>dat2</span><span class='op'>)</span>
<span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='multipleGroup.html'>multipleGroup</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>model</span>, group<span class='op'>=</span><span class='va'>group</span>, SE<span class='op'>=</span><span class='cn'>TRUE</span>,
                     invariance<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'free_means'</span>, <span class='st'>'free_var'</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>mod</span>, simplify<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $Group_1
#&gt; $items
#&gt;            a1    a2      d g u
#&gt; Item_1  0.943 0.000 -1.195 0 1
#&gt; Item_2  0.974 0.000  0.294 0 1
#&gt; Item_3  0.833 0.000  1.131 0 1
#&gt; Item_4  1.049 0.000 -2.575 0 1
#&gt; Item_5  1.078 0.000  0.517 0 1
#&gt; Item_6  0.919 0.000  0.456 0 1
#&gt; Item_7  0.929 0.000 -0.472 0 1
#&gt; Item_8  0.918 0.000 -0.554 0 1
#&gt; Item_9  0.907 0.000 -0.582 0 1
#&gt; Item_10 1.096 0.000 -0.821 0 1
#&gt; Item_11 1.000 0.000 -0.483 0 1
#&gt; Item_12 0.987 0.000 -1.016 0 1
#&gt; Item_13 1.013 0.000 -0.869 0 1
#&gt; Item_14 0.861 0.000  0.104 0 1
#&gt; Item_15 1.097 0.000  0.908 0 1
#&gt; Item_16 0.871 0.000 -0.119 0 1
#&gt; Item_17 0.949 0.000 -0.417 0 1
#&gt; Item_18 1.019 0.000 -0.987 0 1
#&gt; Item_19 1.031 0.000 -0.962 0 1
#&gt; Item_20 0.904 0.000  2.378 0 1
#&gt; Item_21 1.177 0.000  0.061 0 1
#&gt; Item_22 1.044 0.000 -0.551 0 1
#&gt; Item_23 0.949 0.000 -0.510 0 1
#&gt; Item_24 0.915 0.000  0.387 0 1
#&gt; Item_25 0.901 0.000 -0.778 0 1
#&gt; Item_26 0.000 0.978 -1.450 0 1
#&gt; Item_27 0.000 0.999  0.603 0 1
#&gt; Item_28 0.000 1.105 -1.109 0 1
#&gt; Item_29 0.000 1.034  0.043 0 1
#&gt; Item_30 0.000 0.974 -0.925 0 1
#&gt; Item_31 0.000 0.982  1.257 0 1
#&gt; Item_32 0.000 1.012 -0.407 0 1
#&gt; Item_33 0.000 0.957 -0.619 0 1
#&gt; Item_34 0.000 1.076 -0.548 0 1
#&gt; Item_35 0.000 0.761 -1.608 0 1
#&gt; Item_36 0.000 0.962 -1.091 0 1
#&gt; Item_37 0.000 0.891 -2.076 0 1
#&gt; Item_38 0.000 0.895 -1.162 0 1
#&gt; Item_39 0.000 1.023 -0.260 0 1
#&gt; Item_40 0.000 0.949 -0.394 0 1
#&gt; Item_41 0.000 1.145  1.450 0 1
#&gt; Item_42 0.000 1.037 -1.063 0 1
#&gt; Item_43 0.000 0.891 -0.937 0 1
#&gt; Item_44 0.000 0.929 -0.397 0 1
#&gt; Item_45 0.000 0.987 -0.887 0 1
#&gt; Item_46 0.000 0.955 -1.033 0 1
#&gt; Item_47 0.000 0.888 -1.063 0 1
#&gt; Item_48 0.000 1.058 -1.267 0 1
#&gt; Item_49 0.000 0.969 -0.486 0 1
#&gt; Item_50 0.000 1.086 -0.442 0 1
#&gt; 
#&gt; $means
#&gt; F1 F2 
#&gt;  0  0 
#&gt; 
#&gt; $cov
#&gt;       F1    F2
#&gt; F1 1.000 0.409
#&gt; F2 0.409 1.000
#&gt; 
#&gt; 
#&gt; $Group_2
#&gt; $items
#&gt;            a1    a2      d g u
#&gt; Item_1  0.943 0.000 -1.195 0 1
#&gt; Item_2  0.974 0.000  0.294 0 1
#&gt; Item_3  0.833 0.000  1.131 0 1
#&gt; Item_4  1.049 0.000 -2.575 0 1
#&gt; Item_5  1.078 0.000  0.517 0 1
#&gt; Item_6  0.904 0.000  0.610 0 1
#&gt; Item_7  1.006 0.000 -0.476 0 1
#&gt; Item_8  0.889 0.000 -0.501 0 1
#&gt; Item_9  0.856 0.000 -0.604 0 1
#&gt; Item_10 0.892 0.000  0.069 0 1
#&gt; Item_11 0.931 0.000  0.498 0 1
#&gt; Item_12 0.963 0.000  0.065 0 1
#&gt; Item_13 0.845 0.000  0.311 0 1
#&gt; Item_14 0.894 0.000  1.036 0 1
#&gt; Item_15 0.998 0.000  1.919 0 1
#&gt; Item_16 0.949 0.000 -0.155 0 1
#&gt; Item_17 0.990 0.000 -0.545 0 1
#&gt; Item_18 0.867 0.000 -0.944 0 1
#&gt; Item_19 0.894 0.000 -0.871 0 1
#&gt; Item_20 0.733 0.000  2.195 0 1
#&gt; Item_21 0.854 0.000  0.059 0 1
#&gt; Item_22 0.784 0.000 -0.498 0 1
#&gt; Item_23 0.967 0.000 -0.561 0 1
#&gt; Item_24 0.945 0.000  0.385 0 1
#&gt; Item_25 0.940 0.000 -0.794 0 1
#&gt; Item_26 0.000 0.978 -1.450 0 1
#&gt; Item_27 0.000 0.999  0.603 0 1
#&gt; Item_28 0.000 1.105 -1.109 0 1
#&gt; Item_29 0.000 1.034  0.043 0 1
#&gt; Item_30 0.000 0.974 -0.925 0 1
#&gt; Item_31 0.000 0.998  1.989 0 1
#&gt; Item_32 0.000 1.190  0.252 0 1
#&gt; Item_33 0.000 1.064  0.076 0 1
#&gt; Item_34 0.000 0.885  0.444 0 1
#&gt; Item_35 0.000 1.065 -0.597 0 1
#&gt; Item_36 0.000 1.079 -1.273 0 1
#&gt; Item_37 0.000 1.034 -2.217 0 1
#&gt; Item_38 0.000 1.040 -1.451 0 1
#&gt; Item_39 0.000 1.159 -0.496 0 1
#&gt; Item_40 0.000 1.015 -0.711 0 1
#&gt; Item_41 0.000 0.946  1.416 0 1
#&gt; Item_42 0.000 1.006 -1.145 0 1
#&gt; Item_43 0.000 0.968 -0.818 0 1
#&gt; Item_44 0.000 1.099 -0.322 0 1
#&gt; Item_45 0.000 1.062 -1.103 0 1
#&gt; Item_46 0.000 1.064 -0.951 0 1
#&gt; Item_47 0.000 1.025 -1.122 0 1
#&gt; Item_48 0.000 0.975 -1.194 0 1
#&gt; Item_49 0.000 1.082 -0.461 0 1
#&gt; Item_50 0.000 0.935 -0.513 0 1
#&gt; 
#&gt; $means
#&gt;    F1    F2 
#&gt; 0.003 0.578 
#&gt; 
#&gt; $cov
#&gt;       F1    F2
#&gt; F1 1.164 0.458
#&gt; F2 0.458 1.341
#&gt; 
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>mod</span>, degrees <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>45</span>,<span class='fl'>45</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='DRF-18.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   n_focal_items      sDRF     uDRF
#&gt; 1            50 -1.803178 1.803178</div><div class='input'><span class='fu'>DRF</span><span class='op'>(</span><span class='va'>mod</span>, draws <span class='op'>=</span> <span class='fl'>500</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      n_focal_items      stat    CI_2.5   CI_97.5      X2 df            p
#&gt; sDRF            50 -1.803178 -2.376726 -1.254129 39.8186  1 2.786787e-10
#&gt; uDRF            50  1.803178  1.250615  2.368902 39.8186  2 2.256842e-09</div><div class='input'>
<span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


