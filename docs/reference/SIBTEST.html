<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simultaneous Item Bias Test (SIBTEST) — SIBTEST • mirt</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Simultaneous Item Bias Test (SIBTEST) — SIBTEST" />
<meta property="og:description" content="Classical test theory approach to detecting unidirectional and bidirectional (with one
crossing location) DIF. This family of statistics is intended for unidimensional tests,
and applies a regression-corrected matched-total score approach to quantify the response
bias between two groups. Can be used for DIF, DBF, and DTF testing." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mirt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.32.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mirt-vignettes.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/philchalmers/mirt/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simultaneous Item Bias Test (SIBTEST)</h1>
    <small class="dont-index">Source: <a href='https://github.com/philchalmers/mirt/blob/master/R/SIBTEST.R'><code>R/SIBTEST.R</code></a></small>
    <div class="hidden name"><code>SIBTEST.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Classical test theory approach to detecting unidirectional and bidirectional (with one
crossing location) DIF. This family of statistics is intended for unidimensional tests,
and applies a regression-corrected matched-total score approach to quantify the response
bias between two groups. Can be used for DIF, DBF, and DTF testing.</p>
    </div>

    <pre class="usage"><span class='fu'>SIBTEST</span><span class='op'>(</span>
  <span class='va'>dat</span>,
  <span class='va'>group</span>,
  <span class='va'>suspect_set</span>,
  <span class='va'>match_set</span>,
  focal_name <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>group</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>,
  guess_correction <span class='op'>=</span> <span class='fl'>0</span>,
  Jmin <span class='op'>=</span> <span class='fl'>5</span>,
  na.rm <span class='op'>=</span> <span class='cn'>FALSE</span>,
  LiStout1996 <span class='op'>=</span> <span class='cn'>FALSE</span>,
  permute <span class='op'>=</span> <span class='fl'>1000</span>,
  pk_focal <span class='op'>=</span> <span class='cn'>FALSE</span>,
  correction <span class='op'>=</span> <span class='cn'>TRUE</span>,
  details <span class='op'>=</span> <span class='cn'>FALSE</span>,
  plot <span class='op'>=</span> <span class='st'>"none"</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dat</th>
      <td><p>integer-based dataset to be tested, containing dichotomous or polytomous responses</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>a vector indicating group membership with the same length as the number of rows in
<code>dat</code></p></td>
    </tr>
    <tr>
      <th>suspect_set</th>
      <td><p>an integer vector indicating which items to inspect with SIBTEST. Including only
one value will perform a DIF test, while including more than one will perform a simultaneous
bundle test (DBF); including all non-matched items will perform DTF.
If missing, a simultaneous test using all the items not listed in match_set
will be used (i.e., DTF)</p></td>
    </tr>
    <tr>
      <th>match_set</th>
      <td><p>an integer vector indicating which items to use as the items which are matched
(i.e., contain no DIF). These are analogous to 'anchor' items in the likelihood method to locate
DIF. If missing, all items other than the items found in the <code>suspect_set</code> will be used</p></td>
    </tr>
    <tr>
      <th>focal_name</th>
      <td><p>name of the focal group; e.g., <code>'focal'</code>. If not specified then one will be
selected automatically using <code>unique(group)[2]</code></p></td>
    </tr>
    <tr>
      <th>guess_correction</th>
      <td><p>a vector of numbers from 0 to 1 indicating how much to correct the items
for guessing. It's length should be the same as ncol(dat)</p></td>
    </tr>
    <tr>
      <th>Jmin</th>
      <td><p>the minimum number of observations required when splitting the data into focal and
reference groups conditioned on the matched set</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p>logical; remove rows in <code>dat</code> with any missing values? If <code>TRUE</code>,
rows with missing data will be removed, as well as the corresponding elements in the <code>group</code>
input</p></td>
    </tr>
    <tr>
      <th>LiStout1996</th>
      <td><p>logical; perform the crossing test for non-compensatory bias
using Li and Stout's (1996) permutation approach? Default is <code>FALSE</code>, which uses the
Chalmers (2018) mixed degrees of freedom method</p></td>
    </tr>
    <tr>
      <th>permute</th>
      <td><p>number of permutations to perform when <code>LiStout1996 = TRUE</code>. Default is 1000</p></td>
    </tr>
    <tr>
      <th>pk_focal</th>
      <td><p>logical; using the group weights from the focal group instead of the total
sample? Default is FALSE as per Shealy and Stout's recommendation</p></td>
    </tr>
    <tr>
      <th>correction</th>
      <td><p>logical; apply the composite correction for the difference between focal
composite scores using the true-score regression technique? Default is <code>TRUE</code>,
reflecting Shealy and Stout's linear extrapolation method</p></td>
    </tr>
    <tr>
      <th>details</th>
      <td><p>logical; return a data.frame containing the details required to compute SIBTEST?</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>a character input indicating the type of plot to construct. Options are <code>'none'</code>
(default), <code>'observed'</code> for the scaled focal subtest scores against the matched subtest
scores, <code>'weights'</code> for the proportion weights used (i.e., the proportion of observations at
each matched score), <code>'difference'</code> for the difference between the scaled focal subtest scores
against the matched subtest scores, and <code>'wdifference'</code> for the conditional differences multiplied
by each respective weight. Note that the last plot reflects the compnents used in SIBTEST, and therefore
the sum of these plotted observations will equal the beta coefficient for SIBTEST</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional plotting arguments to be passed</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>SIBTEST is similar to the Mantel-Haenszel approach for detecting DIF but uses a regression
correction based on the KR-20/coefficient alpha reliability index to correct the observed
differences when the latent trait distributions are not equal.
Function supports the standard SIBTEST for dichotomous and polytomous data (compensatory) and
supports crossing DIF testing (i.e., non-compensatory/non-uniform) using the asymptotic sampling
distribution version of the Crossing-SIBTEST (CSIBTEST) statistic described by
Chalmers (2018) and the permutation method described by Li and Stout (1996).
For convenience, the beta coefficient for CSIBTEST is always reported as an absolute value.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Chalmers, R. P. (2018). Improving the Crossing-SIBTEST statistic for
detecting non-uniform DIF. <em>Psychometrika, 83</em>, 2, 376-386.</p>
<p>Chalmers, R., P. (2012). mirt: A Multidimensional Item Response Theory
Package for the R Environment. <em>Journal of Statistical Software, 48</em>(6), 1-29.
doi: <a href='https://doi.org/10.18637/jss.v048.i06'>10.18637/jss.v048.i06</a></p>
<p>Chang, H. H., Mazzeo, J. &amp; Roussos, L. (1996). DIF for Polytomously Scored Items: An Adaptation of the
  SIBTEST Procedure. <em>Journal of Educational Measurement, 33</em>, 333-353.</p>
<p>Li, H.-H. &amp; Stout, W. (1996). A new procedure for detection of crossing DIF.
<em>Psychometrika, 61</em>, 647-677.</p>
<p>Shealy, R. &amp; Stout, W. (1993). A model-based standardization approach that separates true
  bias/DIF from group ability differences and detect test bias/DTF as well as item bias/DIF.
  <em>Psychometrika, 58</em>, 159-194.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Phil Chalmers <a href='mailto:rphilip.chalmers@gmail.com'>rphilip.chalmers@gmail.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># \donttest{</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span>
<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>30</span>
<span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>500</span>
<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='va'>n</span><span class='op'>)</span>
<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>, <span class='va'>n</span><span class='op'>)</span>
<span class='va'>group</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'reference'</span>, <span class='va'>N</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'focal'</span>, <span class='va'>N</span><span class='op'>*</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## -------------</span>
<span class='co'># groups completely equal</span>
<span class='va'>dat1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='va'>N</span>, itemtype <span class='op'>=</span> <span class='st'>'dich'</span><span class='op'>)</span>
<span class='va'>dat2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='va'>N</span><span class='op'>*</span><span class='fl'>2</span>, itemtype <span class='op'>=</span> <span class='st'>'dich'</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>dat1</span>, <span class='va'>dat2</span><span class='op'>)</span>

<span class='co'># DIF (all other items as anchors)</span>
<span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, suspect_set <span class='op'>=</span> <span class='fl'>6</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          focal_group n_matched_set n_suspect_set   beta    SE    X2 df     p
#&gt; SIBTEST        focal            29             1 -0.014 0.027 0.265  1 0.606
#&gt; CSIBTEST       focal            29             1  0.015    NA 0.331  2 0.848</div><div class='input'>
<span class='co'># Some plots depicting the above tests</span>
<span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, suspect_set <span class='op'>=</span> <span class='fl'>6</span>, plot <span class='op'>=</span> <span class='st'>'observed'</span><span class='op'>)</span>
</div><div class='img'><img src='SIBTEST-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, suspect_set <span class='op'>=</span> <span class='fl'>6</span>, plot <span class='op'>=</span> <span class='st'>'weights'</span><span class='op'>)</span>
</div><div class='img'><img src='SIBTEST-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, suspect_set <span class='op'>=</span> <span class='fl'>6</span>, plot <span class='op'>=</span> <span class='st'>'wdifference'</span><span class='op'>)</span>
</div><div class='img'><img src='SIBTEST-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Include CSIBTEST with randomization method</span>
<span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, suspect_set <span class='op'>=</span> <span class='fl'>6</span>, LiStout1996 <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                     focal_group n_matched_set n_suspect_set   beta    SE    X2
#&gt; SIBTEST                   focal            29             1 -0.014 0.027 0.265
#&gt; CSIBTEST                  focal            29             1  0.015    NA 0.331
#&gt; CSIBTEST_randomized       focal            29             1  0.016 0.026 0.373
#&gt;                     df     p
#&gt; SIBTEST              1 0.606
#&gt; CSIBTEST             2 0.848
#&gt; CSIBTEST_randomized NA 0.797</div><div class='input'>
<span class='co'># DIF (specific anchors)</span>
<span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, match_set <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>, suspect_set <span class='op'>=</span> <span class='fl'>6</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          focal_group n_matched_set n_suspect_set   beta    SE    X2 df     p
#&gt; SIBTEST        focal             5             1 -0.008 0.028 0.078  1 0.781
#&gt; CSIBTEST       focal             5             1  0.004    NA 0.105  2 0.949</div><div class='input'><span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, match_set <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>, suspect_set <span class='op'>=</span> <span class='fl'>6</span>, LiStout1996<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                     focal_group n_matched_set n_suspect_set   beta    SE    X2
#&gt; SIBTEST                   focal             5             1 -0.008 0.028 0.078
#&gt; CSIBTEST                  focal             5             1  0.004    NA 0.105
#&gt; CSIBTEST_randomized       focal             5             1  0.006 0.026 0.046
#&gt;                     df     p
#&gt; SIBTEST              1 0.781
#&gt; CSIBTEST             2 0.949
#&gt; CSIBTEST_randomized NA 1.000</div><div class='input'>
<span class='co'># DBF (all and specific anchors, respectively)</span>
<span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, suspect_set <span class='op'>=</span> <span class='fl'>11</span><span class='op'>:</span><span class='fl'>30</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          focal_group n_matched_set n_suspect_set  beta    SE    X2 df    p
#&gt; SIBTEST        focal            10            20 0.053 0.165 0.102  1 0.75
#&gt; CSIBTEST       focal            10            20 0.053    NA 0.102  1 0.75</div><div class='input'><span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, match_set <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>, suspect_set <span class='op'>=</span> <span class='fl'>11</span><span class='op'>:</span><span class='fl'>30</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          focal_group n_matched_set n_suspect_set  beta    SE    X2 df   p
#&gt; SIBTEST        focal             5            20 0.166 0.197 0.708  1 0.4
#&gt; CSIBTEST       focal             5            20 0.166    NA 0.708  1 0.4</div><div class='input'>
<span class='co'># DTF</span>
<span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, suspect_set <span class='op'>=</span> <span class='fl'>11</span><span class='op'>:</span><span class='fl'>30</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          focal_group n_matched_set n_suspect_set  beta    SE    X2 df    p
#&gt; SIBTEST        focal            10            20 0.053 0.165 0.102  1 0.75
#&gt; CSIBTEST       focal            10            20 0.053    NA 0.102  1 0.75</div><div class='input'><span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, match_set <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span> <span class='co'>#equivalent</span>
</div><div class='output co'>#&gt;          focal_group n_matched_set n_suspect_set  beta    SE    X2 df    p
#&gt; SIBTEST        focal            10            20 0.053 0.165 0.102  1 0.75
#&gt; CSIBTEST       focal            10            20 0.053    NA 0.102  1 0.75</div><div class='input'>
<span class='co'># different hyper pars</span>
<span class='va'>dat1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='va'>N</span>, itemtype <span class='op'>=</span> <span class='st'>'dich'</span><span class='op'>)</span>
<span class='va'>dat2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='va'>N</span><span class='op'>*</span><span class='fl'>2</span>, itemtype <span class='op'>=</span> <span class='st'>'dich'</span>, mu <span class='op'>=</span> <span class='fl'>.5</span>, sigma <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>1.5</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>dat1</span>, <span class='va'>dat2</span><span class='op'>)</span>
<span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, <span class='fl'>6</span><span class='op'>:</span><span class='fl'>30</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          focal_group n_matched_set n_suspect_set   beta    SE    X2 df     p
#&gt; SIBTEST        focal             5            25 -0.232 0.249 0.869  1 0.351
#&gt; CSIBTEST       focal             5            25  0.218    NA 0.981  2 0.612</div><div class='input'><span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, <span class='fl'>11</span><span class='op'>:</span><span class='fl'>30</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          focal_group n_matched_set n_suspect_set   beta    SE    X2 df     p
#&gt; SIBTEST        focal            10            20 -0.065 0.174 0.138  1 0.711
#&gt; CSIBTEST       focal            10            20  0.065    NA 0.437  2 0.804</div><div class='input'>
<span class='co'># DIF testing with anchors 1 through 5</span>
<span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, <span class='fl'>6</span>, match_set <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          focal_group n_matched_set n_suspect_set  beta    SE    X2 df     p
#&gt; SIBTEST        focal             5             1 0.032 0.027 1.415  1 0.234
#&gt; CSIBTEST       focal             5             1 0.032    NA 1.415  1 0.234</div><div class='input'><span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, <span class='fl'>7</span>, match_set <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          focal_group n_matched_set n_suspect_set   beta    SE    X2 df     p
#&gt; SIBTEST        focal             5             1 -0.016 0.028 0.314  1 0.575
#&gt; CSIBTEST       focal             5             1  0.016    NA 0.314  1 0.575</div><div class='input'><span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, <span class='fl'>8</span>, match_set <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          focal_group n_matched_set n_suspect_set   beta    SE    X2 df     p
#&gt; SIBTEST        focal             5             1 -0.064 0.028 5.092  1 0.024
#&gt; CSIBTEST       focal             5             1  0.064    NA 5.092  1 0.024</div><div class='input'>
<span class='co'># DIF testing with all other items as anchors</span>
<span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, <span class='fl'>6</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          focal_group n_matched_set n_suspect_set  beta    SE    X2 df     p
#&gt; SIBTEST        focal            29             1 0.041 0.027 2.335  1 0.127
#&gt; CSIBTEST       focal            29             1 0.041    NA 2.335  1 0.127</div><div class='input'><span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, <span class='fl'>7</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          focal_group n_matched_set n_suspect_set   beta    SE    X2 df     p
#&gt; SIBTEST        focal            29             1 -0.001 0.028 0.001  1 0.978
#&gt; CSIBTEST       focal            29             1  0.001    NA 0.006  2 0.997</div><div class='input'><span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, <span class='fl'>8</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          focal_group n_matched_set n_suspect_set  beta    SE    X2 df     p
#&gt; SIBTEST        focal            29             1 -0.05 0.029 2.954  1 0.086
#&gt; CSIBTEST       focal            29             1  0.05    NA 2.954  1 0.086</div><div class='input'>
<span class='co'>## -------------</span>
<span class='co'>## systematic differing slopes and intercepts (clear DTF)</span>
<span class='va'>dat1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='va'>N</span>, itemtype <span class='op'>=</span> <span class='st'>'dich'</span><span class='op'>)</span>
<span class='va'>dat2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='fl'>15</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>-</span><span class='fl'>15</span>, <span class='fl'>1</span>, <span class='fl'>.25</span><span class='op'>)</span><span class='op'>)</span>, <span class='va'>d</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='fl'>15</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>-</span><span class='fl'>15</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>,
  <span class='va'>N</span><span class='op'>*</span><span class='fl'>2</span>, itemtype <span class='op'>=</span> <span class='st'>'dich'</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>dat1</span>, <span class='va'>dat2</span><span class='op'>)</span>
<span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, <span class='fl'>6</span><span class='op'>:</span><span class='fl'>30</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          focal_group n_matched_set n_suspect_set   beta    SE      X2 df p
#&gt; SIBTEST        focal             5            25 -3.129 0.254 151.847  1 0
#&gt; CSIBTEST       focal             5            25  3.129    NA 151.847  1 0</div><div class='input'><span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, <span class='fl'>11</span><span class='op'>:</span><span class='fl'>30</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          focal_group n_matched_set n_suspect_set   beta    SE      X2 df p
#&gt; SIBTEST        focal            10            20 -2.808 0.168 277.707  1 0
#&gt; CSIBTEST       focal            10            20  2.808    NA 277.707  1 0</div><div class='input'>
<span class='co'># Some plots depicting the above tests</span>
<span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, suspect_set <span class='op'>=</span> <span class='fl'>11</span><span class='op'>:</span><span class='fl'>30</span>, plot <span class='op'>=</span> <span class='st'>'observed'</span><span class='op'>)</span>
</div><div class='img'><img src='SIBTEST-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, suspect_set <span class='op'>=</span> <span class='fl'>11</span><span class='op'>:</span><span class='fl'>30</span>, plot <span class='op'>=</span> <span class='st'>'weights'</span><span class='op'>)</span>
</div><div class='img'><img src='SIBTEST-5.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, suspect_set <span class='op'>=</span> <span class='fl'>11</span><span class='op'>:</span><span class='fl'>30</span>, plot <span class='op'>=</span> <span class='st'>'wdifference'</span><span class='op'>)</span>
</div><div class='img'><img src='SIBTEST-6.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># DIF testing using valid anchors</span>
<span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, suspect_set <span class='op'>=</span> <span class='fl'>6</span>, match_set <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          focal_group n_matched_set n_suspect_set  beta    SE    X2 df     p
#&gt; SIBTEST        focal             5             1 0.006 0.027 0.055  1 0.814
#&gt; CSIBTEST       focal             5             1 0.006    NA 0.055  1 0.814</div><div class='input'><span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, suspect_set <span class='op'>=</span> <span class='fl'>7</span>, match_set <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          focal_group n_matched_set n_suspect_set  beta    SE    X2 df     p
#&gt; SIBTEST        focal             5             1 0.002 0.028 0.005  1 0.943
#&gt; CSIBTEST       focal             5             1 0.050    NA 3.359  2 0.186</div><div class='input'><span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, suspect_set <span class='op'>=</span> <span class='fl'>30</span>, match_set <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          focal_group n_matched_set n_suspect_set   beta    SE     X2 df p
#&gt; SIBTEST        focal             5             1 -0.133 0.026 25.537  1 0
#&gt; CSIBTEST       focal             5             1  0.133    NA 25.537  1 0</div><div class='input'>
<span class='co'># randomization method is fairly poor when smaller matched-set used</span>
<span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, suspect_set <span class='op'>=</span> <span class='fl'>30</span>, match_set <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>, LiStout1996<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                     focal_group n_matched_set n_suspect_set   beta    SE     X2
#&gt; SIBTEST                   focal             5             1 -0.133 0.026 25.537
#&gt; CSIBTEST                  focal             5             1  0.133    NA 25.537
#&gt; CSIBTEST_randomized       focal             5             1  0.133 0.026 25.537
#&gt;                     df     p
#&gt; SIBTEST              1 0.000
#&gt; CSIBTEST             1 0.000
#&gt; CSIBTEST_randomized NA 0.125</div><div class='input'><span class='fu'>SIBTEST</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>group</span>, suspect_set <span class='op'>=</span> <span class='fl'>30</span>, LiStout1996<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                     focal_group n_matched_set n_suspect_set  beta    SE    X2
#&gt; SIBTEST                   focal            29             1 0.028 0.031 0.800
#&gt; CSIBTEST                  focal            29             1 0.029    NA 1.172
#&gt; CSIBTEST_randomized       focal            29             1 0.030 0.029 1.054
#&gt;                     df     p
#&gt; SIBTEST              1 0.371
#&gt; CSIBTEST             2 0.556
#&gt; CSIBTEST_randomized NA 0.319</div><div class='input'>
<span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


