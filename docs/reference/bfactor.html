<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Full-Information Item Bi-factor and Two-Tier Analysis — bfactor • mirt</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Full-Information Item Bi-factor and Two-Tier Analysis — bfactor" />
<meta property="og:description" content="bfactor fits a confirmatory maximum likelihood two-tier/bifactor/testlet model to
dichotomous and polytomous data under the item response theory paradigm.
The IRT models are fit using a dimensional reduction EM algorithm so that regardless
of the number of specific factors estimated the model only uses the number of
factors in the second-tier structure plus 1. For the bifactor model the maximum
number of dimensions is only 2 since the second-tier only consists of a
ubiquitous unidimensional factor. See mirt for appropriate methods to be used
on the objects returned from the estimation." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mirt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.32.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mirt-vignettes.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/philchalmers/mirt/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Full-Information Item Bi-factor and Two-Tier Analysis</h1>
    <small class="dont-index">Source: <a href='https://github.com/philchalmers/mirt/blob/master/R/bfactor.R'><code>R/bfactor.R</code></a></small>
    <div class="hidden name"><code>bfactor.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>bfactor</code> fits a confirmatory maximum likelihood two-tier/bifactor/testlet model to
dichotomous and polytomous data under the item response theory paradigm.
The IRT models are fit using a dimensional reduction EM algorithm so that regardless
of the number of specific factors estimated the model only uses the number of
factors in the second-tier structure plus 1. For the bifactor model the maximum
number of dimensions is only 2 since the second-tier only consists of a
ubiquitous unidimensional factor. See <code><a href='mirt.html'>mirt</a></code> for appropriate methods to be used
on the objects returned from the estimation.</p>
    </div>

    <pre class="usage"><span class='fu'>bfactor</span><span class='op'>(</span>
  <span class='va'>data</span>,
  <span class='va'>model</span>,
  model2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"G = 1-"</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span><span class='op'>)</span>,
  group <span class='op'>=</span> <span class='cn'>NULL</span>,
  quadpts <span class='op'>=</span> <span class='cn'>NULL</span>,
  invariance <span class='op'>=</span> <span class='st'>""</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>a <code>matrix</code> or <code>data.frame</code> that consists of
numerically ordered data, with missing data coded as <code>NA</code></p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>a numeric vector specifying which factor loads on which
item. For example, if for a 4 item test with two specific factors, the first
specific factor loads on the first two items and the second specific factor
on the last two, then the vector is <code><a href='https://rdrr.io/r/base/c.html'>c(1,1,2,2)</a></code>. For items that should only load
on the second-tier factors (have no specific component) <code>NA</code> values may
be used as place-holders. These numbers will be translated into a format suitable for
<code><a href='mirt.model.html'>mirt.model()</a></code>, combined with the definition in <code>model2</code>, with the letter 'S'
added to the respective factor number</p></td>
    </tr>
    <tr>
      <th>model2</th>
      <td><p>a two-tier model specification object defined by <code><a href='mirt.model.html'>mirt.model()</a></code> or
a string to be passed to <code><a href='mirt.model.html'>mirt.model</a></code>. By default
the model will fit a unidimensional model in the second-tier, and therefore be equivalent to
the bifactor model</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>a factor variable indicating group membership used for multiple group analyses</p></td>
    </tr>
    <tr>
      <th>quadpts</th>
      <td><p>number of quadrature nodes to use after accounting for the reduced number of dimensions.
Scheme is the same as the one used in <code><a href='mirt.html'>mirt</a></code>, however it is in regards to the reduced
dimensions (e.g., a bifactor model has 2 dimensions to be integrated)</p></td>
    </tr>
    <tr>
      <th>invariance</th>
      <td><p>see <code><a href='multipleGroup.html'>multipleGroup</a></code> for details, however, the specific factor variances
and means will be constrained according to the dimensional reduction algorithm</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments to be passed to the estimation engine. See <code><a href='mirt.html'>mirt</a></code>
for more details and examples</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>function returns an object of class <code>SingleGroupClass</code>
  (<a href='SingleGroupClass-class.html'>SingleGroupClass-class</a>) or <code>MultipleGroupClass</code>(<a href='MultipleGroupClass-class.html'>MultipleGroupClass-class</a>).</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>bfactor</code> follows the item factor analysis strategy explicated by
Gibbons and Hedeker (1992), Gibbons et al. (2007), and Cai (2010).
Nested models may be compared via an approximate
chi-squared difference test or by a reduction in AIC or BIC (accessible via
<code><a href='https://rdrr.io/r/stats/anova.html'>anova</a></code>). See <code><a href='mirt.html'>mirt</a></code> for more details regarding the
IRT estimation approach used in this package.</p>
<p>The two-tier model has a specific block diagonal covariance structure between the primary and
secondary latent traits. Namely, the secondary latent traits are assumed to be orthogonal to
all traits and have a fixed variance of 1, while the primary traits can be organized to vary
and covary with other primary traits in the model.</p>
<p>$$\Sigma_{two-tier} = \left(\begin{array}{cc} G &amp; 0 \\ 0 &amp; diag(S) \end{array} \right)$$</p>
<p>The bifactor model is a special case of the two-tier model when \(G\) above is a 1x1 matrix,
and therefore only 1 primary factor is being modeled. Evaluation of the numerical integrals
for the two-tier model requires only \(ncol(G) + 1\) dimensions for integration since the
\(S\) second order (or 'specific') factors require only 1 integration grid due to the
dimension reduction technique.</p>
<p>Note: for multiple group two-tier analyses only the second-tier means and variances
should be freed since the specific factors are not treated independently due to the
dimension reduction technique.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Cai, L. (2010). A two-tier full-information item factor analysis model with applications.
<em>Psychometrika, 75</em>, 581-612.</p>
<p>Chalmers, R., P. (2012). mirt: A Multidimensional Item Response Theory
Package for the R Environment. <em>Journal of Statistical Software, 48</em>(6), 1-29.
doi: <a href='https://doi.org/10.18637/jss.v048.i06'>10.18637/jss.v048.i06</a></p>
<p>Gibbons, R. D., &amp; Hedeker, D. R. (1992). Full-information Item Bi-Factor
Analysis. <em>Psychometrika, 57</em>, 423-436.</p>
<p>Gibbons, R. D., Darrell, R. B., Hedeker, D., Weiss, D. J., Segawa, E., Bhaumik, D. K.,
Kupfer, D. J., Frank, E., Grochocinski, V. J., &amp; Stover, A. (2007).
Full-Information item bifactor analysis of graded response data.
<em>Applied Psychological Measurement, 31</em>, 4-19.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='mirt.html'>mirt</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Phil Chalmers <a href='mailto:rphilip.chalmers@gmail.com'>rphilip.chalmers@gmail.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># \donttest{</span>

<span class='co'>###load SAT12 and compute bifactor model with 3 specific factors</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>SAT12</span><span class='op'>)</span>
<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='key2binary.html'>key2binary</a></span><span class='op'>(</span><span class='va'>SAT12</span>,
  key <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>4</span>,<span class='fl'>5</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>4</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>5</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>4</span>,<span class='fl'>1</span>,<span class='fl'>4</span>,<span class='fl'>3</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>1</span>,<span class='fl'>3</span>,<span class='fl'>5</span>,<span class='fl'>1</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>5</span>,<span class='fl'>4</span>,<span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>specific</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>3</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>3</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>3</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>3</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span>
<span class='va'>mod1</span> <span class='op'>&lt;-</span> <span class='fu'>bfactor</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>specific</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>mod1</span><span class='op'>)</span>
</div><div class='output co'>#&gt;              G      S1      S2      S3      h2
#&gt; Item.1  0.4078  0.0000  0.2273  0.0000 0.21799
#&gt; Item.2  0.6195  0.0000  0.0000  0.3391 0.49881
#&gt; Item.3  0.5573  0.0000 -0.0744  0.0000 0.31612
#&gt; Item.4  0.2808  0.0000  0.0000  0.3101 0.17503
#&gt; Item.5  0.4779  0.0000  0.0000  0.2544 0.29311
#&gt; Item.6  0.5341  0.0000  0.2724  0.0000 0.35948
#&gt; Item.7  0.4741  0.4210  0.0000  0.0000 0.40199
#&gt; Item.8  0.3537  0.0000  0.2732  0.0000 0.19971
#&gt; Item.9  0.2181  0.5321  0.0000  0.0000 0.33068
#&gt; Item.10 0.4849  0.3792  0.0000  0.0000 0.37895
#&gt; Item.11 0.6442  0.3321  0.0000  0.0000 0.52536
#&gt; Item.12 0.0699  0.0000  0.0000  0.1592 0.03023
#&gt; Item.13 0.5219  0.2743  0.0000  0.0000 0.34764
#&gt; Item.14 0.4791  0.0000  0.0000  0.4563 0.43776
#&gt; Item.15 0.5985  0.2402  0.0000  0.0000 0.41590
#&gt; Item.16 0.3885  0.0000  0.2049  0.0000 0.19292
#&gt; Item.17 0.6636  0.1177  0.0000  0.0000 0.45423
#&gt; Item.18 0.7163  0.0775  0.0000  0.0000 0.51903
#&gt; Item.19 0.4520  0.0000  0.0000  0.0198 0.20466
#&gt; Item.20 0.6578  0.0000  0.0000  0.1792 0.46478
#&gt; Item.21 0.2806  0.3451  0.0000  0.0000 0.19787
#&gt; Item.22 0.7025 -0.0281  0.0000  0.0000 0.49425
#&gt; Item.23 0.3236  0.0000  0.0000  0.2657 0.17536
#&gt; Item.24 0.5848  0.1030  0.0000  0.0000 0.35266
#&gt; Item.25 0.3732  0.0000  0.0000  0.3297 0.24799
#&gt; Item.26 0.6430  0.0000  0.0000  0.2124 0.45854
#&gt; Item.27 0.7374  0.1554  0.0000  0.0000 0.56792
#&gt; Item.28 0.5256  0.0000  0.0000  0.0758 0.28199
#&gt; Item.29 0.4185  0.0000  0.7071  0.0000 0.67516
#&gt; Item.30 0.2455  0.0000  0.0000 -0.0959 0.06946
#&gt; Item.31 0.8333 -0.0872  0.0000  0.0000 0.70202
#&gt; Item.32 0.0780  0.0000  0.0165  0.0000 0.00635
#&gt; 
#&gt; SS loadings:  8.435 1.03 0.748 0.781 
#&gt; Proportion Var:  0.264 0.032 0.023 0.024 
#&gt; 
#&gt; Factor correlations: 
#&gt; 
#&gt;    G S1 S2 S3
#&gt; G  1  0  0  0
#&gt; S1 0  1  0  0
#&gt; S2 0  0  1  0
#&gt; S3 0  0  0  1</div><div class='input'><span class='fu'><a href='itemplot.html'>itemplot</a></span><span class='op'>(</span><span class='va'>mod1</span>, <span class='fl'>18</span>, drop.zeros <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='co'>#drop the zero slopes to allow plotting</span>
</div><div class='img'><img src='bfactor-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>###Try with fixed guessing parameters added</span>
<span class='va'>guess</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>.1</span>,<span class='fl'>32</span><span class='op'>)</span>
<span class='va'>mod2</span> <span class='op'>&lt;-</span> <span class='fu'>bfactor</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>specific</span>, guess <span class='op'>=</span> <span class='va'>guess</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>mod2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $Item.1
#&gt;        a1 a2    a3 a4      d   g u
#&gt; par 1.225  0 0.624  0 -1.822 0.1 1
#&gt; 
#&gt; $Item.2
#&gt;        a1 a2 a3    a4     d   g u
#&gt; par 1.721  0  0 0.954 0.171 0.1 1
#&gt; 
#&gt; $Item.3
#&gt;        a1 a2     a3 a4      d   g u
#&gt; par 2.415  0 -0.459  0 -2.602 0.1 1
#&gt; 
#&gt; $Item.4
#&gt;        a1 a2 a3    a4      d   g u
#&gt; par 0.745  0  0 0.695 -0.989 0.1 1
#&gt; 
#&gt; $Item.5
#&gt;        a1 a2 a3    a4     d   g u
#&gt; par 1.048  0  0 0.603 0.419 0.1 1
#&gt; 
#&gt; $Item.6
#&gt;       a1 a2    a3 a4      d   g u
#&gt; par 3.06  0 0.501  0 -5.002 0.1 1
#&gt; 
#&gt; $Item.7
#&gt;        a1    a2 a3 a4     d   g u
#&gt; par 1.121 0.839  0  0 1.373 0.1 1
#&gt; 
#&gt; $Item.8
#&gt;        a1 a2    a3 a4      d   g u
#&gt; par 1.956  0 1.443  0 -3.772 0.1 1
#&gt; 
#&gt; $Item.9
#&gt;        a1    a2 a3 a4     d   g u
#&gt; par 0.512 1.236  0  0 2.484 0.1 1
#&gt; 
#&gt; $Item.10
#&gt;       a1    a2 a3 a4      d   g u
#&gt; par 1.68 1.506  0  0 -1.031 0.1 1
#&gt; 
#&gt; $Item.11
#&gt;        a1    a2 a3 a4     d   g u
#&gt; par 1.655 0.842  0  0 5.441 0.1 1
#&gt; 
#&gt; $Item.12
#&gt;        a1 a2 a3    a4      d   g u
#&gt; par 0.129  0  0 0.364 -0.641 0.1 1
#&gt; 
#&gt; $Item.13
#&gt;        a1    a2 a3 a4     d   g u
#&gt; par 1.183 0.477  0  0 0.679 0.1 1
#&gt; 
#&gt; $Item.14
#&gt;        a1 a2 a3    a4     d   g u
#&gt; par 1.125  0  0 1.058 1.164 0.1 1
#&gt; 
#&gt; $Item.15
#&gt;        a1    a2 a3 a4     d   g u
#&gt; par 1.435 0.317  0  0 1.863 0.1 1
#&gt; 
#&gt; $Item.16
#&gt;       a1 a2    a3 a4      d   g u
#&gt; par 0.95  0 0.573  0 -0.783 0.1 1
#&gt; 
#&gt; $Item.17
#&gt;        a1    a2 a3 a4     d   g u
#&gt; par 1.547 0.059  0  0 4.112 0.1 1
#&gt; 
#&gt; $Item.18
#&gt;        a1    a2 a3 a4      d   g u
#&gt; par 2.731 0.094  0  0 -1.808 0.1 1
#&gt; 
#&gt; $Item.19
#&gt;        a1 a2 a3    a4      d   g u
#&gt; par 0.918  0  0 0.101 -0.001 0.1 1
#&gt; 
#&gt; $Item.20
#&gt;        a1 a2 a3    a4     d   g u
#&gt; par 1.456  0  0 0.593 2.501 0.1 1
#&gt; 
#&gt; $Item.21
#&gt;        a1    a2 a3 a4    d   g u
#&gt; par 0.596 0.493  0  0 2.49 0.1 1
#&gt; 
#&gt; $Item.22
#&gt;        a1     a2 a3 a4     d   g u
#&gt; par 1.554 -0.242  0  0 3.428 0.1 1
#&gt; 
#&gt; $Item.23
#&gt;        a1 a2 a3    a4      d   g u
#&gt; par 0.908  0  0 0.766 -1.488 0.1 1
#&gt; 
#&gt; $Item.24
#&gt;        a1    a2 a3 a4     d   g u
#&gt; par 1.379 0.001  0  0 1.132 0.1 1
#&gt; 
#&gt; $Item.25
#&gt;       a1 a2 a3    a4      d   g u
#&gt; par 1.03  0  0 1.094 -1.164 0.1 1
#&gt; 
#&gt; $Item.26
#&gt;        a1 a2 a3    a4      d   g u
#&gt; par 1.985  0  0 0.747 -0.663 0.1 1
#&gt; 
#&gt; $Item.27
#&gt;        a1    a2 a3 a4     d   g u
#&gt; par 1.909 0.348  0  0 2.642 0.1 1
#&gt; 
#&gt; $Item.28
#&gt;        a1 a2 a3    a4      d   g u
#&gt; par 1.213  0  0 0.142 -0.097 0.1 1
#&gt; 
#&gt; $Item.29
#&gt;        a1 a2    a3 a4      d   g u
#&gt; par 1.938  0 2.339  0 -2.209 0.1 1
#&gt; 
#&gt; $Item.30
#&gt;        a1 a2 a3     a4      d   g u
#&gt; par 0.479  0  0 -0.128 -0.527 0.1 1
#&gt; 
#&gt; $Item.31
#&gt;        a1    a2 a3 a4     d   g u
#&gt; par 3.173 -0.82  0  0 3.316 0.1 1
#&gt; 
#&gt; $Item.32
#&gt;        a1 a2     a3 a4      d   g u
#&gt; par 0.534  0 -0.053  0 -2.786 0.1 1
#&gt; 
#&gt; $GroupPars
#&gt;     MEAN_1 MEAN_2 MEAN_3 MEAN_4 COV_11 COV_21 COV_31 COV_41 COV_22 COV_32
#&gt; par      0      0      0      0      1      0      0      0      1      0
#&gt;     COV_42 COV_33 COV_43 COV_44
#&gt; par      0      1      0      1
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>mod1</span>, <span class='va'>mod2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Model 1: bfactor(data = data, model = specific)
#&gt; Model 2: bfactor(data = data, model = specific, guess = guess)
#&gt; </div><div class='output co'>#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik     X2  df   p
#&gt; 1 19062.10 19099.13 19179.44 19226.42 19484.21 -9435.052    NaN NaN NaN
#&gt; 2 19009.55 19046.58 19126.88 19173.87 19431.65 -9408.775 52.553   0   0</div><div class='input'>
<span class='co'>## don't estimate specific factor for item 32</span>
<span class='va'>specific</span><span class='op'>[</span><span class='fl'>32</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
<span class='va'>mod3</span> <span class='op'>&lt;-</span> <span class='fu'>bfactor</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>specific</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>mod1</span>, <span class='va'>mod3</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Model 1: bfactor(data = data, model = specific)
#&gt; Model 2: bfactor(data = data, model = specific)
#&gt; </div><div class='output co'>#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik   X2  df     p
#&gt; 1 19060.12 19096.31 19176.23 19222.73 19477.83 -9435.062  NaN NaN   NaN
#&gt; 2 19062.10 19099.13 19179.44 19226.42 19484.21 -9435.052 0.02   1 0.886</div><div class='input'>
<span class='co'># same, but declared manually (not run)</span>
<span class='co'>#sv &lt;- mod2values(mod1)</span>
<span class='co'>#sv$value[220] &lt;- 0 #parameter 220 is the 32 items specific slope</span>
<span class='co'>#sv$est[220] &lt;- FALSE</span>
<span class='co'>#mod3 &lt;- bfactor(data, specific, pars = sv) #with excellent starting values</span>


<span class='co'>#########</span>
<span class='co'># mixed itemtype example</span>

<span class='co'>#simulate data</span>
<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
<span class='fl'>1</span>,<span class='fl'>0.5</span>,<span class='cn'>NA</span>,
<span class='fl'>1</span>,<span class='fl'>0.5</span>,<span class='cn'>NA</span>,
<span class='fl'>1</span>,<span class='fl'>0.5</span>,<span class='cn'>NA</span>,
<span class='fl'>1</span>,<span class='fl'>0.5</span>,<span class='cn'>NA</span>,
<span class='fl'>1</span>,<span class='fl'>0.5</span>,<span class='cn'>NA</span>,
<span class='fl'>1</span>,<span class='fl'>0.5</span>,<span class='cn'>NA</span>,
<span class='fl'>1</span>,<span class='fl'>0.5</span>,<span class='cn'>NA</span>,
<span class='fl'>1</span>,<span class='cn'>NA</span>,<span class='fl'>0.5</span>,
<span class='fl'>1</span>,<span class='cn'>NA</span>,<span class='fl'>0.5</span>,
<span class='fl'>1</span>,<span class='cn'>NA</span>,<span class='fl'>0.5</span>,
<span class='fl'>1</span>,<span class='cn'>NA</span>,<span class='fl'>0.5</span>,
<span class='fl'>1</span>,<span class='cn'>NA</span>,<span class='fl'>0.5</span>,
<span class='fl'>1</span>,<span class='cn'>NA</span>,<span class='fl'>0.5</span>,
<span class='fl'>1</span>,<span class='cn'>NA</span>,<span class='fl'>0.5</span><span class='op'>)</span>,ncol<span class='op'>=</span><span class='fl'>3</span>,byrow<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
<span class='op'>-</span><span class='fl'>1.0</span>,<span class='cn'>NA</span>,<span class='cn'>NA</span>,
<span class='op'>-</span><span class='fl'>1.5</span>,<span class='cn'>NA</span>,<span class='cn'>NA</span>,
 <span class='fl'>1.5</span>,<span class='cn'>NA</span>,<span class='cn'>NA</span>,
 <span class='fl'>0.0</span>,<span class='cn'>NA</span>,<span class='cn'>NA</span>,
<span class='fl'>2.5</span>,<span class='fl'>1.0</span>,<span class='op'>-</span><span class='fl'>1</span>,
<span class='fl'>3.0</span>,<span class='fl'>2.0</span>,<span class='op'>-</span><span class='fl'>0.5</span>,
<span class='fl'>3.0</span>,<span class='fl'>2.0</span>,<span class='op'>-</span><span class='fl'>0.5</span>,
<span class='fl'>3.0</span>,<span class='fl'>2.0</span>,<span class='op'>-</span><span class='fl'>0.5</span>,
<span class='fl'>2.5</span>,<span class='fl'>1.0</span>,<span class='op'>-</span><span class='fl'>1</span>,
<span class='fl'>2.0</span>,<span class='fl'>0.0</span>,<span class='cn'>NA</span>,
<span class='op'>-</span><span class='fl'>1.0</span>,<span class='cn'>NA</span>,<span class='cn'>NA</span>,
<span class='op'>-</span><span class='fl'>1.5</span>,<span class='cn'>NA</span>,<span class='cn'>NA</span>,
 <span class='fl'>1.5</span>,<span class='cn'>NA</span>,<span class='cn'>NA</span>,
 <span class='fl'>0.0</span>,<span class='cn'>NA</span>,<span class='cn'>NA</span><span class='op'>)</span>,ncol<span class='op'>=</span><span class='fl'>3</span>,byrow<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>items</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'2PL'</span>, <span class='fl'>14</span><span class='op'>)</span>
<span class='va'>items</span><span class='op'>[</span><span class='fl'>5</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>'graded'</span>

<span class='va'>sigma</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span>
<span class='va'>dataset</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>,<span class='va'>d</span>,<span class='fl'>2000</span>,itemtype<span class='op'>=</span><span class='va'>items</span>,sigma<span class='op'>=</span><span class='va'>sigma</span><span class='op'>)</span>

<span class='va'>specific</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>7</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>7</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>simmod</span> <span class='op'>&lt;-</span> <span class='fu'>bfactor</span><span class='op'>(</span><span class='va'>dataset</span>, <span class='va'>specific</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>EM cycles terminated after 500 iterations.</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>simmod</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $Item_1
#&gt;        a1    a2 a3      d g u
#&gt; par 1.737 2.214  0 -1.731 0 1
#&gt; 
#&gt; $Item_2
#&gt;        a1    a2 a3      d g u
#&gt; par 1.012 0.292  0 -1.404 0 1
#&gt; 
#&gt; $Item_3
#&gt;        a1    a2 a3     d g u
#&gt; par 0.982 0.325  0 1.546 0 1
#&gt; 
#&gt; $Item_4
#&gt;       a1     a2 a3      d g u
#&gt; par 1.06 -0.084  0 -0.028 0 1
#&gt; 
#&gt; $Item_5
#&gt;      a1    a2 a3    d1   d2     d3
#&gt; par 1.1 0.055  0 2.496 0.99 -1.008
#&gt; 
#&gt; $Item_6
#&gt;        a1    a2 a3    d1    d2     d3
#&gt; par 1.118 0.016  0 2.974 1.986 -0.515
#&gt; 
#&gt; $Item_7
#&gt;        a1    a2 a3    d1    d2     d3
#&gt; par 1.113 0.103  0 2.846 1.885 -0.575
#&gt; 
#&gt; $Item_8
#&gt;        a1 a2    a3    d1   d2     d3
#&gt; par 0.941  0 0.803 2.997 1.98 -0.519
#&gt; 
#&gt; $Item_9
#&gt;        a1 a2    a3    d1    d2     d3
#&gt; par 0.869  0 0.522 2.342 0.951 -1.026
#&gt; 
#&gt; $Item_10
#&gt;        a1 a2    a3    d1    d2
#&gt; par 0.817  0 0.477 1.826 0.017
#&gt; 
#&gt; $Item_11
#&gt;        a1 a2    a3      d g u
#&gt; par 0.853  0 0.759 -1.062 0 1
#&gt; 
#&gt; $Item_12
#&gt;        a1 a2    a3      d g u
#&gt; par 0.748  0 0.729 -1.602 0 1
#&gt; 
#&gt; $Item_13
#&gt;        a1 a2    a3     d g u
#&gt; par 0.887  0 0.836 1.713 0 1
#&gt; 
#&gt; $Item_14
#&gt;        a1 a2    a3    d g u
#&gt; par 0.842  0 0.813 0.01 0 1
#&gt; 
#&gt; $GroupPars
#&gt;     MEAN_1 MEAN_2 MEAN_3 COV_11 COV_21 COV_31 COV_22 COV_32 COV_33
#&gt; par      0      0      0      1      0      0      1      0      1
#&gt; </div><div class='input'>
<span class='co'>#########</span>
<span class='co'># testlet response model</span>

<span class='co'>#simulate data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span>
<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>12</span>, <span class='fl'>4</span><span class='op'>)</span>
<span class='va'>a</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Lognormal.html'>rlnorm</a></span><span class='op'>(</span><span class='fl'>12</span>, <span class='fl'>.2</span>, <span class='fl'>.3</span><span class='op'>)</span>
<span class='va'>ind</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>{</span>
   <span class='va'>a</span><span class='op'>[</span><span class='va'>ind</span><span class='op'>:</span><span class='op'>(</span><span class='va'>ind</span><span class='op'>+</span><span class='fl'>3</span><span class='op'>)</span>,<span class='va'>i</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>a</span><span class='op'>[</span><span class='va'>ind</span><span class='op'>:</span><span class='op'>(</span><span class='va'>ind</span><span class='op'>+</span><span class='fl'>3</span><span class='op'>)</span>,<span class='fl'>1</span><span class='op'>]</span>
   <span class='va'>ind</span> <span class='op'>&lt;-</span> <span class='va'>ind</span><span class='op'>+</span><span class='fl'>4</span>
<span class='op'>}</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>a</span><span class='op'>)</span>
</div><div class='output co'>#&gt;            [,1]      [,2]     [,3]      [,4]
#&gt;  [1,] 0.8503394 0.8503394 0.000000 0.0000000
#&gt;  [2,] 1.3274088 1.3274088 0.000000 0.0000000
#&gt;  [3,] 1.6910208 1.6910208 0.000000 0.0000000
#&gt;  [4,] 0.6042850 0.6042850 0.000000 0.0000000
#&gt;  [5,] 1.3892130 0.0000000 1.389213 0.0000000
#&gt;  [6,] 1.4216480 0.0000000 1.421648 0.0000000
#&gt;  [7,] 1.0279618 0.0000000 1.027962 0.0000000
#&gt;  [8,] 1.0366667 0.0000000 1.036667 0.0000000
#&gt;  [9,] 1.0311394 0.0000000 0.000000 1.0311394
#&gt; [10,] 0.9351846 0.0000000 0.000000 0.9351846
#&gt; [11,] 1.0584888 0.0000000 0.000000 1.0584888
#&gt; [12,] 0.9052755 0.0000000 0.000000 0.9052755</div><div class='input'><span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>12</span>, <span class='fl'>0</span>, <span class='fl'>.5</span><span class='op'>)</span>
<span class='va'>sigma</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>.5</span>, <span class='fl'>1</span>, <span class='fl'>.5</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dataset</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>,<span class='va'>d</span>,<span class='fl'>2000</span>,itemtype<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'2PL'</span>, <span class='fl'>12</span><span class='op'>)</span>,sigma<span class='op'>=</span><span class='va'>sigma</span><span class='op'>)</span>

<span class='co'># estimate by applying constraints and freeing the latent variances</span>
<span class='va'>specific</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>4</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>4</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>model</span> <span class='op'>&lt;-</span> <span class='st'>"G = 1-12
          CONSTRAIN = (1, a1, a2), (2, a1, a2), (3, a1, a2), (4, a1, a2),
            (5, a1, a3), (6, a1, a3), (7, a1, a3), (8, a1, a3),
            (9, a1, a4), (10, a1, a4), (11, a1, a4), (12, a1, a4)
          COV = S1*S1, S2*S2, S3*S3"</span>

<span class='va'>simmod</span> <span class='op'>&lt;-</span> <span class='fu'>bfactor</span><span class='op'>(</span><span class='va'>dataset</span>, <span class='va'>specific</span>, <span class='va'>model</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>simmod</span>, simplify<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $items
#&gt;            a1    a2    a3    a4      d g u
#&gt; Item_1  0.794 0.794 0.000 0.000 -0.359 0 1
#&gt; Item_2  1.544 1.544 0.000 0.000  0.011 0 1
#&gt; Item_3  1.762 1.762 0.000 0.000  0.479 0 1
#&gt; Item_4  0.544 0.544 0.000 0.000  0.011 0 1
#&gt; Item_5  1.386 0.000 1.386 0.000 -0.244 0 1
#&gt; Item_6  1.497 0.000 1.497 0.000 -0.449 0 1
#&gt; Item_7  0.853 0.000 0.853 0.000 -0.312 0 1
#&gt; Item_8  0.953 0.000 0.953 0.000  1.101 0 1
#&gt; Item_9  0.981 0.000 0.000 0.981  0.058 0 1
#&gt; Item_10 0.913 0.000 0.000 0.913 -0.217 0 1
#&gt; Item_11 0.868 0.000 0.000 0.868 -0.204 0 1
#&gt; Item_12 0.966 0.000 0.000 0.966  0.206 0 1
#&gt; 
#&gt; $means
#&gt;  G S1 S2 S3 
#&gt;  0  0  0  0 
#&gt; 
#&gt; $cov
#&gt;    G    S1    S2    S3
#&gt; G  1 0.000 0.000 0.000
#&gt; S1 0 0.452 0.000 0.000
#&gt; S2 0 0.000 1.135 0.000
#&gt; S3 0 0.000 0.000 0.432
#&gt; </div><div class='input'>

<span class='co'>#########</span>
<span class='co'># Two-tier model</span>

<span class='co'>#simulate data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span>
<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
  <span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0.5</span>,<span class='cn'>NA</span>,<span class='cn'>NA</span>,
  <span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0.5</span>,<span class='cn'>NA</span>,<span class='cn'>NA</span>,
  <span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0.5</span>,<span class='cn'>NA</span>,<span class='cn'>NA</span>,
  <span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0.5</span>,<span class='cn'>NA</span>,<span class='cn'>NA</span>,
  <span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0.5</span>,<span class='cn'>NA</span>,<span class='cn'>NA</span>,
  <span class='fl'>0</span>,<span class='fl'>1</span>,<span class='cn'>NA</span>,<span class='fl'>0.5</span>,<span class='cn'>NA</span>,
  <span class='fl'>0</span>,<span class='fl'>1</span>,<span class='cn'>NA</span>,<span class='fl'>0.5</span>,<span class='cn'>NA</span>,
  <span class='fl'>0</span>,<span class='fl'>1</span>,<span class='cn'>NA</span>,<span class='fl'>0.5</span>,<span class='cn'>NA</span>,
  <span class='fl'>1</span>,<span class='fl'>0</span>,<span class='cn'>NA</span>,<span class='fl'>0.5</span>,<span class='cn'>NA</span>,
  <span class='fl'>1</span>,<span class='fl'>0</span>,<span class='cn'>NA</span>,<span class='fl'>0.5</span>,<span class='cn'>NA</span>,
  <span class='fl'>1</span>,<span class='fl'>0</span>,<span class='cn'>NA</span>,<span class='fl'>0.5</span>,<span class='cn'>NA</span>,
  <span class='fl'>1</span>,<span class='fl'>0</span>,<span class='cn'>NA</span>,<span class='cn'>NA</span>,<span class='fl'>0.5</span>,
  <span class='fl'>1</span>,<span class='fl'>0</span>,<span class='cn'>NA</span>,<span class='cn'>NA</span>,<span class='fl'>0.5</span>,
  <span class='fl'>1</span>,<span class='fl'>0</span>,<span class='cn'>NA</span>,<span class='cn'>NA</span>,<span class='fl'>0.5</span>,
  <span class='fl'>1</span>,<span class='fl'>0</span>,<span class='cn'>NA</span>,<span class='cn'>NA</span>,<span class='fl'>0.5</span>,
  <span class='fl'>1</span>,<span class='fl'>0</span>,<span class='cn'>NA</span>,<span class='cn'>NA</span>,<span class='fl'>0.5</span><span class='op'>)</span>,ncol<span class='op'>=</span><span class='fl'>5</span>,byrow<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>16</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>items</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'2PL'</span>, <span class='fl'>16</span><span class='op'>)</span>

<span class='va'>sigma</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>5</span><span class='op'>)</span>
<span class='va'>sigma</span><span class='op'>[</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>sigma</span><span class='op'>[</span><span class='fl'>2</span>,<span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>.4</span>
<span class='va'>dataset</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>,<span class='va'>d</span>,<span class='fl'>2000</span>,itemtype<span class='op'>=</span><span class='va'>items</span>,sigma<span class='op'>=</span><span class='va'>sigma</span><span class='op'>)</span>

<span class='va'>specific</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>5</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>6</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>model</span> <span class='op'>&lt;-</span> <span class='st'>'
    G1 = 1-8
    G2 = 9-16
    COV = G1*G2'</span>

<span class='co'>#quadpts dropped for faster estimation, but not as precise</span>
<span class='va'>simmod</span> <span class='op'>&lt;-</span> <span class='fu'>bfactor</span><span class='op'>(</span><span class='va'>dataset</span>, <span class='va'>specific</span>, <span class='va'>model</span>, quadpts <span class='op'>=</span> <span class='fl'>9</span>, TOL <span class='op'>=</span> <span class='fl'>1e-3</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>simmod</span>, simplify<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $items
#&gt;            a1    a2    a3    a4    a5      d g u
#&gt; Item_1  0.965 0.000 0.385 0.000 0.000 -1.100 0 1
#&gt; Item_2  1.076 0.000 0.550 0.000 0.000  0.363 0 1
#&gt; Item_3  0.898 0.000 0.592 0.000 0.000  1.068 0 1
#&gt; Item_4  0.896 0.000 0.710 0.000 0.000 -2.293 0 1
#&gt; Item_5  0.892 0.000 0.848 0.000 0.000  0.526 0 1
#&gt; Item_6  1.013 0.000 0.000 0.413 0.000  0.435 0 1
#&gt; Item_7  1.162 0.000 0.000 0.451 0.000 -0.639 0 1
#&gt; Item_8  0.945 0.000 0.000 0.609 0.000 -0.623 0 1
#&gt; Item_9  0.000 0.831 0.000 0.371 0.000 -0.544 0 1
#&gt; Item_10 0.000 0.925 0.000 0.610 0.000 -0.926 0 1
#&gt; Item_11 0.000 1.142 0.000 0.495 0.000 -0.517 0 1
#&gt; Item_12 0.000 0.978 0.000 0.000 0.634 -0.964 0 1
#&gt; Item_13 0.000 1.108 0.000 0.000 0.437 -0.694 0 1
#&gt; Item_14 0.000 1.004 0.000 0.000 0.321 -0.012 0 1
#&gt; Item_15 0.000 0.916 0.000 0.000 0.758  0.897 0 1
#&gt; Item_16 0.000 1.020 0.000 0.000 0.650 -0.096 0 1
#&gt; 
#&gt; $means
#&gt; G1 G2 S1 S2 S3 
#&gt;  0  0  0  0  0 
#&gt; 
#&gt; $cov
#&gt;       G1    G2 S1 S2 S3
#&gt; G1 1.000 0.412  0  0  0
#&gt; G2 0.412 1.000  0  0  0
#&gt; S1 0.000 0.000  1  0  0
#&gt; S2 0.000 0.000  0  1  0
#&gt; S3 0.000 0.000  0  0  1
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>simmod</span><span class='op'>)</span>
</div><div class='output co'>#&gt;            G1    G2    S1    S2    S3    h2
#&gt; Item_1  0.484 0.000 0.193 0.000 0.000 0.271
#&gt; Item_2  0.516 0.000 0.263 0.000 0.000 0.335
#&gt; Item_3  0.446 0.000 0.294 0.000 0.000 0.285
#&gt; Item_4  0.437 0.000 0.346 0.000 0.000 0.311
#&gt; Item_5  0.425 0.000 0.404 0.000 0.000 0.343
#&gt; Item_6  0.501 0.000 0.000 0.204 0.000 0.293
#&gt; Item_7  0.551 0.000 0.000 0.214 0.000 0.349
#&gt; Item_8  0.463 0.000 0.000 0.299 0.000 0.304
#&gt; Item_9  0.000 0.431 0.000 0.192 0.000 0.222
#&gt; Item_10 0.000 0.456 0.000 0.300 0.000 0.298
#&gt; Item_11 0.000 0.541 0.000 0.235 0.000 0.348
#&gt; Item_12 0.000 0.474 0.000 0.000 0.307 0.319
#&gt; Item_13 0.000 0.533 0.000 0.000 0.210 0.329
#&gt; Item_14 0.000 0.501 0.000 0.000 0.160 0.277
#&gt; Item_15 0.000 0.441 0.000 0.000 0.365 0.328
#&gt; Item_16 0.000 0.488 0.000 0.000 0.311 0.336
#&gt; 
#&gt; SS loadings:  1.839 1.88 0.476 0.359 0.395 
#&gt; Proportion Var:  0.115 0.118 0.03 0.022 0.025 
#&gt; 
#&gt; Factor correlations: 
#&gt; 
#&gt;       G1    G2 S1 S2 S3
#&gt; G1 1.000 0.412  0  0  0
#&gt; G2 0.412 1.000  0  0  0
#&gt; S1 0.000 0.000  1  0  0
#&gt; S2 0.000 0.000  0  1  0
#&gt; S3 0.000 0.000  0  0  1</div><div class='input'><span class='fu'><a href='itemfit.html'>itemfit</a></span><span class='op'>(</span><span class='va'>simmod</span>, QMC<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       item   S_X2 df.S_X2 RMSEA.S_X2 p.S_X2
#&gt; 1   Item_1  6.614       9      0.000  0.677
#&gt; 2   Item_2 13.645      10      0.014  0.190
#&gt; 3   Item_3  8.660       9      0.000  0.469
#&gt; 4   Item_4  8.753      10      0.000  0.556
#&gt; 5   Item_5  7.969      10      0.000  0.632
#&gt; 6   Item_6  4.203      10      0.000  0.938
#&gt; 7   Item_7  9.879      10      0.000  0.451
#&gt; 8   Item_8 15.293      10      0.016  0.122
#&gt; 9   Item_9 17.354      10      0.019  0.067
#&gt; 10 Item_10 12.436      10      0.011  0.257
#&gt; 11 Item_11 14.182      10      0.014  0.165
#&gt; 12 Item_12 13.891       9      0.016  0.126
#&gt; 13 Item_13 10.718      10      0.006  0.380
#&gt; 14 Item_14  7.219      10      0.000  0.705
#&gt; 15 Item_15 16.229       9      0.020  0.062
#&gt; 16 Item_16  5.473      10      0.000  0.857</div><div class='input'><span class='fu'><a href='M2.html'>M2</a></span><span class='op'>(</span><span class='va'>simmod</span>, QMC<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt;             M2 df           p      RMSEA    RMSEA_5   RMSEA_95      SRMSR
#&gt; stats 169.5498 88 4.11831e-07 0.02153097 0.01660581 0.02636841 0.04568799
#&gt;             TLI       CFI
#&gt; stats 0.9680635 0.9765799</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>simmod</span>, QMC<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; LD matrix (lower triangle) and standardized values:
#&gt; 
#&gt;         Item_1 Item_2 Item_3 Item_4 Item_5 Item_6 Item_7 Item_8 Item_9 Item_10
#&gt; Item_1      NA -0.011 -0.015 -0.007  0.016  0.003  0.006 -0.002  0.056   0.045
#&gt; Item_2   0.263     NA -0.002  0.005 -0.001  0.016 -0.022  0.021  0.056   0.053
#&gt; Item_3   0.441  0.008     NA  0.014 -0.001  0.029 -0.017 -0.011  0.027   0.021
#&gt; Item_4   0.086  0.054  0.376     NA -0.014 -0.023  0.021 -0.004  0.058  -0.002
#&gt; Item_5   0.514  0.004  0.003  0.386     NA -0.028  0.011  0.014  0.027   0.062
#&gt; Item_6   0.015  0.483  1.630  1.038  1.588     NA -0.022 -0.009  0.088   0.054
#&gt; Item_7   0.077  0.996  0.590  0.852  0.258  0.992     NA -0.007  0.059   0.077
#&gt; Item_8   0.012  0.858  0.264  0.039  0.377  0.154  0.094     NA  0.033   0.062
#&gt; Item_9   6.341  6.317  1.485  6.764  1.461 15.587  6.878  2.156     NA   0.001
#&gt; Item_10  3.999  5.703  0.905  0.008  7.679  5.807 11.883  7.807  0.001      NA
#&gt; Item_11  4.872 13.185 17.009  2.646  6.929 13.358 20.498  8.441  0.030   0.754
#&gt; Item_12  1.099 10.665 12.799  5.966  5.354 11.038 10.360  7.780  0.441   0.043
#&gt; Item_13 12.633  3.090  8.633  2.361  2.821  6.743 15.659  0.607  0.009   0.059
#&gt; Item_14  5.935  3.542  4.597  3.675  4.023  9.189 20.816  3.580  3.333   0.065
#&gt; Item_15  9.903  4.481  4.330  0.946  7.858  4.916  4.023  7.986  2.310   0.044
#&gt; Item_16  5.550 14.462 13.475  2.418  9.756  9.061 16.166  8.495  0.007   0.940
#&gt;         Item_11 Item_12 Item_13 Item_14 Item_15 Item_16
#&gt; Item_1    0.049   0.023   0.079   0.054   0.070   0.053
#&gt; Item_2    0.081   0.073   0.039   0.042   0.047   0.085
#&gt; Item_3    0.092   0.080   0.066   0.048   0.047   0.082
#&gt; Item_4    0.036   0.055   0.034   0.043   0.022   0.035
#&gt; Item_5    0.059   0.052   0.038   0.045   0.063   0.070
#&gt; Item_6    0.082   0.074   0.058   0.068   0.050   0.067
#&gt; Item_7    0.101   0.072   0.088   0.102   0.045   0.090
#&gt; Item_8    0.065   0.062   0.017   0.042   0.063   0.065
#&gt; Item_9    0.004  -0.015  -0.002   0.041  -0.034  -0.002
#&gt; Item_10  -0.019   0.005   0.005   0.006  -0.005   0.022
#&gt; Item_11      NA   0.009   0.000  -0.025   0.039  -0.011
#&gt; Item_12   0.150      NA  -0.008   0.013  -0.002  -0.009
#&gt; Item_13   0.000   0.134      NA   0.013  -0.012   0.003
#&gt; Item_14   1.275   0.344   0.340      NA  -0.006  -0.023
#&gt; Item_15   3.052   0.008   0.279   0.084      NA   0.010
#&gt; Item_16   0.253   0.147   0.016   1.018   0.193      NA</div><div class='input'>
    <span class='co'># }</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


