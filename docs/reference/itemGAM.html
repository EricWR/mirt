<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Parametric smoothed regression lines for item response probability functions — itemGAM • mirt</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Parametric smoothed regression lines for item response probability functions — itemGAM" />
<meta property="og:description" content="This function uses a generalized additive model (GAM) to estimate response curves for items that
do not seem to fit well in a given model. Using a stable axillary model, traceline functions for
poorly fitting dichotomous or polytomous items can be inspected using point estimates
(or plausible values) of the latent trait. Plots of the tracelines and their associated standard
errors are available to help interpret the misfit. This function may also be useful when adding
new items to an existing, well established set of items, especially when the parametric form of
the items under investigation are unknown." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mirt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.32.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mirt-vignettes.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/philchalmers/mirt/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Parametric smoothed regression lines for item response probability functions</h1>
    <small class="dont-index">Source: <a href='https://github.com/philchalmers/mirt/blob/master/R/itemGAM.R'><code>R/itemGAM.R</code></a></small>
    <div class="hidden name"><code>itemGAM.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function uses a generalized additive model (GAM) to estimate response curves for items that
do not seem to fit well in a given model. Using a stable axillary model, traceline functions for
poorly fitting dichotomous or polytomous items can be inspected using point estimates
(or plausible values) of the latent trait. Plots of the tracelines and their associated standard
errors are available to help interpret the misfit. This function may also be useful when adding
new items to an existing, well established set of items, especially when the parametric form of
the items under investigation are unknown.</p>
    </div>

    <pre class="usage"><span class='fu'>itemGAM</span><span class='op'>(</span>
  <span class='va'>item</span>,
  <span class='va'>Theta</span>,
  formula <span class='op'>=</span> <span class='va'>resp</span> <span class='op'>~</span> <span class='fu'>s</span><span class='op'>(</span><span class='va'>Theta</span>, k <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>,
  CI <span class='op'>=</span> <span class='fl'>0.95</span>,
  theta_lim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>3</span>, <span class='fl'>3</span><span class='op'>)</span>,
  return.models <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S3 method for itemGAM</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span>
  <span class='va'>x</span>,
  y <span class='op'>=</span> <span class='cn'>NULL</span>,
  par.strip.text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>cex <span class='op'>=</span> <span class='fl'>0.7</span><span class='op'>)</span>,
  par.settings <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>strip.background <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"#9ECAE1"</span><span class='op'>)</span>, strip.border <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>col
    <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span><span class='op'>)</span>,
  auto.key <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>space <span class='op'>=</span> <span class='st'>"right"</span>, points <span class='op'>=</span> <span class='cn'>FALSE</span>, lines <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>item</th>
      <td><p>a single poorly fitting item to be investigated. Can be a vector or matrix</p></td>
    </tr>
    <tr>
      <th>Theta</th>
      <td><p>a list or matrix of latent trait estimates typically returned from <code><a href='fscores.html'>fscores</a></code></p></td>
    </tr>
    <tr>
      <th>formula</th>
      <td><p>an R formula to be passed to the <code>gam</code> function. Default fits a spline model
with 10 nodes. For multidimensional models, the traits are assigned the names 'Theta1', 'Theta2',
..., 'ThetaN'</p></td>
    </tr>
    <tr>
      <th>CI</th>
      <td><p>a number ranging from 0 to 1 indicating the confidence interval range. Default provides the
95 percent interval</p></td>
    </tr>
    <tr>
      <th>theta_lim</th>
      <td><p>range of latent trait scores to be evaluated</p></td>
    </tr>
    <tr>
      <th>return.models</th>
      <td><p>logical; return a list of GAM models for each category? Useful when the GAMs
should be inspected directly, but also when fitting multidimensional models (this is set to
TRUE automatically for multidimensional models)</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments to be passed to <code>gam</code> or <code>lattice</code></p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>an object of class 'itemGAM'</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>a <code>NULL</code> value ignored by the plotting function</p></td>
    </tr>
    <tr>
      <th>par.strip.text</th>
      <td><p>plotting argument passed to <code>lattice</code></p></td>
    </tr>
    <tr>
      <th>par.settings</th>
      <td><p>plotting argument passed to <code>lattice</code></p></td>
    </tr>
    <tr>
      <th>auto.key</th>
      <td><p>plotting argument passed to <code>lattice</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Chalmers, R., P. (2012). mirt: A Multidimensional Item Response Theory
Package for the R Environment. <em>Journal of Statistical Software, 48</em>(6), 1-29.
doi: <a href='https://doi.org/10.18637/jss.v048.i06'>10.18637/jss.v048.i06</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='itemfit.html'>itemfit</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Phil Chalmers <a href='mailto:rphilip.chalmers@gmail.com'>rphilip.chalmers@gmail.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># \donttest{</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>
<span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>1000</span>
<span class='va'>J</span> <span class='op'>&lt;-</span> <span class='fl'>30</span>

<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='va'>J</span><span class='op'>)</span>
<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>J</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>Theta</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>N</span>, <span class='fl'>0</span>, <span class='fl'>1.5</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='va'>N</span>, itemtype <span class='op'>=</span> <span class='st'>'2PL'</span>, Theta<span class='op'>=</span><span class='va'>Theta</span><span class='op'>)</span>

<span class='co'># make a bad item</span>
<span class='va'>ps</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>Theta</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>+</span> <span class='va'>Theta</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>Theta</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>+</span> <span class='va'>Theta</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>item1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='va'>ps</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>, size <span class='op'>=</span> <span class='fl'>1</span>, prob <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='va'>x</span>, <span class='va'>x</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>ps2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='fl'>2</span> <span class='op'>*</span> <span class='va'>Theta</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>+</span> <span class='va'>Theta</span> <span class='op'>+</span> <span class='fl'>.5</span> <span class='op'>*</span> <span class='va'>Theta</span><span class='op'>^</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='fl'>2</span> <span class='op'>*</span> <span class='va'>Theta</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>+</span> <span class='va'>Theta</span> <span class='op'>+</span> <span class='fl'>.5</span> <span class='op'>*</span> <span class='va'>Theta</span><span class='op'>^</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>item2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span><span class='va'>ps2</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>, size <span class='op'>=</span> <span class='fl'>1</span>, prob <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='va'>x</span>, <span class='va'>x</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#' # how the actual item looks in the population</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Theta</span>, <span class='va'>ps</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='itemGAM-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Theta</span>, <span class='va'>ps2</span>, ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='itemGAM-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='va'>baditems</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>item1</span>, <span class='va'>item2</span><span class='op'>)</span>
<span class='va'>newdat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>baditems</span><span class='op'>)</span>

<span class='va'>badmod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mirt.html'>mirt</a></span><span class='op'>(</span><span class='va'>newdat</span>, <span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='itemfit.html'>itemfit</a></span><span class='op'>(</span><span class='va'>badmod</span><span class='op'>)</span> <span class='co'>#clearly a bad fit for the last two items</span>
</div><div class='output co'>#&gt;       item    S_X2 df.S_X2 RMSEA.S_X2 p.S_X2
#&gt; 1   Item_1  26.608      24      0.010  0.323
#&gt; 2   Item_2  14.613      26      0.000  0.964
#&gt; 3   Item_3  35.063      25      0.020  0.087
#&gt; 4   Item_4  30.993      26      0.014  0.229
#&gt; 5   Item_5  20.266      25      0.000  0.733
#&gt; 6   Item_6  26.641      24      0.010  0.321
#&gt; 7   Item_7  25.524      25      0.005  0.433
#&gt; 8   Item_8  29.095      24      0.015  0.217
#&gt; 9   Item_9  29.228      25      0.013  0.254
#&gt; 10 Item_10  34.572      24      0.021  0.075
#&gt; 11 Item_11  32.517      24      0.019  0.115
#&gt; 12 Item_12  43.634      25      0.027  0.012
#&gt; 13 Item_13  19.525      24      0.000  0.723
#&gt; 14 Item_14  24.384      25      0.000  0.497
#&gt; 15 Item_15  24.072      25      0.000  0.515
#&gt; 16 Item_16  33.682      25      0.019  0.115
#&gt; 17 Item_17  58.681      26      0.035  0.000
#&gt; 18 Item_18  28.826      24      0.014  0.227
#&gt; 19 Item_19  19.221      23      0.000  0.688
#&gt; 20 Item_20  38.570      25      0.023  0.041
#&gt; 21 Item_21  24.132      26      0.000  0.568
#&gt; 22 Item_22  28.951      23      0.016  0.182
#&gt; 23 Item_23  22.083      26      0.000  0.684
#&gt; 24 Item_24  29.721      24      0.015  0.194
#&gt; 25 Item_25  22.775      26      0.000  0.646
#&gt; 26 Item_26  27.243      24      0.012  0.293
#&gt; 27 Item_27  22.161      26      0.000  0.680
#&gt; 28 Item_28  22.798      26      0.000  0.644
#&gt; 29 Item_29  30.499      24      0.016  0.169
#&gt; 30 Item_30  31.316      24      0.017  0.145
#&gt; 31   item1 185.602      28      0.075  0.000
#&gt; 32   item2 135.647      28      0.062  0.000</div><div class='input'><span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mirt.html'>mirt</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span><span class='op'>)</span> <span class='co'>#fit a model that does not contain the bad items</span>
<span class='fu'><a href='itemfit.html'>itemfit</a></span><span class='op'>(</span><span class='va'>mod</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       item   S_X2 df.S_X2 RMSEA.S_X2 p.S_X2
#&gt; 1   Item_1 29.980      24      0.016  0.185
#&gt; 2   Item_2 21.004      26      0.000  0.742
#&gt; 3   Item_3 26.195      24      0.010  0.343
#&gt; 4   Item_4 24.582      25      0.000  0.486
#&gt; 5   Item_5 27.717      24      0.012  0.272
#&gt; 6   Item_6 34.249      23      0.022  0.062
#&gt; 7   Item_7 34.346      25      0.019  0.101
#&gt; 8   Item_8 25.295      23      0.010  0.335
#&gt; 9   Item_9 21.434      25      0.000  0.668
#&gt; 10 Item_10 30.231      23      0.018  0.143
#&gt; 11 Item_11 23.284      23      0.004  0.444
#&gt; 12 Item_12 18.241      24      0.000  0.791
#&gt; 13 Item_13 19.337      24      0.000  0.734
#&gt; 14 Item_14 26.281      24      0.010  0.339
#&gt; 15 Item_15 15.675      24      0.000  0.899
#&gt; 16 Item_16 25.369      24      0.008  0.386
#&gt; 17 Item_17 51.496      25      0.033  0.001
#&gt; 18 Item_18 17.211      23      0.000  0.799
#&gt; 19 Item_19 20.136      23      0.000  0.634
#&gt; 20 Item_20 37.402      24      0.024  0.040
#&gt; 21 Item_21 30.726      25      0.015  0.198
#&gt; 22 Item_22 23.889      22      0.009  0.353
#&gt; 23 Item_23 13.622      25      0.000  0.968
#&gt; 24 Item_24 43.777      24      0.029  0.008
#&gt; 25 Item_25 27.211      25      0.009  0.345
#&gt; 26 Item_26 17.295      24      0.000  0.836
#&gt; 27 Item_27 27.196      25      0.009  0.346
#&gt; 28 Item_28 16.918      25      0.000  0.885
#&gt; 29 Item_29 15.302      24      0.000  0.912
#&gt; 30 Item_30 21.808      23      0.000  0.532</div><div class='input'>
<span class='co'>#### Pure non-parametric way of investigating the items</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>KernSmoothIRT</span><span class='op'>)</span>
<span class='va'>ks</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/KernSmoothIRT/man/ksIRT.html'>ksIRT</a></span><span class='op'>(</span><span class='va'>newdat</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>newdat</span><span class='op'>)</span><span class='op'>)</span>, <span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/KernSmoothIRT/man/plot.ksIRT.html'>plot</a></span><span class='op'>(</span><span class='va'>ks</span>, item<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>31</span>,<span class='fl'>32</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='itemGAM-3.png' alt='' width='700' height='433' /></div><div class='img'><img src='itemGAM-4.png' alt='' width='700' height='433' /></div><div class='img'><img src='itemGAM-5.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>ask<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>

<span class='co'># Using point estimates from the model</span>
<span class='va'>Theta</span> <span class='op'>&lt;-</span> <span class='fu'><a href='fscores.html'>fscores</a></span><span class='op'>(</span><span class='va'>mod</span><span class='op'>)</span>
<span class='va'>IG0</span> <span class='op'>&lt;-</span> <span class='fu'>itemGAM</span><span class='op'>(</span><span class='va'>dat</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>, <span class='va'>Theta</span><span class='op'>)</span> <span class='co'>#good item</span>
<span class='va'>IG1</span> <span class='op'>&lt;-</span> <span class='fu'>itemGAM</span><span class='op'>(</span><span class='va'>baditems</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>, <span class='va'>Theta</span><span class='op'>)</span>
<span class='va'>IG2</span> <span class='op'>&lt;-</span> <span class='fu'>itemGAM</span><span class='op'>(</span><span class='va'>baditems</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span>, <span class='va'>Theta</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/KernSmoothIRT/man/plot.ksIRT.html'>plot</a></span><span class='op'>(</span><span class='va'>IG0</span><span class='op'>)</span>
</div><div class='img'><img src='itemGAM-6.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/KernSmoothIRT/man/plot.ksIRT.html'>plot</a></span><span class='op'>(</span><span class='va'>IG1</span><span class='op'>)</span>
</div><div class='img'><img src='itemGAM-7.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/KernSmoothIRT/man/plot.ksIRT.html'>plot</a></span><span class='op'>(</span><span class='va'>IG2</span><span class='op'>)</span>
</div><div class='img'><img src='itemGAM-8.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># same as above, but with plausible values to obtain the standard errors</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>4321</span><span class='op'>)</span>
<span class='va'>ThetaPV</span> <span class='op'>&lt;-</span> <span class='fu'><a href='fscores.html'>fscores</a></span><span class='op'>(</span><span class='va'>mod</span>, plausible.draws<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span>
<span class='va'>IG0</span> <span class='op'>&lt;-</span> <span class='fu'>itemGAM</span><span class='op'>(</span><span class='va'>dat</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>, <span class='va'>ThetaPV</span><span class='op'>)</span> <span class='co'>#good item</span>
<span class='va'>IG1</span> <span class='op'>&lt;-</span> <span class='fu'>itemGAM</span><span class='op'>(</span><span class='va'>baditems</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>, <span class='va'>ThetaPV</span><span class='op'>)</span>
<span class='va'>IG2</span> <span class='op'>&lt;-</span> <span class='fu'>itemGAM</span><span class='op'>(</span><span class='va'>baditems</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span>, <span class='va'>ThetaPV</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/KernSmoothIRT/man/plot.ksIRT.html'>plot</a></span><span class='op'>(</span><span class='va'>IG0</span><span class='op'>)</span>
</div><div class='img'><img src='itemGAM-9.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/KernSmoothIRT/man/plot.ksIRT.html'>plot</a></span><span class='op'>(</span><span class='va'>IG1</span><span class='op'>)</span>
</div><div class='img'><img src='itemGAM-10.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/KernSmoothIRT/man/plot.ksIRT.html'>plot</a></span><span class='op'>(</span><span class='va'>IG2</span><span class='op'>)</span>
</div><div class='img'><img src='itemGAM-11.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## for polytomous test items</span>
<span class='va'>SAT12</span><span class='op'>[</span><span class='va'>SAT12</span> <span class='op'>==</span> <span class='fl'>8</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='key2binary.html'>key2binary</a></span><span class='op'>(</span><span class='va'>SAT12</span>,
                  key <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>4</span>,<span class='fl'>5</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>4</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>5</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>4</span>,<span class='fl'>1</span>,<span class='fl'>4</span>,<span class='fl'>3</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>1</span>,<span class='fl'>3</span>,<span class='fl'>5</span>,<span class='fl'>1</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>5</span>,<span class='fl'>4</span>,<span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat</span><span class='op'>[</span>,<span class='op'>-</span><span class='fl'>32</span><span class='op'>]</span>
<span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mirt.html'>mirt</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span><span class='op'>)</span>

<span class='co'># Kernal smoothing is very sensitive to which category is selected as 'correct'</span>
<span class='co'># 5th category as correct</span>
<span class='va'>ks</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/KernSmoothIRT/man/ksIRT.html'>ksIRT</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>SAT12</span><span class='op'>[</span>,<span class='fl'>32</span><span class='op'>]</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>31</span><span class='op'>)</span>, <span class='fl'>5</span><span class='op'>)</span>, <span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/KernSmoothIRT/man/plot.ksIRT.html'>plot</a></span><span class='op'>(</span><span class='va'>ks</span>, items <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>32</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='itemGAM-12.png' alt='' width='700' height='433' /></div><div class='img'><img src='itemGAM-13.png' alt='' width='700' height='433' /></div><div class='img'><img src='itemGAM-14.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># 3rd category as correct</span>
<span class='va'>ks</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/KernSmoothIRT/man/ksIRT.html'>ksIRT</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>SAT12</span><span class='op'>[</span>,<span class='fl'>32</span><span class='op'>]</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>31</span><span class='op'>)</span>, <span class='fl'>3</span><span class='op'>)</span>, <span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/KernSmoothIRT/man/plot.ksIRT.html'>plot</a></span><span class='op'>(</span><span class='va'>ks</span>, items <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>32</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='itemGAM-15.png' alt='' width='700' height='433' /></div><div class='img'><img src='itemGAM-16.png' alt='' width='700' height='433' /></div><div class='img'><img src='itemGAM-17.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># splines approach</span>
<span class='va'>Theta</span> <span class='op'>&lt;-</span> <span class='fu'><a href='fscores.html'>fscores</a></span><span class='op'>(</span><span class='va'>mod</span><span class='op'>)</span>
<span class='va'>IG</span> <span class='op'>&lt;-</span> <span class='fu'>itemGAM</span><span class='op'>(</span><span class='va'>SAT12</span><span class='op'>[</span>,<span class='fl'>32</span><span class='op'>]</span>, <span class='va'>Theta</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/KernSmoothIRT/man/plot.ksIRT.html'>plot</a></span><span class='op'>(</span><span class='va'>IG</span><span class='op'>)</span>
</div><div class='img'><img src='itemGAM-18.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1423</span><span class='op'>)</span>
<span class='va'>ThetaPV</span> <span class='op'>&lt;-</span> <span class='fu'><a href='fscores.html'>fscores</a></span><span class='op'>(</span><span class='va'>mod</span>, plausible.draws<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span>
<span class='va'>IG2</span> <span class='op'>&lt;-</span> <span class='fu'>itemGAM</span><span class='op'>(</span><span class='va'>SAT12</span><span class='op'>[</span>,<span class='fl'>32</span><span class='op'>]</span>, <span class='va'>ThetaPV</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/KernSmoothIRT/man/plot.ksIRT.html'>plot</a></span><span class='op'>(</span><span class='va'>IG2</span><span class='op'>)</span>
</div><div class='img'><img src='itemGAM-19.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># assuming a simple increasing parametric form (like in a standard IRT model)</span>
<span class='va'>IG3</span> <span class='op'>&lt;-</span> <span class='fu'>itemGAM</span><span class='op'>(</span><span class='va'>SAT12</span><span class='op'>[</span>,<span class='fl'>32</span><span class='op'>]</span>, <span class='va'>Theta</span>, formula <span class='op'>=</span> <span class='va'>resp</span> <span class='op'>~</span> <span class='va'>Theta</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/KernSmoothIRT/man/plot.ksIRT.html'>plot</a></span><span class='op'>(</span><span class='va'>IG3</span><span class='op'>)</span>
</div><div class='img'><img src='itemGAM-20.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>IG3</span> <span class='op'>&lt;-</span> <span class='fu'>itemGAM</span><span class='op'>(</span><span class='va'>SAT12</span><span class='op'>[</span>,<span class='fl'>32</span><span class='op'>]</span>, <span class='va'>ThetaPV</span>, formula <span class='op'>=</span> <span class='va'>resp</span> <span class='op'>~</span> <span class='va'>Theta</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/KernSmoothIRT/man/plot.ksIRT.html'>plot</a></span><span class='op'>(</span><span class='va'>IG3</span><span class='op'>)</span>
</div><div class='img'><img src='itemGAM-21.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>### multidimensional example by returning the GAM objects</span>
<span class='va'>mod2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mirt.html'>mirt</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>2</span><span class='op'>)</span>
<span class='va'>Theta</span> <span class='op'>&lt;-</span> <span class='fu'><a href='fscores.html'>fscores</a></span><span class='op'>(</span><span class='va'>mod2</span><span class='op'>)</span>
<span class='va'>IG4</span> <span class='op'>&lt;-</span> <span class='fu'>itemGAM</span><span class='op'>(</span><span class='va'>SAT12</span><span class='op'>[</span>,<span class='fl'>32</span><span class='op'>]</span>, <span class='va'>Theta</span>, formula <span class='op'>=</span> <span class='va'>resp</span> <span class='op'>~</span> <span class='fu'>s</span><span class='op'>(</span><span class='va'>Theta1</span>, k<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>s</span><span class='op'>(</span><span class='va'>Theta2</span>, k<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span>,
   return.models<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>IG4</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "cat_1" "cat_2" "cat_3" "cat_4" "cat_5"</div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/KernSmoothIRT/man/plot.ksIRT.html'>plot</a></span><span class='op'>(</span><span class='va'>IG4</span><span class='op'>[[</span><span class='fl'>1L</span><span class='op'>]</span><span class='op'>]</span>, main <span class='op'>=</span> <span class='st'>'Category 1'</span><span class='op'>)</span>
</div><div class='img'><img src='itemGAM-22.png' alt='' width='700' height='433' /></div><div class='img'><img src='itemGAM-23.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/KernSmoothIRT/man/plot.ksIRT.html'>plot</a></span><span class='op'>(</span><span class='va'>IG4</span><span class='op'>[[</span><span class='fl'>2L</span><span class='op'>]</span><span class='op'>]</span>, main <span class='op'>=</span> <span class='st'>'Category 2'</span><span class='op'>)</span>
</div><div class='img'><img src='itemGAM-24.png' alt='' width='700' height='433' /></div><div class='img'><img src='itemGAM-25.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/KernSmoothIRT/man/plot.ksIRT.html'>plot</a></span><span class='op'>(</span><span class='va'>IG4</span><span class='op'>[[</span><span class='fl'>3L</span><span class='op'>]</span><span class='op'>]</span>, main <span class='op'>=</span> <span class='st'>'Category 3'</span><span class='op'>)</span>
</div><div class='img'><img src='itemGAM-26.png' alt='' width='700' height='433' /></div><div class='img'><img src='itemGAM-27.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


