<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Multiple Group Estimation — multipleGroup • mirt</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Multiple Group Estimation — multipleGroup" />
<meta property="og:description" content="multipleGroup performs a full-information
maximum-likelihood multiple group analysis for any combination of dichotomous and polytomous
data under the item response theory paradigm using either Cai's (2010)
Metropolis-Hastings Robbins-Monro (MHRM) algorithm or with an EM algorithm approach. This
function may be used for detecting differential item functioning (DIF), thought the
DIF function may provide a more convenient approach. If the grouping
variable is not specified then the dentype input can be modified to fit
mixture models to estimate any latent group components." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mirt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.32.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mirt-vignettes.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/philchalmers/mirt/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Multiple Group Estimation</h1>
    <small class="dont-index">Source: <a href='https://github.com/philchalmers/mirt/blob/master/R/multipleGroup.R'><code>R/multipleGroup.R</code></a></small>
    <div class="hidden name"><code>multipleGroup.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>multipleGroup</code> performs a full-information
maximum-likelihood multiple group analysis for any combination of dichotomous and polytomous
data under the item response theory paradigm using either Cai's (2010)
Metropolis-Hastings Robbins-Monro (MHRM) algorithm or with an EM algorithm approach. This
function may be used for detecting differential item functioning (DIF), thought the
<code><a href='DIF.html'>DIF</a></code> function may provide a more convenient approach. If the grouping
variable is not specified then the <code>dentype</code> input can be modified to fit
mixture models to estimate any latent group components.</p>
    </div>

    <pre class="usage"><span class='fu'>multipleGroup</span><span class='op'>(</span>
  <span class='va'>data</span>,
  <span class='va'>model</span>,
  <span class='va'>group</span>,
  invariance <span class='op'>=</span> <span class='st'>""</span>,
  method <span class='op'>=</span> <span class='st'>"EM"</span>,
  dentype <span class='op'>=</span> <span class='st'>"Gaussian"</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>a <code>matrix</code> or <code>data.frame</code> that consists of
numerically ordered data, with missing data coded as <code>NA</code></p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>string to be passed to, or a model object returned from, <code><a href='mirt.model.html'>mirt.model</a></code>
declaring how the global model is to be estimated (useful to apply constraints here)</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>a <code>character</code> or <code>factor</code> vector indicating group membership. If a <code>character</code>
vector is supplied this will be automatically transformed into a <code><a href='https://rdrr.io/r/base/factor.html'>factor</a></code> variable.
As well, the first level of the (factorized) grouping variable will be treated as the "reference" group</p></td>
    </tr>
    <tr>
      <th>invariance</th>
      <td><p>a character vector containing the following possible options:</p><dl>
    <dt><code>'free_mean'</code> or <code>'free_means'</code></dt><dd><p>freely estimate all latent means in all focal groups
      (reference group constrained to a vector of 0's)</p></dd>
    <dt><code>'free_var'</code>, <code>'free_vars'</code>, <code>'free_variance'</code>, or <code>'free_variances'</code></dt><dd><p>freely estimate all latent variances in focal groups
      (reference group variances all constrained to 1)</p></dd>
    <dt><code>'slopes'</code></dt><dd><p>to constrain all the slopes to be equal across all groups</p></dd>
    <dt><code>'intercepts'</code></dt><dd><p>to constrain all the intercepts to be equal across all
      groups, note for nominal models this also includes the category specific slope parameters</p></dd>
   
</dl>

<p>Additionally, specifying specific item name bundles (from <code><a href='https://rdrr.io/r/base/colnames.html'>colnames(data)</a></code>) will
  constrain all freely estimated parameters in each item to be equal across groups. This is
  useful for selecting 'anchor' items for vertical and horizontal scaling, and for detecting
  differential item functioning (DIF) across groups</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>a character object that is either <code>'EM'</code>, <code>'QMCEM'</code>, or <code>'MHRM'</code>
(default is <code>'EM'</code>). See <code><a href='mirt.html'>mirt</a></code> for details</p></td>
    </tr>
    <tr>
      <th>dentype</th>
      <td><p>type of density form to use for the latent trait parameters. Current options include
  all of the methods described in <code><a href='mirt.html'>mirt</a></code>, as well as</p>
<p></p><ul>
<li><p><code>'mixture-#'</code> estimates mixtures of Gaussian distributions,
      where the <code>#</code> placeholder represents the number of potential grouping variables
      (e.g., <code>'mixture-3'</code> will estimate 3 underlying classes). Each class is
      assigned the group name <code>MIXTURE_#</code>, where <code>#</code> is the class number.
      Note that internally the mixture coefficients are stored as log values where
      the first mixture group coefficient is fixed at 0</p></li>
</ul></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments to be passed to the estimation engine. See <code><a href='mirt.html'>mirt</a></code>
for details and examples</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>function returns an object of class <code>MultipleGroupClass</code>
  (<a href='MultipleGroupClass-class.html'>MultipleGroupClass-class</a>).</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>By default the estimation in <code>multipleGroup</code> assumes that the models are maximally
independent, and therefore could initially be performed by sub-setting the data and running
identical models with <code>mirt</code> and aggregating the results (e.g., log-likelihood).
However, constrains may be automatically imposed across groups by invoking various
<code>invariance</code> keywords. Users may also supply a list of parameter equality constraints
to by <code>constrain</code> argument, of define equality constraints using the
<code><a href='mirt.model.html'>mirt.model</a></code> syntax (recommended).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Chalmers, R., P. (2012). mirt: A Multidimensional Item Response Theory
Package for the R Environment. <em>Journal of Statistical Software, 48</em>(6), 1-29.
doi: <a href='https://doi.org/10.18637/jss.v048.i06'>10.18637/jss.v048.i06</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='mirt.html'>mirt</a></code>, <code><a href='DIF.html'>DIF</a></code>, <code><a href='extract.group.html'>extract.group</a></code>, <code><a href='DRF.html'>DRF</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Phil Chalmers <a href='mailto:rphilip.chalmers@gmail.com'>rphilip.chalmers@gmail.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>

<span class='co'>#single factor</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span>
<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>15</span>,<span class='fl'>1</span>,<span class='fl'>.3</span><span class='op'>)</span><span class='op'>)</span>, ncol<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>15</span>,<span class='fl'>0</span>,<span class='fl'>.7</span><span class='op'>)</span>,ncol<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>itemtype</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'2PL'</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>a</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>1000</span>
<span class='va'>dataset1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='va'>N</span>, <span class='va'>itemtype</span><span class='op'>)</span>
<span class='va'>dataset2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='va'>N</span>, <span class='va'>itemtype</span>, mu <span class='op'>=</span> <span class='fl'>.1</span>, sigma <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>1.5</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>dataset1</span>, <span class='va'>dataset2</span><span class='op'>)</span>
<span class='va'>group</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'D1'</span>, <span class='va'>N</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'D2'</span>, <span class='va'>N</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>mod_configural</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span>, group <span class='op'>=</span> <span class='va'>group</span><span class='op'>)</span> <span class='co'>#completely separate analyses</span>
<span class='co'>#limited information fit statistics</span>
<span class='fu'><a href='M2.html'>M2</a></span><span class='op'>(</span><span class='va'>mod_configural</span><span class='op'>)</span>
</div><div class='output co'>#&gt;             M2  df         p RMSEA RMSEA_5 RMSEA_95   SRMSR.D1   SRMSR.D2
#&gt; stats 142.9866 180 0.9806548     0       0        0 0.02414868 0.01901262
#&gt;            TLI CFI
#&gt; stats 1.005381   1</div><div class='input'>
<span class='va'>mod_metric</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span>, group <span class='op'>=</span> <span class='va'>group</span>, invariance<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'slopes'</span><span class='op'>)</span><span class='op'>)</span> <span class='co'>#equal slopes</span>
<span class='co'>#equal intercepts, free variance and means</span>
<span class='va'>mod_scalar2</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span>, group <span class='op'>=</span> <span class='va'>group</span>,
                             invariance<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'slopes'</span>, <span class='st'>'intercepts'</span>, <span class='st'>'free_var'</span>,<span class='st'>'free_means'</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>mod_scalar1</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span>, group <span class='op'>=</span> <span class='va'>group</span>,  <span class='co'>#fixed means</span>
                             invariance<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'slopes'</span>, <span class='st'>'intercepts'</span>, <span class='st'>'free_var'</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>mod_fullconstrain</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span>, group <span class='op'>=</span> <span class='va'>group</span>,
                             invariance<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'slopes'</span>, <span class='st'>'intercepts'</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='extract.mirt.html'>extract.mirt</a></span><span class='op'>(</span><span class='va'>mod_fullconstrain</span>, <span class='st'>'time'</span><span class='op'>)</span> <span class='co'>#time of estimation components</span>
</div><div class='output co'>#&gt; TOTAL:   Data  Estep  Mstep     SE   Post 
#&gt;  0.365  0.050  0.067  0.236  0.000  0.001 </div><div class='input'>
<span class='co'>#optionally use Newton-Raphson for (generally) faster convergence in the M-step's</span>
<span class='va'>mod_fullconstrain</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span>, group <span class='op'>=</span> <span class='va'>group</span>, optimizer <span class='op'>=</span> <span class='st'>'NR'</span>,
                             invariance<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'slopes'</span>, <span class='st'>'intercepts'</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='extract.mirt.html'>extract.mirt</a></span><span class='op'>(</span><span class='va'>mod_fullconstrain</span>, <span class='st'>'time'</span><span class='op'>)</span> <span class='co'>#time of estimation components</span>
</div><div class='output co'>#&gt; TOTAL:   Data  Estep  Mstep     SE   Post 
#&gt;  0.295  0.048  0.074  0.158  0.000  0.001 </div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>mod_scalar2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; ----------
#&gt; GROUP: D1 
#&gt;            F1     h2
#&gt; Item_1  0.544 0.2962
#&gt; Item_2  0.577 0.3324
#&gt; Item_3  0.529 0.2799
#&gt; Item_4  0.460 0.2118
#&gt; Item_5  0.536 0.2877
#&gt; Item_6  0.253 0.0639
#&gt; Item_7  0.570 0.3247
#&gt; Item_8  0.498 0.2479
#&gt; Item_9  0.459 0.2104
#&gt; Item_10 0.373 0.1393
#&gt; Item_11 0.487 0.2368
#&gt; Item_12 0.632 0.3998
#&gt; Item_13 0.596 0.3547
#&gt; Item_14 0.561 0.3147
#&gt; Item_15 0.414 0.1715
#&gt; 
#&gt; SS loadings:  3.872 
#&gt; Proportion Var:  0.258 
#&gt; 
#&gt; Factor correlations: 
#&gt; 
#&gt;    F1
#&gt; F1  1
#&gt; 
#&gt; ----------
#&gt; GROUP: D2 
#&gt;            F1    h2
#&gt; Item_1  0.687 0.472
#&gt; Item_2  0.728 0.530
#&gt; Item_3  0.668 0.446
#&gt; Item_4  0.581 0.338
#&gt; Item_5  0.677 0.459
#&gt; Item_6  0.319 0.102
#&gt; Item_7  0.720 0.518
#&gt; Item_8  0.629 0.395
#&gt; Item_9  0.579 0.336
#&gt; Item_10 0.471 0.222
#&gt; Item_11 0.615 0.378
#&gt; Item_12 0.799 0.638
#&gt; Item_13 0.752 0.566
#&gt; Item_14 0.708 0.502
#&gt; Item_15 0.523 0.274
#&gt; 
#&gt; SS loadings:  6.176 
#&gt; Proportion Var:  0.412 
#&gt; 
#&gt; Factor correlations: 
#&gt; 
#&gt;    F1
#&gt; F1  1</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>mod_scalar2</span>, simplify<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $D1
#&gt; $items
#&gt;            a1      d g u
#&gt; Item_1  1.104  0.538 0 1
#&gt; Item_2  1.201 -0.630 0 1
#&gt; Item_3  1.061 -0.265 0 1
#&gt; Item_4  0.882  0.900 0 1
#&gt; Item_5  1.082  0.164 0 1
#&gt; Item_6  0.445  0.636 0 1
#&gt; Item_7  1.180  0.976 0 1
#&gt; Item_8  0.977 -0.377 0 1
#&gt; Item_9  0.879 -1.035 0 1
#&gt; Item_10 0.685 -1.118 0 1
#&gt; Item_11 0.948  1.213 0 1
#&gt; Item_12 1.389 -0.224 0 1
#&gt; Item_13 1.262  0.429 0 1
#&gt; Item_14 1.153  0.453 0 1
#&gt; Item_15 0.774 -0.070 0 1
#&gt; 
#&gt; $means
#&gt; F1 
#&gt;  0 
#&gt; 
#&gt; $cov
#&gt;    F1
#&gt; F1  1
#&gt; 
#&gt; 
#&gt; $D2
#&gt; $items
#&gt;            a1      d g u
#&gt; Item_1  1.104  0.538 0 1
#&gt; Item_2  1.201 -0.630 0 1
#&gt; Item_3  1.061 -0.265 0 1
#&gt; Item_4  0.882  0.900 0 1
#&gt; Item_5  1.082  0.164 0 1
#&gt; Item_6  0.445  0.636 0 1
#&gt; Item_7  1.180  0.976 0 1
#&gt; Item_8  0.977 -0.377 0 1
#&gt; Item_9  0.879 -1.035 0 1
#&gt; Item_10 0.685 -1.118 0 1
#&gt; Item_11 0.948  1.213 0 1
#&gt; Item_12 1.389 -0.224 0 1
#&gt; Item_13 1.262  0.429 0 1
#&gt; Item_14 1.153  0.453 0 1
#&gt; Item_15 0.774 -0.070 0 1
#&gt; 
#&gt; $means
#&gt;    F1 
#&gt; 0.066 
#&gt; 
#&gt; $cov
#&gt;       F1
#&gt; F1 1.595
#&gt; 
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>mod_scalar2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $D1
#&gt;         Item_1 Item_2 Item_3 Item_4 Item_5 Item_6 Item_7 Item_8 Item_9 Item_10
#&gt; Item_1      NA -0.036 -0.056  0.036 -0.014  0.014  0.017 -0.020 -0.008  -0.066
#&gt; Item_2   1.306     NA -0.052 -0.032 -0.031  0.033 -0.028  0.034  0.038   0.042
#&gt; Item_3   3.144  2.659     NA -0.047  0.057  0.071 -0.037 -0.050  0.033  -0.047
#&gt; Item_4   1.279  1.041  2.172     NA  0.029  0.035  0.032 -0.039 -0.038   0.032
#&gt; Item_5   0.198  0.933  3.291  0.862     NA  0.029  0.048 -0.028  0.027  -0.027
#&gt; Item_6   0.204  1.059  5.031  1.197  0.830     NA  0.020  0.034  0.023   0.041
#&gt; Item_7   0.277  0.804  1.361  1.019  2.337  0.392     NA -0.023 -0.040   0.038
#&gt; Item_8   0.402  1.143  2.483  1.545  0.774  1.125  0.518     NA -0.027   0.025
#&gt; Item_9   0.068  1.478  1.062  1.471  0.717  0.523  1.631  0.726     NA   0.052
#&gt; Item_10  4.303  1.756  2.228  1.054  0.744  1.649  1.453  0.609  2.691      NA
#&gt; Item_11  0.361  3.951  0.988  1.198  0.910  1.320  0.139  2.072  2.296   1.368
#&gt; Item_12  1.718  0.586  1.038  0.726  0.219  0.454  1.323  0.473  0.323   0.604
#&gt; Item_13  0.194  3.316  1.368  1.158  0.797  0.517  0.045  0.395  0.200   2.690
#&gt; Item_14  0.074  0.804  3.798  2.946  0.648  0.227  0.223  0.463  0.693   0.378
#&gt; Item_15  0.164  1.266  0.868  6.383  4.884  1.982  0.583  1.563  1.130   2.406
#&gt;         Item_11 Item_12 Item_13 Item_14 Item_15
#&gt; Item_1   -0.019   0.041  -0.014  -0.009   0.013
#&gt; Item_2   -0.063   0.024   0.058   0.028   0.036
#&gt; Item_3   -0.031   0.032  -0.037  -0.062   0.029
#&gt; Item_4    0.035   0.027  -0.034  -0.054   0.080
#&gt; Item_5   -0.030   0.015   0.028  -0.025  -0.070
#&gt; Item_6    0.036   0.021   0.023  -0.015   0.045
#&gt; Item_7    0.012   0.036  -0.007   0.015   0.024
#&gt; Item_8   -0.046   0.022   0.020  -0.022   0.040
#&gt; Item_9   -0.048  -0.018  -0.014   0.026   0.034
#&gt; Item_10   0.037   0.025   0.052  -0.019  -0.049
#&gt; Item_11      NA   0.010  -0.024  -0.053   0.021
#&gt; Item_12   0.094      NA  -0.016  -0.016   0.012
#&gt; Item_13   0.555   0.254      NA  -0.013   0.022
#&gt; Item_14   2.862   0.255   0.159      NA   0.009
#&gt; Item_15   0.424   0.148   0.486   0.073      NA
#&gt; 
#&gt; $D2
#&gt;         Item_1 Item_2 Item_3 Item_4 Item_5 Item_6 Item_7 Item_8 Item_9 Item_10
#&gt; Item_1      NA -0.029  0.031 -0.026  0.021 -0.042 -0.006  0.039  0.010  -0.029
#&gt; Item_2   0.862     NA  0.047 -0.060  0.049 -0.061 -0.036 -0.036  0.043   0.035
#&gt; Item_3   0.973  2.251     NA  0.064  0.039 -0.029  0.033  0.045  0.042   0.031
#&gt; Item_4   0.673  3.547  4.082     NA  0.034  0.045  0.029  0.033 -0.031  -0.053
#&gt; Item_5   0.456  2.426  1.534  1.151     NA -0.042 -0.043 -0.030  0.034  -0.026
#&gt; Item_6   1.750  3.773  0.861  2.016  1.752     NA -0.038  0.023 -0.060   0.022
#&gt; Item_7   0.040  1.294  1.085  0.831  1.854  1.475     NA  0.023 -0.021   0.025
#&gt; Item_8   1.530  1.310  1.985  1.122  0.915  0.545  0.539     NA -0.028  -0.026
#&gt; Item_9   0.106  1.832  1.780  0.934  1.137  3.654  0.453  0.760     NA   0.037
#&gt; Item_10  0.815  1.230  0.958  2.779  0.685  0.466  0.622  0.690  1.393      NA
#&gt; Item_11  0.822  0.826  0.799  1.861  0.336  0.218  0.062  2.847  0.285   0.407
#&gt; Item_12  0.087  1.536  1.097  0.640  0.309  0.454  0.096  0.556  0.398   0.520
#&gt; Item_13  0.582  1.458  0.844  1.093  0.620  0.403  0.400  0.619  1.349   0.478
#&gt; Item_14  0.403  1.550  0.914  1.292  0.544  0.798  0.534  3.153  0.137   0.344
#&gt; Item_15  0.338  1.306  1.241  0.980  2.379  1.261  0.615  0.291  0.276   0.325
#&gt;         Item_11 Item_12 Item_13 Item_14 Item_15
#&gt; Item_1    0.029   0.009   0.024   0.020   0.018
#&gt; Item_2    0.029  -0.039   0.038   0.039  -0.036
#&gt; Item_3    0.028   0.033   0.029   0.030   0.035
#&gt; Item_4    0.043  -0.025  -0.033   0.036  -0.031
#&gt; Item_5    0.018  -0.018  -0.025   0.023  -0.049
#&gt; Item_6    0.015  -0.021   0.020  -0.028  -0.036
#&gt; Item_7   -0.008  -0.010  -0.020   0.023  -0.025
#&gt; Item_8    0.053  -0.024  -0.025   0.056   0.017
#&gt; Item_9   -0.017  -0.020  -0.037   0.012  -0.017
#&gt; Item_10   0.020   0.023  -0.022   0.019   0.018
#&gt; Item_11      NA   0.032   0.017   0.018   0.024
#&gt; Item_12   1.010      NA   0.014  -0.022  -0.011
#&gt; Item_13   0.280   0.185      NA   0.022  -0.012
#&gt; Item_14   0.333   0.480   0.479      NA  -0.007
#&gt; Item_15   0.580   0.131   0.145   0.048      NA
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>mod_configural</span><span class='op'>)</span>
</div><div class='img'><img src='multipleGroup-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>mod_configural</span>, type <span class='op'>=</span> <span class='st'>'info'</span><span class='op'>)</span>
</div><div class='img'><img src='multipleGroup-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>mod_configural</span>, type <span class='op'>=</span> <span class='st'>'trace'</span><span class='op'>)</span>
</div><div class='img'><img src='multipleGroup-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>mod_configural</span>, type <span class='op'>=</span> <span class='st'>'trace'</span>, which.items <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>)</span>
</div><div class='img'><img src='multipleGroup-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='itemplot.html'>itemplot</a></span><span class='op'>(</span><span class='va'>mod_configural</span>, <span class='fl'>2</span><span class='op'>)</span>
</div><div class='img'><img src='multipleGroup-5.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='itemplot.html'>itemplot</a></span><span class='op'>(</span><span class='va'>mod_configural</span>, <span class='fl'>2</span>, type <span class='op'>=</span> <span class='st'>'RE'</span><span class='op'>)</span>
</div><div class='img'><img src='multipleGroup-6.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>mod_metric</span>, <span class='va'>mod_configural</span><span class='op'>)</span> <span class='co'>#equal slopes only</span>
</div><div class='output co'>#&gt; 
#&gt; Model 1: multipleGroup(data = dat, model = 1, group = group, invariance = c("slopes"))
#&gt; Model 2: multipleGroup(data = dat, model = 1, group = group)
#&gt; </div><div class='output co'>#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df   p
#&gt; 1 35937.61 35939.72 36046.68 36030.15 36189.65 -17923.80   NaN NaN NaN
#&gt; 2 35927.53 35931.30 36072.96 36050.92 36263.58 -17903.76 40.08  15   0</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>mod_scalar2</span>, <span class='va'>mod_metric</span><span class='op'>)</span> <span class='co'>#equal intercepts, free variance and mean</span>
</div><div class='output co'>#&gt; 
#&gt; Model 1: multipleGroup(data = dat, model = 1, group = group, invariance = c("slopes", 
#&gt;     "intercepts", "free_var", "free_means"))
#&gt; Model 2: multipleGroup(data = dat, model = 1, group = group, invariance = c("slopes"))
#&gt; </div><div class='output co'>#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik      X2  df   p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33     NaN NaN NaN
#&gt; 2 35937.61 35939.72 36046.68 36030.15 36189.65 -17923.80 -16.947  13   1</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>mod_scalar1</span>, <span class='va'>mod_scalar2</span><span class='op'>)</span> <span class='co'>#fix mean</span>
</div><div class='output co'>#&gt; 
#&gt; Model 1: multipleGroup(data = dat, model = 1, group = group, invariance = c("slopes", 
#&gt;     "intercepts", "free_var"))
#&gt; Model 2: multipleGroup(data = dat, model = 1, group = group, invariance = c("slopes", 
#&gt;     "intercepts", "free_var", "free_means"))
#&gt; </div><div class='output co'>#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35893.96 35894.96 35969.10 35957.71 36067.58 -17915.98   NaN NaN   NaN
#&gt; 2 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33 1.296   1 0.255</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>mod_fullconstrain</span>, <span class='va'>mod_scalar1</span><span class='op'>)</span> <span class='co'>#fix variance</span>
</div><div class='output co'>#&gt; 
#&gt; Model 1: multipleGroup(data = dat, model = 1, group = group, invariance = c("slopes", 
#&gt;     "intercepts"), optimizer = "NR")
#&gt; Model 2: multipleGroup(data = dat, model = 1, group = group, invariance = c("slopes", 
#&gt;     "intercepts", "free_var"))
#&gt; </div><div class='output co'>#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik     X2  df   p
#&gt; 1 35917.51 35918.45 35990.22 35979.20 36085.53 -17928.75    NaN NaN NaN
#&gt; 2 35893.96 35894.96 35969.10 35957.71 36067.58 -17915.98 25.552   1   0</div><div class='input'>

<span class='co'>#test whether first 6 slopes should be equal across groups</span>
<span class='va'>values</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span>, group <span class='op'>=</span> <span class='va'>group</span>, pars <span class='op'>=</span> <span class='st'>'values'</span><span class='op'>)</span>
<span class='va'>values</span>
</div><div class='output co'>#&gt;     group    item     class   name parnum       value lbound ubound   est
#&gt; 1      D1  Item_1      dich     a1      1  0.85100000   -Inf    Inf  TRUE
#&gt; 2      D1  Item_1      dich      d      2  0.54126659   -Inf    Inf  TRUE
#&gt; 3      D1  Item_1      dich      g      3  0.00000000  0e+00      1 FALSE
#&gt; 4      D1  Item_1      dich      u      4  1.00000000  0e+00      1 FALSE
#&gt; 5      D1  Item_2      dich     a1      5  0.85100000   -Inf    Inf  TRUE
#&gt; 6      D1  Item_2      dich      d      6 -0.53615172   -Inf    Inf  TRUE
#&gt; 7      D1  Item_2      dich      g      7  0.00000000  0e+00      1 FALSE
#&gt; 8      D1  Item_2      dich      u      8  1.00000000  0e+00      1 FALSE
#&gt; 9      D1  Item_3      dich     a1      9  0.85100000   -Inf    Inf  TRUE
#&gt; 10     D1  Item_3      dich      d     10 -0.21967593   -Inf    Inf  TRUE
#&gt; 11     D1  Item_3      dich      g     11  0.00000000  0e+00      1 FALSE
#&gt; 12     D1  Item_3      dich      u     12  1.00000000  0e+00      1 FALSE
#&gt; 13     D1  Item_4      dich     a1     13  0.85100000   -Inf    Inf  TRUE
#&gt; 14     D1  Item_4      dich      d     14  0.94120931   -Inf    Inf  TRUE
#&gt; 15     D1  Item_4      dich      g     15  0.00000000  0e+00      1 FALSE
#&gt; 16     D1  Item_4      dich      u     16  1.00000000  0e+00      1 FALSE
#&gt; 17     D1  Item_5      dich     a1     17  0.85100000   -Inf    Inf  TRUE
#&gt; 18     D1  Item_5      dich      d     18  0.18995704   -Inf    Inf  TRUE
#&gt; 19     D1  Item_5      dich      g     19  0.00000000  0e+00      1 FALSE
#&gt; 20     D1  Item_5      dich      u     20  1.00000000  0e+00      1 FALSE
#&gt; 21     D1  Item_6      dich     a1     21  0.85100000   -Inf    Inf  TRUE
#&gt; 22     D1  Item_6      dich      d     22  0.75196729   -Inf    Inf  TRUE
#&gt; 23     D1  Item_6      dich      g     23  0.00000000  0e+00      1 FALSE
#&gt; 24     D1  Item_6      dich      u     24  1.00000000  0e+00      1 FALSE
#&gt; 25     D1  Item_7      dich     a1     25  0.85100000   -Inf    Inf  TRUE
#&gt; 26     D1  Item_7      dich      d     26  0.92742018   -Inf    Inf  TRUE
#&gt; 27     D1  Item_7      dich      g     27  0.00000000  0e+00      1 FALSE
#&gt; 28     D1  Item_7      dich      u     28  1.00000000  0e+00      1 FALSE
#&gt; 29     D1  Item_8      dich     a1     29  0.85100000   -Inf    Inf  TRUE
#&gt; 30     D1  Item_8      dich      d     30 -0.33912546   -Inf    Inf  TRUE
#&gt; 31     D1  Item_8      dich      g     31  0.00000000  0e+00      1 FALSE
#&gt; 32     D1  Item_8      dich      u     32  1.00000000  0e+00      1 FALSE
#&gt; 33     D1  Item_9      dich     a1     33  0.85100000   -Inf    Inf  TRUE
#&gt; 34     D1  Item_9      dich      d     34 -1.01931663   -Inf    Inf  TRUE
#&gt; 35     D1  Item_9      dich      g     35  0.00000000  0e+00      1 FALSE
#&gt; 36     D1  Item_9      dich      u     36  1.00000000  0e+00      1 FALSE
#&gt; 37     D1 Item_10      dich     a1     37  0.85100000   -Inf    Inf  TRUE
#&gt; 38     D1 Item_10      dich      d     38 -1.17772444   -Inf    Inf  TRUE
#&gt; 39     D1 Item_10      dich      g     39  0.00000000  0e+00      1 FALSE
#&gt; 40     D1 Item_10      dich      u     40  1.00000000  0e+00      1 FALSE
#&gt; 41     D1 Item_11      dich     a1     41  0.85100000   -Inf    Inf  TRUE
#&gt; 42     D1 Item_11      dich      d     42  1.22822603   -Inf    Inf  TRUE
#&gt; 43     D1 Item_11      dich      g     43  0.00000000  0e+00      1 FALSE
#&gt; 44     D1 Item_11      dich      u     44  1.00000000  0e+00      1 FALSE
#&gt; 45     D1 Item_12      dich     a1     45  0.85100000   -Inf    Inf  TRUE
#&gt; 46     D1 Item_12      dich      d     46 -0.15039813   -Inf    Inf  TRUE
#&gt; 47     D1 Item_12      dich      g     47  0.00000000  0e+00      1 FALSE
#&gt; 48     D1 Item_12      dich      u     48  1.00000000  0e+00      1 FALSE
#&gt; 49     D1 Item_13      dich     a1     49  0.85100000   -Inf    Inf  TRUE
#&gt; 50     D1 Item_13      dich      d     50  0.41943284   -Inf    Inf  TRUE
#&gt; 51     D1 Item_13      dich      g     51  0.00000000  0e+00      1 FALSE
#&gt; 52     D1 Item_13      dich      u     52  1.00000000  0e+00      1 FALSE
#&gt; 53     D1 Item_14      dich     a1     53  0.85100000   -Inf    Inf  TRUE
#&gt; 54     D1 Item_14      dich      d     54  0.45478078   -Inf    Inf  TRUE
#&gt; 55     D1 Item_14      dich      g     55  0.00000000  0e+00      1 FALSE
#&gt; 56     D1 Item_14      dich      u     56  1.00000000  0e+00      1 FALSE
#&gt; 57     D1 Item_15      dich     a1     57  0.85100000   -Inf    Inf  TRUE
#&gt; 58     D1 Item_15      dich      d     58 -0.04680406   -Inf    Inf  TRUE
#&gt; 59     D1 Item_15      dich      g     59  0.00000000  0e+00      1 FALSE
#&gt; 60     D1 Item_15      dich      u     60  1.00000000  0e+00      1 FALSE
#&gt; 61     D1   GROUP GroupPars MEAN_1     61  0.00000000   -Inf    Inf FALSE
#&gt; 62     D1   GROUP GroupPars COV_11     62  1.00000000  1e-04    Inf FALSE
#&gt; 63     D2  Item_1      dich     a1     63  0.85100000   -Inf    Inf  TRUE
#&gt; 64     D2  Item_1      dich      d     64  0.54126659   -Inf    Inf  TRUE
#&gt; 65     D2  Item_1      dich      g     65  0.00000000  0e+00      1 FALSE
#&gt; 66     D2  Item_1      dich      u     66  1.00000000  0e+00      1 FALSE
#&gt; 67     D2  Item_2      dich     a1     67  0.85100000   -Inf    Inf  TRUE
#&gt; 68     D2  Item_2      dich      d     68 -0.53615172   -Inf    Inf  TRUE
#&gt; 69     D2  Item_2      dich      g     69  0.00000000  0e+00      1 FALSE
#&gt; 70     D2  Item_2      dich      u     70  1.00000000  0e+00      1 FALSE
#&gt; 71     D2  Item_3      dich     a1     71  0.85100000   -Inf    Inf  TRUE
#&gt; 72     D2  Item_3      dich      d     72 -0.21967593   -Inf    Inf  TRUE
#&gt; 73     D2  Item_3      dich      g     73  0.00000000  0e+00      1 FALSE
#&gt; 74     D2  Item_3      dich      u     74  1.00000000  0e+00      1 FALSE
#&gt; 75     D2  Item_4      dich     a1     75  0.85100000   -Inf    Inf  TRUE
#&gt; 76     D2  Item_4      dich      d     76  0.94120931   -Inf    Inf  TRUE
#&gt; 77     D2  Item_4      dich      g     77  0.00000000  0e+00      1 FALSE
#&gt; 78     D2  Item_4      dich      u     78  1.00000000  0e+00      1 FALSE
#&gt; 79     D2  Item_5      dich     a1     79  0.85100000   -Inf    Inf  TRUE
#&gt; 80     D2  Item_5      dich      d     80  0.18995704   -Inf    Inf  TRUE
#&gt; 81     D2  Item_5      dich      g     81  0.00000000  0e+00      1 FALSE
#&gt; 82     D2  Item_5      dich      u     82  1.00000000  0e+00      1 FALSE
#&gt; 83     D2  Item_6      dich     a1     83  0.85100000   -Inf    Inf  TRUE
#&gt; 84     D2  Item_6      dich      d     84  0.75196729   -Inf    Inf  TRUE
#&gt; 85     D2  Item_6      dich      g     85  0.00000000  0e+00      1 FALSE
#&gt; 86     D2  Item_6      dich      u     86  1.00000000  0e+00      1 FALSE
#&gt; 87     D2  Item_7      dich     a1     87  0.85100000   -Inf    Inf  TRUE
#&gt; 88     D2  Item_7      dich      d     88  0.92742018   -Inf    Inf  TRUE
#&gt; 89     D2  Item_7      dich      g     89  0.00000000  0e+00      1 FALSE
#&gt; 90     D2  Item_7      dich      u     90  1.00000000  0e+00      1 FALSE
#&gt; 91     D2  Item_8      dich     a1     91  0.85100000   -Inf    Inf  TRUE
#&gt; 92     D2  Item_8      dich      d     92 -0.33912546   -Inf    Inf  TRUE
#&gt; 93     D2  Item_8      dich      g     93  0.00000000  0e+00      1 FALSE
#&gt; 94     D2  Item_8      dich      u     94  1.00000000  0e+00      1 FALSE
#&gt; 95     D2  Item_9      dich     a1     95  0.85100000   -Inf    Inf  TRUE
#&gt; 96     D2  Item_9      dich      d     96 -1.01931663   -Inf    Inf  TRUE
#&gt; 97     D2  Item_9      dich      g     97  0.00000000  0e+00      1 FALSE
#&gt; 98     D2  Item_9      dich      u     98  1.00000000  0e+00      1 FALSE
#&gt; 99     D2 Item_10      dich     a1     99  0.85100000   -Inf    Inf  TRUE
#&gt; 100    D2 Item_10      dich      d    100 -1.17772444   -Inf    Inf  TRUE
#&gt; 101    D2 Item_10      dich      g    101  0.00000000  0e+00      1 FALSE
#&gt; 102    D2 Item_10      dich      u    102  1.00000000  0e+00      1 FALSE
#&gt; 103    D2 Item_11      dich     a1    103  0.85100000   -Inf    Inf  TRUE
#&gt; 104    D2 Item_11      dich      d    104  1.22822603   -Inf    Inf  TRUE
#&gt; 105    D2 Item_11      dich      g    105  0.00000000  0e+00      1 FALSE
#&gt; 106    D2 Item_11      dich      u    106  1.00000000  0e+00      1 FALSE
#&gt; 107    D2 Item_12      dich     a1    107  0.85100000   -Inf    Inf  TRUE
#&gt; 108    D2 Item_12      dich      d    108 -0.15039813   -Inf    Inf  TRUE
#&gt; 109    D2 Item_12      dich      g    109  0.00000000  0e+00      1 FALSE
#&gt; 110    D2 Item_12      dich      u    110  1.00000000  0e+00      1 FALSE
#&gt; 111    D2 Item_13      dich     a1    111  0.85100000   -Inf    Inf  TRUE
#&gt; 112    D2 Item_13      dich      d    112  0.41943284   -Inf    Inf  TRUE
#&gt; 113    D2 Item_13      dich      g    113  0.00000000  0e+00      1 FALSE
#&gt; 114    D2 Item_13      dich      u    114  1.00000000  0e+00      1 FALSE
#&gt; 115    D2 Item_14      dich     a1    115  0.85100000   -Inf    Inf  TRUE
#&gt; 116    D2 Item_14      dich      d    116  0.45478078   -Inf    Inf  TRUE
#&gt; 117    D2 Item_14      dich      g    117  0.00000000  0e+00      1 FALSE
#&gt; 118    D2 Item_14      dich      u    118  1.00000000  0e+00      1 FALSE
#&gt; 119    D2 Item_15      dich     a1    119  0.85100000   -Inf    Inf  TRUE
#&gt; 120    D2 Item_15      dich      d    120 -0.04680406   -Inf    Inf  TRUE
#&gt; 121    D2 Item_15      dich      g    121  0.00000000  0e+00      1 FALSE
#&gt; 122    D2 Item_15      dich      u    122  1.00000000  0e+00      1 FALSE
#&gt; 123    D2   GROUP GroupPars MEAN_1    123  0.00000000   -Inf    Inf FALSE
#&gt; 124    D2   GROUP GroupPars COV_11    124  1.00000000  1e-04    Inf FALSE
#&gt;     prior.type prior_1 prior_2
#&gt; 1         none     NaN     NaN
#&gt; 2         none     NaN     NaN
#&gt; 3         none     NaN     NaN
#&gt; 4         none     NaN     NaN
#&gt; 5         none     NaN     NaN
#&gt; 6         none     NaN     NaN
#&gt; 7         none     NaN     NaN
#&gt; 8         none     NaN     NaN
#&gt; 9         none     NaN     NaN
#&gt; 10        none     NaN     NaN
#&gt; 11        none     NaN     NaN
#&gt; 12        none     NaN     NaN
#&gt; 13        none     NaN     NaN
#&gt; 14        none     NaN     NaN
#&gt; 15        none     NaN     NaN
#&gt; 16        none     NaN     NaN
#&gt; 17        none     NaN     NaN
#&gt; 18        none     NaN     NaN
#&gt; 19        none     NaN     NaN
#&gt; 20        none     NaN     NaN
#&gt; 21        none     NaN     NaN
#&gt; 22        none     NaN     NaN
#&gt; 23        none     NaN     NaN
#&gt; 24        none     NaN     NaN
#&gt; 25        none     NaN     NaN
#&gt; 26        none     NaN     NaN
#&gt; 27        none     NaN     NaN
#&gt; 28        none     NaN     NaN
#&gt; 29        none     NaN     NaN
#&gt; 30        none     NaN     NaN
#&gt; 31        none     NaN     NaN
#&gt; 32        none     NaN     NaN
#&gt; 33        none     NaN     NaN
#&gt; 34        none     NaN     NaN
#&gt; 35        none     NaN     NaN
#&gt; 36        none     NaN     NaN
#&gt; 37        none     NaN     NaN
#&gt; 38        none     NaN     NaN
#&gt; 39        none     NaN     NaN
#&gt; 40        none     NaN     NaN
#&gt; 41        none     NaN     NaN
#&gt; 42        none     NaN     NaN
#&gt; 43        none     NaN     NaN
#&gt; 44        none     NaN     NaN
#&gt; 45        none     NaN     NaN
#&gt; 46        none     NaN     NaN
#&gt; 47        none     NaN     NaN
#&gt; 48        none     NaN     NaN
#&gt; 49        none     NaN     NaN
#&gt; 50        none     NaN     NaN
#&gt; 51        none     NaN     NaN
#&gt; 52        none     NaN     NaN
#&gt; 53        none     NaN     NaN
#&gt; 54        none     NaN     NaN
#&gt; 55        none     NaN     NaN
#&gt; 56        none     NaN     NaN
#&gt; 57        none     NaN     NaN
#&gt; 58        none     NaN     NaN
#&gt; 59        none     NaN     NaN
#&gt; 60        none     NaN     NaN
#&gt; 61        none     NaN     NaN
#&gt; 62        none     NaN     NaN
#&gt; 63        none     NaN     NaN
#&gt; 64        none     NaN     NaN
#&gt; 65        none     NaN     NaN
#&gt; 66        none     NaN     NaN
#&gt; 67        none     NaN     NaN
#&gt; 68        none     NaN     NaN
#&gt; 69        none     NaN     NaN
#&gt; 70        none     NaN     NaN
#&gt; 71        none     NaN     NaN
#&gt; 72        none     NaN     NaN
#&gt; 73        none     NaN     NaN
#&gt; 74        none     NaN     NaN
#&gt; 75        none     NaN     NaN
#&gt; 76        none     NaN     NaN
#&gt; 77        none     NaN     NaN
#&gt; 78        none     NaN     NaN
#&gt; 79        none     NaN     NaN
#&gt; 80        none     NaN     NaN
#&gt; 81        none     NaN     NaN
#&gt; 82        none     NaN     NaN
#&gt; 83        none     NaN     NaN
#&gt; 84        none     NaN     NaN
#&gt; 85        none     NaN     NaN
#&gt; 86        none     NaN     NaN
#&gt; 87        none     NaN     NaN
#&gt; 88        none     NaN     NaN
#&gt; 89        none     NaN     NaN
#&gt; 90        none     NaN     NaN
#&gt; 91        none     NaN     NaN
#&gt; 92        none     NaN     NaN
#&gt; 93        none     NaN     NaN
#&gt; 94        none     NaN     NaN
#&gt; 95        none     NaN     NaN
#&gt; 96        none     NaN     NaN
#&gt; 97        none     NaN     NaN
#&gt; 98        none     NaN     NaN
#&gt; 99        none     NaN     NaN
#&gt; 100       none     NaN     NaN
#&gt; 101       none     NaN     NaN
#&gt; 102       none     NaN     NaN
#&gt; 103       none     NaN     NaN
#&gt; 104       none     NaN     NaN
#&gt; 105       none     NaN     NaN
#&gt; 106       none     NaN     NaN
#&gt; 107       none     NaN     NaN
#&gt; 108       none     NaN     NaN
#&gt; 109       none     NaN     NaN
#&gt; 110       none     NaN     NaN
#&gt; 111       none     NaN     NaN
#&gt; 112       none     NaN     NaN
#&gt; 113       none     NaN     NaN
#&gt; 114       none     NaN     NaN
#&gt; 115       none     NaN     NaN
#&gt; 116       none     NaN     NaN
#&gt; 117       none     NaN     NaN
#&gt; 118       none     NaN     NaN
#&gt; 119       none     NaN     NaN
#&gt; 120       none     NaN     NaN
#&gt; 121       none     NaN     NaN
#&gt; 122       none     NaN     NaN
#&gt; 123       none     NaN     NaN
#&gt; 124       none     NaN     NaN</div><div class='input'><span class='va'>constrain</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>63</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>67</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>9</span>,<span class='fl'>71</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>13</span>,<span class='fl'>75</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>17</span>,<span class='fl'>79</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>21</span>,<span class='fl'>83</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>equalslopes</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span>, group <span class='op'>=</span> <span class='va'>group</span>, constrain <span class='op'>=</span> <span class='va'>constrain</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>equalslopes</span>, <span class='va'>mod_configural</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Model 1: multipleGroup(data = dat, model = 1, group = group, constrain = constrain)
#&gt; Model 2: multipleGroup(data = dat, model = 1, group = group)
#&gt; </div><div class='output co'>#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik     X2  df     p
#&gt; 1 35935.51 35938.56 36066.40 36046.56 36237.96 -17913.76    NaN NaN   NaN
#&gt; 2 35927.53 35931.30 36072.96 36050.92 36263.58 -17903.76 19.983   6 0.003</div><div class='input'>
<span class='co'>#same as above, but using mirt.model syntax</span>
<span class='va'>newmodel</span> <span class='op'>&lt;-</span> <span class='st'>'
    F = 1-15
    CONSTRAINB = (1-6, a1)'</span>
<span class='va'>equalslopes</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>newmodel</span>, group <span class='op'>=</span> <span class='va'>group</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>equalslopes</span>, simplify<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $D1
#&gt; $items
#&gt;            a1      d g u
#&gt; Item_1  1.246  0.546 0 1
#&gt; Item_2  1.356 -0.720 0 1
#&gt; Item_3  1.199 -0.201 0 1
#&gt; Item_4  1.006  0.861 0 1
#&gt; Item_5  1.224  0.131 0 1
#&gt; Item_6  0.515  0.673 0 1
#&gt; Item_7  1.305  0.999 0 1
#&gt; Item_8  0.943 -0.328 0 1
#&gt; Item_9  0.916 -1.058 0 1
#&gt; Item_10 0.731 -1.079 0 1
#&gt; Item_11 0.851  1.186 0 1
#&gt; Item_12 1.515 -0.251 0 1
#&gt; Item_13 1.322  0.444 0 1
#&gt; Item_14 1.058  0.451 0 1
#&gt; Item_15 0.885 -0.061 0 1
#&gt; 
#&gt; $means
#&gt; F 
#&gt; 0 
#&gt; 
#&gt; $cov
#&gt;   F
#&gt; F 1
#&gt; 
#&gt; 
#&gt; $D2
#&gt; $items
#&gt;            a1      d g u
#&gt; Item_1  1.246  0.599 0 1
#&gt; Item_2  1.356 -0.462 0 1
#&gt; Item_3  1.199 -0.264 0 1
#&gt; Item_4  1.006  1.001 0 1
#&gt; Item_5  1.224  0.266 0 1
#&gt; Item_6  0.515  0.631 0 1
#&gt; Item_7  1.374  1.031 0 1
#&gt; Item_8  1.268 -0.367 0 1
#&gt; Item_9  1.061 -0.952 0 1
#&gt; Item_10 0.826 -1.115 0 1
#&gt; Item_11 1.282  1.308 0 1
#&gt; Item_12 1.625 -0.107 0 1
#&gt; Item_13 1.523  0.493 0 1
#&gt; Item_14 1.545  0.532 0 1
#&gt; Item_15 0.885 -0.030 0 1
#&gt; 
#&gt; $means
#&gt; F 
#&gt; 0 
#&gt; 
#&gt; $cov
#&gt;   F
#&gt; F 1
#&gt; 
#&gt; </div><div class='input'>
<span class='co'>############</span>
<span class='co'># vertical scaling (i.e., equating when groups answer items others do not)</span>
<span class='va'>dat2</span> <span class='op'>&lt;-</span> <span class='va'>dat</span>
<span class='va'>dat2</span><span class='op'>[</span><span class='va'>group</span> <span class='op'>==</span> <span class='st'>'D1'</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>dat2</span><span class='op'>[</span><span class='va'>group</span> <span class='op'>!=</span> <span class='st'>'D1'</span>, <span class='fl'>14</span><span class='op'>:</span><span class='fl'>15</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>dat2</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      Item_1 Item_2 Item_3 Item_4 Item_5 Item_6 Item_7 Item_8 Item_9 Item_10
#&gt; [1,]     NA     NA      1      1      1      0      1      1      0       0
#&gt; [2,]     NA     NA      1      1      1      1      1      0      1       0
#&gt; [3,]     NA     NA      0      1      1      1      1      1      0       0
#&gt; [4,]     NA     NA      1      1      1      1      1      1      0       0
#&gt; [5,]     NA     NA      1      0      1      1      1      1      1       0
#&gt; [6,]     NA     NA      1      1      1      1      1      0      0       0
#&gt;      Item_11 Item_12 Item_13 Item_14 Item_15
#&gt; [1,]       1       1       0       1       1
#&gt; [2,]       0       1       1       1       1
#&gt; [3,]       1       0       1       1       1
#&gt; [4,]       1       1       1       1       1
#&gt; [5,]       1       1       1       1       1
#&gt; [6,]       1       1       1       1       0</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='va'>dat2</span><span class='op'>)</span>
</div><div class='output co'>#&gt;         Item_1 Item_2 Item_3 Item_4 Item_5 Item_6 Item_7 Item_8 Item_9 Item_10
#&gt; [1995,]      1      1      0      0      0      1      1      1      0       0
#&gt; [1996,]      1      0      1      1      1      0      1      1      1       1
#&gt; [1997,]      0      1      0      0      0      1      0      1      0       0
#&gt; [1998,]      0      1      0      0      1      0      0      0      0       0
#&gt; [1999,]      1      1      0      1      1      1      1      1      0       0
#&gt; [2000,]      0      0      0      0      0      0      1      0      0       0
#&gt;         Item_11 Item_12 Item_13 Item_14 Item_15
#&gt; [1995,]       1       0       1      NA      NA
#&gt; [1996,]       1       1       0      NA      NA
#&gt; [1997,]       1       0       1      NA      NA
#&gt; [1998,]       0       1       0      NA      NA
#&gt; [1999,]       1       1       1      NA      NA
#&gt; [2000,]       0       0       0      NA      NA</div><div class='input'>
<span class='co'># items with missing responses need to be constrained across groups for identification</span>
<span class='va'>nms</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>dat2</span><span class='op'>)</span>
<span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat2</span>, <span class='fl'>1</span>, <span class='va'>group</span>, invariance <span class='op'>=</span> <span class='va'>nms</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span>, <span class='fl'>14</span><span class='op'>:</span><span class='fl'>15</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>

<span class='co'># this will throw an error without proper constraints (SEs cannot be computed either)</span>
<span class='co'># mod &lt;- multipleGroup(dat2, 1, group)</span>

<span class='co'># model still does not have anchors, therefore need to add a few (here use items 3-5)</span>
<span class='va'>mod_anchor</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat2</span>, <span class='fl'>1</span>, <span class='va'>group</span>,
                            invariance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>nms</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>, <span class='fl'>14</span><span class='op'>:</span><span class='fl'>15</span><span class='op'>)</span><span class='op'>]</span>, <span class='st'>'free_means'</span>, <span class='st'>'free_var'</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>mod_anchor</span>, simplify<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $D1
#&gt; $items
#&gt;            a1      d g u
#&gt; Item_1  1.108  0.542 0 1
#&gt; Item_2  1.160 -0.564 0 1
#&gt; Item_3  1.073 -0.272 0 1
#&gt; Item_4  0.871  0.895 0 1
#&gt; Item_5  1.089  0.160 0 1
#&gt; Item_6  0.582  0.685 0 1
#&gt; Item_7  1.292  1.009 0 1
#&gt; Item_8  0.906 -0.328 0 1
#&gt; Item_9  0.855 -1.049 0 1
#&gt; Item_10 0.746 -1.089 0 1
#&gt; Item_11 0.866  1.200 0 1
#&gt; Item_12 1.432 -0.247 0 1
#&gt; Item_13 1.244  0.440 0 1
#&gt; Item_14 1.000  0.449 0 1
#&gt; Item_15 0.852 -0.061 0 1
#&gt; 
#&gt; $means
#&gt; F1 
#&gt;  0 
#&gt; 
#&gt; $cov
#&gt;    F1
#&gt; F1  1
#&gt; 
#&gt; 
#&gt; $D2
#&gt; $items
#&gt;            a1      d g u
#&gt; Item_1  1.108  0.542 0 1
#&gt; Item_2  1.160 -0.564 0 1
#&gt; Item_3  1.073 -0.272 0 1
#&gt; Item_4  0.871  0.895 0 1
#&gt; Item_5  1.089  0.160 0 1
#&gt; Item_6  0.374  0.596 0 1
#&gt; Item_7  1.090  0.942 0 1
#&gt; Item_8  0.988 -0.437 0 1
#&gt; Item_9  0.854 -1.018 0 1
#&gt; Item_10 0.657 -1.164 0 1
#&gt; Item_11 1.023  1.228 0 1
#&gt; Item_12 1.324 -0.207 0 1
#&gt; Item_13 1.212  0.399 0 1
#&gt; Item_14 1.000  0.449 0 1
#&gt; Item_15 0.852 -0.061 0 1
#&gt; 
#&gt; $means
#&gt;    F1 
#&gt; 0.077 
#&gt; 
#&gt; $cov
#&gt;       F1
#&gt; F1 1.658
#&gt; 
#&gt; </div><div class='input'>
<span class='co'># check if identified by computing information matrix</span>
<span class='va'>mod_anchor</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat2</span>, <span class='fl'>1</span>, <span class='va'>group</span>, pars <span class='op'>=</span> <span class='fu'><a href='mod2values.html'>mod2values</a></span><span class='op'>(</span><span class='va'>mod_anchor</span><span class='op'>)</span>, TOL<span class='op'>=</span><span class='cn'>NaN</span>, SE<span class='op'>=</span><span class='cn'>TRUE</span>,
                            invariance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>nms</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>, <span class='fl'>14</span><span class='op'>:</span><span class='fl'>15</span><span class='op'>)</span><span class='op'>]</span>, <span class='st'>'free_means'</span>, <span class='st'>'free_var'</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>mod_anchor</span>
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; multipleGroup(data = dat2, model = 1, group = group, invariance = c(nms[c(1:5, 
#&gt;     14:15)], "free_means", "free_var"), pars = mod2values(mod_anchor), 
#&gt;     TOL = NaN, SE = TRUE)
#&gt; 
#&gt; Full-information item factor analysis with 1 factor(s).
#&gt; Converged within NaN tolerance after 1 EM iterations.
#&gt; mirt version: 1.32.10 
#&gt; M-step optimizer: nlminb 
#&gt; EM acceleration: Ramsay 
#&gt; Number of rectangular quadrature: 61
#&gt; Latent density type: Gaussian 
#&gt; 
#&gt; Information matrix estimated with method: Oakes
#&gt; Second-order test: model is a possible local maximum
#&gt; Condition number of information matrix =  46.72946
#&gt; 
#&gt; Log-likelihood = -15562.41
#&gt; Estimated parameters: 62 
#&gt; AIC = 31220.81; AICc = 31223.22
#&gt; BIC = 31489.66; SABIC = 31337.16</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>mod_anchor</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $D1
#&gt; $Item_1
#&gt;            a1     d  g  u
#&gt; par     1.108 0.542  0  1
#&gt; CI_2.5  0.875 0.342 NA NA
#&gt; CI_97.5 1.342 0.741 NA NA
#&gt; 
#&gt; $Item_2
#&gt;            a1      d  g  u
#&gt; par     1.160 -0.564  0  1
#&gt; CI_2.5  0.916 -0.772 NA NA
#&gt; CI_97.5 1.403 -0.356 NA NA
#&gt; 
#&gt; $Item_3
#&gt;            a1      d  g  u
#&gt; par     1.073 -0.272  0  1
#&gt; CI_2.5  0.911 -0.401 NA NA
#&gt; CI_97.5 1.236 -0.143 NA NA
#&gt; 
#&gt; $Item_4
#&gt;            a1     d  g  u
#&gt; par     0.871 0.895  0  1
#&gt; CI_2.5  0.725 0.769 NA NA
#&gt; CI_97.5 1.017 1.022 NA NA
#&gt; 
#&gt; $Item_5
#&gt;            a1     d  g  u
#&gt; par     1.089 0.160  0  1
#&gt; CI_2.5  0.924 0.031 NA NA
#&gt; CI_97.5 1.254 0.289 NA NA
#&gt; 
#&gt; $Item_6
#&gt;            a1     d  g  u
#&gt; par     0.582 0.685  0  1
#&gt; CI_2.5  0.405 0.543 NA NA
#&gt; CI_97.5 0.760 0.828 NA NA
#&gt; 
#&gt; $Item_7
#&gt;            a1     d  g  u
#&gt; par     1.292 1.009  0  1
#&gt; CI_2.5  1.027 0.819 NA NA
#&gt; CI_97.5 1.558 1.198 NA NA
#&gt; 
#&gt; $Item_8
#&gt;            a1      d  g  u
#&gt; par     0.906 -0.328  0  1
#&gt; CI_2.5  0.702 -0.475 NA NA
#&gt; CI_97.5 1.111 -0.180 NA NA
#&gt; 
#&gt; $Item_9
#&gt;            a1      d  g  u
#&gt; par     0.855 -1.049  0  1
#&gt; CI_2.5  0.642 -1.216 NA NA
#&gt; CI_97.5 1.069 -0.882 NA NA
#&gt; 
#&gt; $Item_10
#&gt;            a1      d  g  u
#&gt; par     0.746 -1.089  0  1
#&gt; CI_2.5  0.542 -1.252 NA NA
#&gt; CI_97.5 0.950 -0.926 NA NA
#&gt; 
#&gt; $Item_11
#&gt;            a1     d  g  u
#&gt; par     0.866 1.200  0  1
#&gt; CI_2.5  0.651 1.026 NA NA
#&gt; CI_97.5 1.081 1.374 NA NA
#&gt; 
#&gt; $Item_12
#&gt;            a1      d  g  u
#&gt; par     1.432 -0.247  0  1
#&gt; CI_2.5  1.152 -0.420 NA NA
#&gt; CI_97.5 1.713 -0.075 NA NA
#&gt; 
#&gt; $Item_13
#&gt;            a1     d  g  u
#&gt; par     1.244 0.440  0  1
#&gt; CI_2.5  0.994 0.275 NA NA
#&gt; CI_97.5 1.493 0.606 NA NA
#&gt; 
#&gt; $Item_14
#&gt;            a1     d  g  u
#&gt; par     1.000 0.449  0  1
#&gt; CI_2.5  0.785 0.295 NA NA
#&gt; CI_97.5 1.215 0.603 NA NA
#&gt; 
#&gt; $Item_15
#&gt;            a1      d  g  u
#&gt; par     0.852 -0.061  0  1
#&gt; CI_2.5  0.655 -0.204 NA NA
#&gt; CI_97.5 1.049  0.082 NA NA
#&gt; 
#&gt; $GroupPars
#&gt;         MEAN_1 COV_11
#&gt; par          0      1
#&gt; CI_2.5      NA     NA
#&gt; CI_97.5     NA     NA
#&gt; 
#&gt; 
#&gt; $D2
#&gt; $Item_1
#&gt;            a1     d  g  u
#&gt; par     1.108 0.542  0  1
#&gt; CI_2.5  0.875 0.342 NA NA
#&gt; CI_97.5 1.342 0.741 NA NA
#&gt; 
#&gt; $Item_2
#&gt;            a1      d  g  u
#&gt; par     1.160 -0.564  0  1
#&gt; CI_2.5  0.916 -0.772 NA NA
#&gt; CI_97.5 1.403 -0.356 NA NA
#&gt; 
#&gt; $Item_3
#&gt;            a1      d  g  u
#&gt; par     1.073 -0.272  0  1
#&gt; CI_2.5  0.911 -0.401 NA NA
#&gt; CI_97.5 1.236 -0.143 NA NA
#&gt; 
#&gt; $Item_4
#&gt;            a1     d  g  u
#&gt; par     0.871 0.895  0  1
#&gt; CI_2.5  0.725 0.769 NA NA
#&gt; CI_97.5 1.017 1.022 NA NA
#&gt; 
#&gt; $Item_5
#&gt;            a1     d  g  u
#&gt; par     1.089 0.160  0  1
#&gt; CI_2.5  0.924 0.031 NA NA
#&gt; CI_97.5 1.254 0.289 NA NA
#&gt; 
#&gt; $Item_6
#&gt;            a1     d  g  u
#&gt; par     0.374 0.596  0  1
#&gt; CI_2.5  0.243 0.456 NA NA
#&gt; CI_97.5 0.506 0.736 NA NA
#&gt; 
#&gt; $Item_7
#&gt;            a1     d  g  u
#&gt; par     1.090 0.942  0  1
#&gt; CI_2.5  0.855 0.733 NA NA
#&gt; CI_97.5 1.324 1.152 NA NA
#&gt; 
#&gt; $Item_8
#&gt;            a1      d  g  u
#&gt; par     0.988 -0.437  0  1
#&gt; CI_2.5  0.775 -0.625 NA NA
#&gt; CI_97.5 1.200 -0.250 NA NA
#&gt; 
#&gt; $Item_9
#&gt;            a1      d  g  u
#&gt; par     0.854 -1.018  0  1
#&gt; CI_2.5  0.657 -1.211 NA NA
#&gt; CI_97.5 1.050 -0.825 NA NA
#&gt; 
#&gt; $Item_10
#&gt;            a1      d  g  u
#&gt; par     0.657 -1.164  0  1
#&gt; CI_2.5  0.485 -1.345 NA NA
#&gt; CI_97.5 0.829 -0.982 NA NA
#&gt; 
#&gt; $Item_11
#&gt;            a1     d  g  u
#&gt; par     1.023 1.228  0  1
#&gt; CI_2.5  0.796 1.012 NA NA
#&gt; CI_97.5 1.250 1.443 NA NA
#&gt; 
#&gt; $Item_12
#&gt;            a1      d  g  u
#&gt; par     1.324 -0.207  0  1
#&gt; CI_2.5  1.050 -0.425 NA NA
#&gt; CI_97.5 1.598  0.011 NA NA
#&gt; 
#&gt; $Item_13
#&gt;            a1     d  g  u
#&gt; par     1.212 0.399  0  1
#&gt; CI_2.5  0.960 0.191 NA NA
#&gt; CI_97.5 1.465 0.607 NA NA
#&gt; 
#&gt; $Item_14
#&gt;            a1     d  g  u
#&gt; par     1.000 0.449  0  1
#&gt; CI_2.5  0.785 0.295 NA NA
#&gt; CI_97.5 1.215 0.603 NA NA
#&gt; 
#&gt; $Item_15
#&gt;            a1      d  g  u
#&gt; par     0.852 -0.061  0  1
#&gt; CI_2.5  0.655 -0.204 NA NA
#&gt; CI_97.5 1.049  0.082 NA NA
#&gt; 
#&gt; $GroupPars
#&gt;         MEAN_1 COV_11
#&gt; par      0.077  1.658
#&gt; CI_2.5  -0.062  1.235
#&gt; CI_97.5  0.215  2.080
#&gt; 
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>mod_anchor</span>, printSE<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $D1
#&gt; $Item_1
#&gt;        a1     d logit(g) logit(u)
#&gt; par 1.108 0.542     -999      999
#&gt; SE  0.119 0.102       NA       NA
#&gt; 
#&gt; $Item_2
#&gt;        a1      d logit(g) logit(u)
#&gt; par 1.160 -0.564     -999      999
#&gt; SE  0.124  0.106       NA       NA
#&gt; 
#&gt; $Item_3
#&gt;        a1      d logit(g) logit(u)
#&gt; par 1.073 -0.272     -999      999
#&gt; SE  0.083  0.066       NA       NA
#&gt; 
#&gt; $Item_4
#&gt;        a1     d logit(g) logit(u)
#&gt; par 0.871 0.895     -999      999
#&gt; SE  0.075 0.064       NA       NA
#&gt; 
#&gt; $Item_5
#&gt;        a1     d logit(g) logit(u)
#&gt; par 1.089 0.160     -999      999
#&gt; SE  0.084 0.066       NA       NA
#&gt; 
#&gt; $Item_6
#&gt;        a1     d logit(g) logit(u)
#&gt; par 0.582 0.685     -999      999
#&gt; SE  0.090 0.073       NA       NA
#&gt; 
#&gt; $Item_7
#&gt;        a1     d logit(g) logit(u)
#&gt; par 1.292 1.009     -999      999
#&gt; SE  0.135 0.097       NA       NA
#&gt; 
#&gt; $Item_8
#&gt;        a1      d logit(g) logit(u)
#&gt; par 0.906 -0.328     -999      999
#&gt; SE  0.104  0.075       NA       NA
#&gt; 
#&gt; $Item_9
#&gt;        a1      d logit(g) logit(u)
#&gt; par 0.855 -1.049     -999      999
#&gt; SE  0.109  0.085       NA       NA
#&gt; 
#&gt; $Item_10
#&gt;        a1      d logit(g) logit(u)
#&gt; par 0.746 -1.089     -999      999
#&gt; SE  0.104  0.083       NA       NA
#&gt; 
#&gt; $Item_11
#&gt;        a1     d logit(g) logit(u)
#&gt; par 0.866 1.200     -999      999
#&gt; SE  0.110 0.089       NA       NA
#&gt; 
#&gt; $Item_12
#&gt;        a1      d logit(g) logit(u)
#&gt; par 1.432 -0.247     -999      999
#&gt; SE  0.143  0.088       NA       NA
#&gt; 
#&gt; $Item_13
#&gt;        a1     d logit(g) logit(u)
#&gt; par 1.244 0.440     -999      999
#&gt; SE  0.127 0.085       NA       NA
#&gt; 
#&gt; $Item_14
#&gt;       a1     d logit(g) logit(u)
#&gt; par 1.00 0.449     -999      999
#&gt; SE  0.11 0.078       NA       NA
#&gt; 
#&gt; $Item_15
#&gt;        a1      d logit(g) logit(u)
#&gt; par 0.852 -0.061     -999      999
#&gt; SE  0.100  0.073       NA       NA
#&gt; 
#&gt; $GroupPars
#&gt;     MEAN_1 COV_11
#&gt; par      0      1
#&gt; SE      NA     NA
#&gt; 
#&gt; 
#&gt; $D2
#&gt; $Item_1
#&gt;        a1     d logit(g) logit(u)
#&gt; par 1.108 0.542     -999      999
#&gt; SE  0.119 0.102       NA       NA
#&gt; 
#&gt; $Item_2
#&gt;        a1      d logit(g) logit(u)
#&gt; par 1.160 -0.564     -999      999
#&gt; SE  0.124  0.106       NA       NA
#&gt; 
#&gt; $Item_3
#&gt;        a1      d logit(g) logit(u)
#&gt; par 1.073 -0.272     -999      999
#&gt; SE  0.083  0.066       NA       NA
#&gt; 
#&gt; $Item_4
#&gt;        a1     d logit(g) logit(u)
#&gt; par 0.871 0.895     -999      999
#&gt; SE  0.075 0.064       NA       NA
#&gt; 
#&gt; $Item_5
#&gt;        a1     d logit(g) logit(u)
#&gt; par 1.089 0.160     -999      999
#&gt; SE  0.084 0.066       NA       NA
#&gt; 
#&gt; $Item_6
#&gt;        a1     d logit(g) logit(u)
#&gt; par 0.374 0.596     -999      999
#&gt; SE  0.067 0.071       NA       NA
#&gt; 
#&gt; $Item_7
#&gt;       a1     d logit(g) logit(u)
#&gt; par 1.09 0.942     -999      999
#&gt; SE  0.12 0.107       NA       NA
#&gt; 
#&gt; $Item_8
#&gt;        a1      d logit(g) logit(u)
#&gt; par 0.988 -0.437     -999      999
#&gt; SE  0.108  0.096       NA       NA
#&gt; 
#&gt; $Item_9
#&gt;        a1      d logit(g) logit(u)
#&gt; par 0.854 -1.018     -999      999
#&gt; SE  0.100  0.098       NA       NA
#&gt; 
#&gt; $Item_10
#&gt;        a1      d logit(g) logit(u)
#&gt; par 0.657 -1.164     -999      999
#&gt; SE  0.088  0.092       NA       NA
#&gt; 
#&gt; $Item_11
#&gt;        a1     d logit(g) logit(u)
#&gt; par 1.023 1.228     -999      999
#&gt; SE  0.116 0.110       NA       NA
#&gt; 
#&gt; $Item_12
#&gt;        a1      d logit(g) logit(u)
#&gt; par 1.324 -0.207     -999      999
#&gt; SE  0.140  0.111       NA       NA
#&gt; 
#&gt; $Item_13
#&gt;        a1     d logit(g) logit(u)
#&gt; par 1.212 0.399     -999      999
#&gt; SE  0.129 0.106       NA       NA
#&gt; 
#&gt; $Item_14
#&gt;       a1     d logit(g) logit(u)
#&gt; par 1.00 0.449     -999      999
#&gt; SE  0.11 0.078       NA       NA
#&gt; 
#&gt; $Item_15
#&gt;        a1      d logit(g) logit(u)
#&gt; par 0.852 -0.061     -999      999
#&gt; SE  0.100  0.073       NA       NA
#&gt; 
#&gt; $GroupPars
#&gt;     MEAN_1 COV_11
#&gt; par  0.077  1.658
#&gt; SE   0.071  0.216
#&gt; 
#&gt; </div><div class='input'>

<span class='co'>#############</span>
<span class='co'>#DIF test for each item (using all other items as anchors)</span>
<span class='va'>itemnames</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span>
<span class='va'>refmodel</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span>, group <span class='op'>=</span> <span class='va'>group</span>, SE<span class='op'>=</span><span class='cn'>TRUE</span>,
                          invariance<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'free_means'</span>, <span class='st'>'free_var'</span>, <span class='va'>itemnames</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#loop over items (in practice, run in parallel to increase speed). May be better to use ?DIF</span>
<span class='va'>estmodels</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span><span class='op'>(</span><span class='st'>'list'</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span><span class='op'>)</span>
<span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span><span class='op'>)</span>
    <span class='va'>estmodels</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span>, group <span class='op'>=</span> <span class='va'>group</span>, verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
                             invariance<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'free_means'</span>, <span class='st'>'free_var'</span>, <span class='va'>itemnames</span><span class='op'>[</span><span class='op'>-</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>

<span class='op'>(</span><span class='va'>anovas</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>estmodels</span>, <span class='va'>anova</span>, object2<span class='op'>=</span><span class='va'>refmodel</span>, verbose<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [[1]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN   NaN
#&gt; 2 35898.45 35899.66 35980.86 35968.37 36088.88 -17915.22 0.214   2 0.899
#&gt; 
#&gt; [[2]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN   NaN
#&gt; 2 35896.81 35898.02 35979.22 35966.73 36087.24 -17914.41 1.847   2 0.397
#&gt; 
#&gt; [[3]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN   NaN
#&gt; 2 35893.66 35894.87 35976.07 35963.58 36084.09 -17912.83 5.001   2 0.082
#&gt; 
#&gt; [[4]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN   NaN
#&gt; 2 35897.07 35898.29 35979.48 35967.00 36087.50 -17914.54 1.586   2 0.453
#&gt; 
#&gt; [[5]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN   NaN
#&gt; 2 35897.97 35899.18 35980.38 35967.89 36088.40 -17914.99 0.688   2 0.709
#&gt; 
#&gt; [[6]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df    p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN  NaN
#&gt; 2 35894.87 35896.08 35977.28 35964.79 36085.30 -17913.43 3.793   2 0.15
#&gt; 
#&gt; [[7]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN   NaN
#&gt; 2 35897.53 35898.74 35979.94 35967.45 36087.96 -17914.76 1.131   2 0.568
#&gt; 
#&gt; [[8]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN   NaN
#&gt; 2 35897.20 35898.41 35979.61 35967.12 36087.63 -17914.60 1.462   2 0.481
#&gt; 
#&gt; [[9]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN   NaN
#&gt; 2 35898.46 35899.67 35980.87 35968.38 36088.89 -17915.23 0.197   2 0.906
#&gt; 
#&gt; [[10]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN   NaN
#&gt; 2 35897.67 35898.88 35980.08 35967.59 36088.10 -17914.83 0.993   2 0.609
#&gt; 
#&gt; [[11]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN   NaN
#&gt; 2 35896.07 35897.28 35978.48 35965.99 36086.50 -17914.03 2.593   2 0.273
#&gt; 
#&gt; [[12]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN   NaN
#&gt; 2 35897.57 35898.78 35979.98 35967.49 36088.00 -17914.78 1.092   2 0.579
#&gt; 
#&gt; [[13]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN   NaN
#&gt; 2 35898.47 35899.68 35980.88 35968.39 36088.90 -17915.23 0.192   2 0.908
#&gt; 
#&gt; [[14]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN   NaN
#&gt; 2 35896.15 35897.37 35978.57 35966.08 36086.58 -17914.08 2.505   2 0.286
#&gt; 
#&gt; [[15]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN   NaN
#&gt; 2 35896.96 35898.17 35979.37 35966.88 36087.39 -17914.48 1.699   2 0.428
#&gt; </div><div class='input'>
<span class='co'>#family-wise error control</span>
<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span><span class='va'>rbind</span>, <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>anovas</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='va'>x</span><span class='op'>[</span><span class='fl'>2</span>, <span class='st'>'p'</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/p.adjust.html'>p.adjust</a></span><span class='op'>(</span><span class='va'>p</span>, method <span class='op'>=</span> <span class='st'>'BH'</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] 0.9084061 0.8299971 0.8299971 0.8299971 0.8862326 0.8299971 0.8299971
#&gt;  [8] 0.8299971 0.9084061 0.8299971 0.8299971 0.8299971 0.9084061 0.8299971
#&gt; [15] 0.8299971</div><div class='input'>
<span class='co'>#same as above, except only test if slopes vary (1 df)</span>
<span class='co'>#constrain all intercepts</span>
<span class='va'>estmodels</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span><span class='op'>(</span><span class='st'>'list'</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span><span class='op'>)</span>
<span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span><span class='op'>)</span>
    <span class='va'>estmodels</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span>, group <span class='op'>=</span> <span class='va'>group</span>, verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
                             invariance<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'free_means'</span>, <span class='st'>'free_var'</span>, <span class='st'>'intercepts'</span>,
                             <span class='va'>itemnames</span><span class='op'>[</span><span class='op'>-</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>

<span class='op'>(</span><span class='va'>anovas</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>estmodels</span>, <span class='va'>anova</span>, object2<span class='op'>=</span><span class='va'>refmodel</span>, verbose<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [[1]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN   NaN
#&gt; 2 35896.52 35897.66 35976.50 35964.38 36081.35 -17915.26 0.143   1 0.705
#&gt; 
#&gt; [[2]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN   NaN
#&gt; 2 35896.60 35897.74 35976.58 35964.46 36081.43 -17915.30 0.061   1 0.804
#&gt; 
#&gt; [[3]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN   NaN
#&gt; 2 35894.66 35895.80 35974.65 35962.53 36079.49 -17914.33 1.997   1 0.158
#&gt; 
#&gt; [[4]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN   NaN
#&gt; 2 35896.39 35897.53 35976.38 35964.26 36081.22 -17915.20 0.268   1 0.605
#&gt; 
#&gt; [[5]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN   NaN
#&gt; 2 35896.56 35897.70 35976.54 35964.42 36081.39 -17915.28 0.103   1 0.748
#&gt; 
#&gt; [[6]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN   NaN
#&gt; 2 35893.62 35894.76 35973.60 35961.48 36078.45 -17913.81 3.042   1 0.081
#&gt; 
#&gt; [[7]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN   NaN
#&gt; 2 35895.67 35896.82 35975.66 35963.54 36080.50 -17914.84 0.985   1 0.321
#&gt; 
#&gt; [[8]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik   X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33  NaN NaN   NaN
#&gt; 2 35896.27 35897.41 35976.26 35964.13 36081.10 -17915.13 0.39   1 0.532
#&gt; 
#&gt; [[9]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN   NaN
#&gt; 2 35896.66 35897.80 35976.64 35964.52 36081.49 -17915.33 0.001   1 0.979
#&gt; 
#&gt; [[10]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN   NaN
#&gt; 2 35896.12 35897.26 35976.11 35963.99 36080.95 -17915.06 0.538   1 0.463
#&gt; 
#&gt; [[11]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik   X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33  NaN NaN   NaN
#&gt; 2 35894.22 35895.36 35974.21 35962.08 36079.05 -17914.11 2.44   1 0.118
#&gt; 
#&gt; [[12]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik   X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33  NaN NaN   NaN
#&gt; 2 35895.87 35897.01 35975.86 35963.74 36080.70 -17914.94 0.79   1 0.374
#&gt; 
#&gt; [[13]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik   X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33  NaN NaN   NaN
#&gt; 2 35896.58 35897.72 35976.57 35964.44 36081.41 -17915.29 0.08   1 0.778
#&gt; 
#&gt; [[14]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik  X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33 NaN NaN   NaN
#&gt; 2 35894.16 35895.30 35974.15 35962.03 36078.99 -17914.08 2.5   1 0.114
#&gt; 
#&gt; [[15]]
#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 35894.66 35895.73 35972.22 35960.47 36073.89 -17915.33   NaN NaN   NaN
#&gt; 2 35894.99 35896.13 35974.97 35962.85 36079.82 -17914.49 1.672   1 0.196
#&gt; </div><div class='input'>
<span class='co'>#quickly test with Wald test using DIF()</span>
<span class='va'>mod_configural2</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span>, group <span class='op'>=</span> <span class='va'>group</span>, SE<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='DIF.html'>DIF</a></span><span class='op'>(</span><span class='va'>mod_configural2</span>, which.par <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'a1'</span>, <span class='st'>'d'</span><span class='op'>)</span>, Wald<span class='op'>=</span><span class='cn'>TRUE</span>, p.adjust <span class='op'>=</span> <span class='st'>'fdr'</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>No hyper-parameters were estimated in the DIF model. For effective DIF testing, freeing the focal group hyper-parameters is recommended.</span></div><div class='output co'>#&gt;              W df     p adj_pvals
#&gt; Item_1   4.636  2 0.098     0.246
#&gt; Item_2   7.265  2 0.026     0.099
#&gt; Item_3  10.375  2 0.006     0.055
#&gt; Item_4   3.210  2 0.201     0.335
#&gt; Item_5   3.618  2 0.164     0.307
#&gt; Item_6   0.820  2 0.664     0.804
#&gt; Item_7   0.575  2 0.750     0.804
#&gt; Item_8   5.782  2 0.056     0.167
#&gt; Item_9   3.802  2 0.149     0.307
#&gt; Item_10  0.722  2 0.697     0.804
#&gt; Item_11  8.922  2 0.012     0.058
#&gt; Item_12  2.340  2 0.310     0.463
#&gt; Item_13  2.162  2 0.339     0.463
#&gt; Item_14  9.848  2 0.007     0.055
#&gt; Item_15  0.204  2 0.903     0.903</div><div class='input'>


<span class='co'>#############</span>
<span class='co'># Three group model where the latent variable parameters are constrained to</span>
<span class='co'># be equal in the focal groups</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span>
<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>15</span>,<span class='fl'>1</span>,<span class='fl'>.3</span><span class='op'>)</span><span class='op'>)</span>, ncol<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>15</span>,<span class='fl'>0</span>,<span class='fl'>.7</span><span class='op'>)</span>,ncol<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>itemtype</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'2PL'</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>a</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>1000</span>
<span class='va'>dataset1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='va'>N</span>, <span class='va'>itemtype</span><span class='op'>)</span>
<span class='va'>dataset2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='va'>N</span>, <span class='va'>itemtype</span>, mu <span class='op'>=</span> <span class='fl'>.1</span>, sigma <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>1.5</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dataset3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='va'>N</span>, <span class='va'>itemtype</span>, mu <span class='op'>=</span> <span class='fl'>.1</span>, sigma <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>1.5</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>dataset1</span>, <span class='va'>dataset2</span>, <span class='va'>dataset3</span><span class='op'>)</span>
<span class='va'>group</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'D1'</span>, <span class='st'>'D2'</span>, <span class='st'>'D3'</span><span class='op'>)</span>, each<span class='op'>=</span><span class='va'>N</span><span class='op'>)</span>
<span class='va'>model</span> <span class='op'>&lt;-</span> <span class='st'>'F1 = 1-15
          FREE[D2, D3] = (GROUP, MEAN_1), (GROUP, COV_11)
          CONSTRAINB[D2,D3] = (GROUP, MEAN_1), (GROUP, COV_11)'</span>

<span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>model</span>, group <span class='op'>=</span> <span class='va'>group</span>, invariance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>mod</span>, simplify<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $D1
#&gt; $items
#&gt;            a1      d g u
#&gt; Item_1  1.089  0.517 0 1
#&gt; Item_2  1.302 -0.601 0 1
#&gt; Item_3  0.950 -0.251 0 1
#&gt; Item_4  0.857  0.847 0 1
#&gt; Item_5  1.119  0.195 0 1
#&gt; Item_6  0.447  0.618 0 1
#&gt; Item_7  1.209  1.023 0 1
#&gt; Item_8  0.939 -0.396 0 1
#&gt; Item_9  0.909 -1.110 0 1
#&gt; Item_10 0.695 -1.073 0 1
#&gt; Item_11 0.929  1.232 0 1
#&gt; Item_12 1.454 -0.290 0 1
#&gt; Item_13 1.216  0.457 0 1
#&gt; Item_14 1.199  0.453 0 1
#&gt; Item_15 0.751 -0.085 0 1
#&gt; 
#&gt; $means
#&gt; F1 
#&gt;  0 
#&gt; 
#&gt; $cov
#&gt;    F1
#&gt; F1  1
#&gt; 
#&gt; 
#&gt; $D2
#&gt; $items
#&gt;            a1      d g u
#&gt; Item_1  1.089  0.517 0 1
#&gt; Item_2  1.302 -0.601 0 1
#&gt; Item_3  0.950 -0.251 0 1
#&gt; Item_4  0.857  0.847 0 1
#&gt; Item_5  1.119  0.195 0 1
#&gt; Item_6  0.447  0.618 0 1
#&gt; Item_7  1.209  1.023 0 1
#&gt; Item_8  0.939 -0.396 0 1
#&gt; Item_9  0.909 -1.110 0 1
#&gt; Item_10 0.695 -1.073 0 1
#&gt; Item_11 0.929  1.232 0 1
#&gt; Item_12 1.454 -0.290 0 1
#&gt; Item_13 1.216  0.457 0 1
#&gt; Item_14 1.199  0.453 0 1
#&gt; Item_15 0.751 -0.085 0 1
#&gt; 
#&gt; $means
#&gt;    F1 
#&gt; 0.055 
#&gt; 
#&gt; $cov
#&gt;       F1
#&gt; F1 1.467
#&gt; 
#&gt; 
#&gt; $D3
#&gt; $items
#&gt;            a1      d g u
#&gt; Item_1  1.089  0.517 0 1
#&gt; Item_2  1.302 -0.601 0 1
#&gt; Item_3  0.950 -0.251 0 1
#&gt; Item_4  0.857  0.847 0 1
#&gt; Item_5  1.119  0.195 0 1
#&gt; Item_6  0.447  0.618 0 1
#&gt; Item_7  1.209  1.023 0 1
#&gt; Item_8  0.939 -0.396 0 1
#&gt; Item_9  0.909 -1.110 0 1
#&gt; Item_10 0.695 -1.073 0 1
#&gt; Item_11 0.929  1.232 0 1
#&gt; Item_12 1.454 -0.290 0 1
#&gt; Item_13 1.216  0.457 0 1
#&gt; Item_14 1.199  0.453 0 1
#&gt; Item_15 0.751 -0.085 0 1
#&gt; 
#&gt; $means
#&gt;    F1 
#&gt; 0.055 
#&gt; 
#&gt; $cov
#&gt;       F1
#&gt; F1 1.467
#&gt; 
#&gt; </div><div class='input'>


<span class='co'>#############</span>
<span class='co'>#multiple factors</span>

<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>1</span>,<span class='fl'>.3</span><span class='op'>)</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>15</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>1</span>,<span class='fl'>.3</span><span class='op'>)</span><span class='op'>)</span>,
     <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>15</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>1</span>,<span class='fl'>.3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>, <span class='fl'>15</span>, <span class='fl'>3</span><span class='op'>)</span>
<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>15</span>,<span class='fl'>0</span>,<span class='fl'>.7</span><span class='op'>)</span>,ncol<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>mu</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>.4</span>, <span class='op'>-</span><span class='fl'>.7</span>, <span class='fl'>.1</span><span class='op'>)</span>
<span class='va'>sigma</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.21</span>,<span class='fl'>.297</span>,<span class='fl'>1.232</span>,<span class='fl'>.297</span>,<span class='fl'>.81</span>,<span class='fl'>.252</span>,<span class='fl'>1.232</span>,<span class='fl'>.252</span>,<span class='fl'>1.96</span><span class='op'>)</span>,<span class='fl'>3</span>,<span class='fl'>3</span><span class='op'>)</span>
<span class='va'>itemtype</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'2PL'</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>a</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>1000</span>
<span class='va'>dataset1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='va'>N</span>, <span class='va'>itemtype</span><span class='op'>)</span>
<span class='va'>dataset2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='va'>N</span>, <span class='va'>itemtype</span>, mu <span class='op'>=</span> <span class='va'>mu</span>, sigma <span class='op'>=</span> <span class='va'>sigma</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>dataset1</span>, <span class='va'>dataset2</span><span class='op'>)</span>
<span class='va'>group</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'D1'</span>, <span class='va'>N</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'D2'</span>, <span class='va'>N</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#group models</span>
<span class='va'>model</span> <span class='op'>&lt;-</span> <span class='st'>'
   F1 = 1-5
   F2 = 6-10
   F3 = 11-15'</span>

<span class='co'>#define mirt cluster to use parallel architecture</span>
<span class='fu'><a href='mirtCluster.html'>mirtCluster</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>mirtCluster() has already been defined</span></div><div class='input'>
<span class='co'>#EM approach (not as accurate with 3 factors, but generally good for quick model comparisons)</span>
<span class='va'>mod_configural</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>model</span>, group <span class='op'>=</span> <span class='va'>group</span><span class='op'>)</span> <span class='co'>#completely separate analyses</span>
<span class='va'>mod_metric</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>model</span>, group <span class='op'>=</span> <span class='va'>group</span>, invariance<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'slopes'</span><span class='op'>)</span><span class='op'>)</span> <span class='co'>#equal slopes</span>
<span class='va'>mod_fullconstrain</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>model</span>, group <span class='op'>=</span> <span class='va'>group</span>, <span class='co'>#equal means, slopes, intercepts</span>
                             invariance<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'slopes'</span>, <span class='st'>'intercepts'</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>mod_metric</span>, <span class='va'>mod_configural</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Model 1: multipleGroup(data = dat, model = model, group = group, invariance = c("slopes"))
#&gt; Model 2: multipleGroup(data = dat, model = model, group = group)
#&gt; </div><div class='output co'>#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik     X2  df     p
#&gt; 1 38403.00 38405.12 38512.07 38495.55 38655.04 -19156.50    NaN NaN   NaN
#&gt; 2 38401.91 38405.69 38547.34 38525.30 38737.96 -19140.96 31.092  15 0.009</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>mod_fullconstrain</span>, <span class='va'>mod_metric</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Model 1: multipleGroup(data = dat, model = model, group = group, invariance = c("slopes", 
#&gt;     "intercepts"))
#&gt; Model 2: multipleGroup(data = dat, model = model, group = group, invariance = c("slopes"))
#&gt; </div><div class='output co'>#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik      X2  df   p
#&gt; 1 38536.26 38537.20 38608.97 38597.96 38704.29 -19238.13     NaN NaN NaN
#&gt; 2 38403.00 38405.12 38512.07 38495.55 38655.04 -19156.50 163.257  15   0</div><div class='input'>
<span class='co'>#same as above, but with MHRM (generally  more accurate with 3+ factors, but slower)</span>
<span class='va'>mod_configural</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>model</span>, group <span class='op'>=</span> <span class='va'>group</span>, method <span class='op'>=</span> <span class='st'>'MHRM'</span><span class='op'>)</span>
<span class='va'>mod_metric</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>model</span>, group <span class='op'>=</span> <span class='va'>group</span>, invariance<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'slopes'</span><span class='op'>)</span>, method <span class='op'>=</span> <span class='st'>'MHRM'</span><span class='op'>)</span>
<span class='va'>mod_fullconstrain</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>model</span>, group <span class='op'>=</span> <span class='va'>group</span>, method <span class='op'>=</span> <span class='st'>'MHRM'</span>,
                             invariance<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'slopes'</span>, <span class='st'>'intercepts'</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>mod_metric</span>, <span class='va'>mod_configural</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Model 1: multipleGroup(data = dat, model = model, group = group, invariance = c("slopes"), 
#&gt;     method = "MHRM")
#&gt; Model 2: multipleGroup(data = dat, model = model, group = group, method = "MHRM")
#&gt; </div><div class='output co'>#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik     X2  df     p
#&gt; 1 38402.56 38404.68 38511.63 38495.10 38654.60 -19156.28    NaN NaN   NaN
#&gt; 2 38405.36 38409.14 38550.79 38528.75 38741.41 -19142.68 27.198  15 0.027</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>mod_fullconstrain</span>, <span class='va'>mod_metric</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Model 1: multipleGroup(data = dat, model = model, group = group, invariance = c("slopes", 
#&gt;     "intercepts"), method = "MHRM")
#&gt; Model 2: multipleGroup(data = dat, model = model, group = group, invariance = c("slopes"), 
#&gt;     method = "MHRM")
#&gt; </div><div class='output co'>#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik      X2  df   p
#&gt; 1 38539.84 38540.78 38612.55 38601.54 38707.87 -19239.92     NaN NaN NaN
#&gt; 2 38402.56 38404.68 38511.63 38495.10 38654.60 -19156.28 167.281  15   0</div><div class='input'>
<span class='co'>############</span>
<span class='co'>#polytomous item example</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span>
<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>15</span>,<span class='fl'>1</span>,<span class='fl'>.3</span><span class='op'>)</span><span class='op'>)</span>, ncol<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>15</span>,<span class='fl'>0</span>,<span class='fl'>.7</span><span class='op'>)</span>,ncol<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>d</span>, <span class='va'>d</span><span class='op'>-</span><span class='fl'>1</span>, <span class='va'>d</span><span class='op'>-</span><span class='fl'>2</span><span class='op'>)</span>
<span class='va'>itemtype</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'graded'</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>a</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>1000</span>
<span class='va'>dataset1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='va'>N</span>, <span class='va'>itemtype</span><span class='op'>)</span>
<span class='va'>dataset2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='va'>N</span>, <span class='va'>itemtype</span>, mu <span class='op'>=</span> <span class='fl'>.1</span>, sigma <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>1.5</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>dataset1</span>, <span class='va'>dataset2</span><span class='op'>)</span>
<span class='va'>group</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'D1'</span>, <span class='va'>N</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'D2'</span>, <span class='va'>N</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>model</span> <span class='op'>&lt;-</span> <span class='st'>'F1 = 1-15'</span>

<span class='va'>mod_configural</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>model</span>, group <span class='op'>=</span> <span class='va'>group</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>mod_configural</span><span class='op'>)</span>
</div><div class='img'><img src='multipleGroup-7.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>mod_configural</span>, type <span class='op'>=</span> <span class='st'>'SE'</span><span class='op'>)</span>
</div><div class='img'><img src='multipleGroup-8.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='itemplot.html'>itemplot</a></span><span class='op'>(</span><span class='va'>mod_configural</span>, <span class='fl'>1</span><span class='op'>)</span>
</div><div class='img'><img src='multipleGroup-9.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='itemplot.html'>itemplot</a></span><span class='op'>(</span><span class='va'>mod_configural</span>, <span class='fl'>1</span>, type <span class='op'>=</span> <span class='st'>'info'</span><span class='op'>)</span>
</div><div class='img'><img src='multipleGroup-10.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>mod_configural</span>, type <span class='op'>=</span> <span class='st'>'trace'</span><span class='op'>)</span> <span class='co'># messy, score function typically better</span>
</div><div class='img'><img src='multipleGroup-11.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>mod_configural</span>, type <span class='op'>=</span> <span class='st'>'itemscore'</span><span class='op'>)</span>
</div><div class='img'><img src='multipleGroup-12.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='va'>fs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='fscores.html'>fscores</a></span><span class='op'>(</span><span class='va'>mod_configural</span>, full.scores <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Method:  EAP
#&gt; 
#&gt; Empirical Reliability:
#&gt; 
#&gt;     F1 
#&gt; 0.7942 
#&gt; 
#&gt; Method:  EAP
#&gt; 
#&gt; Empirical Reliability:
#&gt; 
#&gt;     F1 
#&gt; 0.7249 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>fs</span><span class='op'>[[</span><span class='st'>"D1"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      Item_1 Item_2 Item_3 Item_4 Item_5 Item_6 Item_7 Item_8 Item_9 Item_10
#&gt; [1,]      0      0      0      0      0      0      0      0      0       0
#&gt; [2,]      0      0      0      0      0      0      0      0      0       0
#&gt; [3,]      0      0      0      0      0      0      0      0      0       0
#&gt; [4,]      0      0      0      0      0      0      0      0      0       0
#&gt; [5,]      0      0      0      0      0      0      0      0      0       0
#&gt; [6,]      0      0      0      0      0      0      0      0      0       0
#&gt;      Item_11 Item_12 Item_13 Item_14 Item_15        F1     SE_F1
#&gt; [1,]       0       0       0       0       0 -2.137057 0.6262718
#&gt; [2,]       0       0       0       1       0 -1.785692 0.5741235
#&gt; [3,]       0       0       0       2       0 -1.726621 0.5800312
#&gt; [4,]       0       0       0       3       0 -1.688716 0.5856268
#&gt; [5,]       0       0       0       3       1 -1.439230 0.5535499
#&gt; [6,]       0       2       0       0       0 -1.582715 0.5660598</div><div class='input'><span class='fu'><a href='fscores.html'>fscores</a></span><span class='op'>(</span><span class='va'>mod_configural</span>, method <span class='op'>=</span> <span class='st'>'EAPsum'</span>, full.scores <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       df      X2      p.X2    rxx_F1
#&gt; stats 39 42.3736 0.3276019 0.7756172
#&gt; 
#&gt;       df       X2      p.X2    rxx_F1
#&gt; stats 42 29.47476 0.9275319 0.8318466
#&gt; </div><div class='output co'>#&gt; $D1
#&gt;    Sum.Scores           F1     SE_F1 observed    expected
#&gt; 0           0 -2.137056571 0.6262718        6  5.73109351
#&gt; 1           1 -1.842264892 0.5888524        6 10.08249658
#&gt; 2           2 -1.645473282 0.5750881       19 15.02644052
#&gt; 3           3 -1.490721890 0.5681733       22 21.11696057
#&gt; 4           4 -1.322711281 0.5477826       31 26.16731434
#&gt; 5           5 -1.172604831 0.5343878       21 30.81114990
#&gt; 6           6 -1.033369339 0.5229023       30 34.97351878
#&gt; 7           7 -0.898167173 0.5101253       37 38.28642383
#&gt; 8           8 -0.770379457 0.4995061       47 40.92147880
#&gt; 9           9 -0.648276432 0.4899687       40 42.89556178
#&gt; 10         10 -0.530510563 0.4810482       54 44.20825135
#&gt; 11         11 -0.417091373 0.4732401       52 44.94497190
#&gt; 12         12 -0.307324568 0.4662902       50 45.16103716
#&gt; 13         13 -0.200657261 0.4600924       35 44.90907260
#&gt; 14         14 -0.096765731 0.4546839       41 44.25218142
#&gt; 15         15  0.004759979 0.4499792       33 43.24436610
#&gt; 16         16  0.104274150 0.4459305       50 41.93576820
#&gt; 17         17  0.202071875 0.4425175       38 40.37507439
#&gt; 18         18  0.298449688 0.4397012       34 38.60588648
#&gt; 19         19  0.393678038 0.4374552       40 36.66805455
#&gt; 20         20  0.488005095 0.4357619       30 34.59858721
#&gt; 21         21  0.581672874 0.4346027       42 32.43092042
#&gt; 22         22  0.674910103 0.4339646       32 30.19547737
#&gt; 23         23  0.767936430 0.4338392       28 27.92026366
#&gt; 24         24  0.860968350 0.4342199       19 25.63069681
#&gt; 25         25  0.954215436 0.4351028       34 23.34994031
#&gt; 26         26  1.047885949 0.4364871       21 21.09940667
#&gt; 27         27  1.142189172 0.4383746       18 18.89862600
#&gt; 28         28  1.237330487 0.4407665       21 16.76546357
#&gt; 29         29  1.333523036 0.4436684       10 14.71661806
#&gt; 30         30  1.430986181 0.4470894       11 12.76726484
#&gt; 31         31  1.529934577 0.4510309        8 10.93114666
#&gt; 32         32  1.630612066 0.4555070        8  9.22112463
#&gt; 33         33  1.733275013 0.4605369        8  7.64818473
#&gt; 34         34  1.838159660 0.4661076        6  6.22141174
#&gt; 35         35  1.945607770 0.4722588        1  4.94877914
#&gt; 36         36  2.055967060 0.4790331        4  3.83475999
#&gt; 37         37  2.169474066 0.4863361        6  2.88068295
#&gt; 38         38  2.286835091 0.4943335        3  2.08640054
#&gt; 39         39  2.408610541 0.5031395        3  1.44515936
#&gt; 40         40  2.534716484 0.5122127        1  0.94647470
#&gt; 41         41  2.667837422 0.5224882        0  0.57961995
#&gt; 42         42  2.809124363 0.5344050        0  0.32363184
#&gt; 43         43  2.954702353 0.5443165        0  0.15780845
#&gt; 44         44  3.126043964 0.5588330        0  0.06566840
#&gt; 45         45  3.344807894 0.5841433        0  0.01877922
#&gt; 
#&gt; $D2
#&gt;    Sum.Scores          F1     SE_F1 observed   expected
#&gt; 0           0 -2.05130154 0.5912973        9 11.0355978
#&gt; 1           1 -1.75022208 0.5476302       23 16.1395895
#&gt; 2           2 -1.55419674 0.5300849       22 20.9952745
#&gt; 3           3 -1.41173370 0.5243664       31 27.0499126
#&gt; 4           4 -1.24022266 0.4925574       35 30.4339815
#&gt; 5           5 -1.09460723 0.4745106       33 33.1973941
#&gt; 6           6 -0.96352775 0.4602807       34 35.4757938
#&gt; 7           7 -0.83622876 0.4435206       32 36.8803015
#&gt; 8           8 -0.71831303 0.4305401       32 37.8120865
#&gt; 9           9 -0.60733281 0.4193943       31 38.3526137
#&gt; 10         10 -0.50128231 0.4091029       28 38.5164821
#&gt; 11         11 -0.40019407 0.4004018       46 38.4037717
#&gt; 12         12 -0.30319834 0.3928821       41 38.0627584
#&gt; 13         13 -0.20956698 0.3863159       36 37.5255576
#&gt; 14         14 -0.11890072 0.3807251       33 36.8301475
#&gt; 15         15 -0.03072312 0.3759795       37 36.0028602
#&gt; 16         16  0.05538372 0.3719906       33 35.0638735
#&gt; 17         17  0.13975529 0.3687182       33 34.0317999
#&gt; 18         18  0.22271790 0.3661063       42 32.9212969
#&gt; 19         19  0.30456977 0.3641136       28 31.7441591
#&gt; 20         20  0.38557952 0.3627146       29 30.5107753
#&gt; 21         21  0.46600618 0.3618867       30 29.2298023
#&gt; 22         22  0.54609598 0.3616155       24 27.9084015
#&gt; 23         23  0.62608453 0.3618947       28 26.5529477
#&gt; 24         24  0.70620669 0.3627244       29 25.1690033
#&gt; 25         25  0.78669301 0.3641096       27 23.7612468
#&gt; 26         26  0.86777451 0.3660611       29 22.3340727
#&gt; 27         27  0.94969277 0.3686001       19 20.8916388
#&gt; 28         28  1.03268637 0.3717461       17 19.4374534
#&gt; 29         29  1.11700520 0.3755241       13 17.9753823
#&gt; 30         30  1.20293125 0.3799843       19 16.5097589
#&gt; 31         31  1.29071727 0.3851447       17 15.0440068
#&gt; 32         32  1.38065471 0.3910380       17 13.5834528
#&gt; 33         33  1.47313321 0.3977848       16 12.1351562
#&gt; 34         34  1.56833794 0.4053106       11 10.7031592
#&gt; 35         35  1.66666006 0.4136580        8  9.2985852
#&gt; 36         36  1.76883244 0.4232093       11  7.9356798
#&gt; 37         37  1.87438760 0.4333202        3  6.6167296
#&gt; 38         38  1.98429588 0.4442628        6  5.3697725
#&gt; 39         39  2.10060111 0.4574333        4  4.2190260
#&gt; 40         40  2.21882242 0.4694235        2  3.1515306
#&gt; 41         41  2.34438673 0.4824723        2  2.2364769
#&gt; 42         42  2.48431292 0.5010803        0  1.4847938
#&gt; 43         43  2.61160847 0.5110566        0  0.8421851
#&gt; 44         44  2.76572671 0.5249232        0  0.4383661
#&gt; 45         45  2.98799279 0.5545631        0  0.1853440
#&gt; </div><div class='input'>
<span class='co'># constrain slopes within each group to be equal (but not across groups)</span>
<span class='va'>model2</span> <span class='op'>&lt;-</span> <span class='st'>'F1 = 1-15
           CONSTRAIN = (1-15, a1)'</span>
<span class='va'>mod_configural2</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>model2</span>, group <span class='op'>=</span> <span class='va'>group</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>mod_configural2</span>, type <span class='op'>=</span> <span class='st'>'SE'</span><span class='op'>)</span>
</div><div class='img'><img src='multipleGroup-13.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>mod_configural2</span>, type <span class='op'>=</span> <span class='st'>'RE'</span><span class='op'>)</span>
</div><div class='img'><img src='multipleGroup-14.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='itemplot.html'>itemplot</a></span><span class='op'>(</span><span class='va'>mod_configural2</span>, <span class='fl'>10</span><span class='op'>)</span>
</div><div class='img'><img src='multipleGroup-15.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>############</span>
<span class='co'>## empirical histogram example (normal and bimodal groups)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span>
<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Lognormal.html'>rlnorm</a></span><span class='op'>(</span><span class='fl'>50</span>, <span class='fl'>.2</span>, <span class='fl'>.2</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>ThetaNormal</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>2000</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>ThetaBimodal</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>1000</span>, <span class='op'>-</span><span class='fl'>2</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>1000</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='co'>#bimodal</span>
<span class='va'>Theta</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>ThetaNormal</span>, <span class='va'>ThetaBimodal</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, <span class='fl'>4000</span>, itemtype <span class='op'>=</span> <span class='st'>'2PL'</span>, Theta<span class='op'>=</span><span class='va'>Theta</span><span class='op'>)</span>
<span class='va'>group</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'G1'</span>, <span class='st'>'G2'</span><span class='op'>)</span>, each<span class='op'>=</span><span class='fl'>2000</span><span class='op'>)</span>

<span class='va'>EH</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span>, group<span class='op'>=</span><span class='va'>group</span>, dentype<span class='op'>=</span><span class='st'>"empiricalhist"</span>, invariance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>EH</span>, simplify<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $G1
#&gt; $items
#&gt;            a1      d g u
#&gt; Item_1  0.759 -1.830 0 1
#&gt; Item_2  1.062 -0.555 0 1
#&gt; Item_3  1.235 -1.117 0 1
#&gt; Item_4  0.611 -0.953 0 1
#&gt; Item_5  1.088 -0.132 0 1
#&gt; Item_6  1.054  0.502 0 1
#&gt; Item_7  0.849  1.581 0 1
#&gt; Item_8  0.870 -0.779 0 1
#&gt; Item_9  0.902  1.658 0 1
#&gt; Item_10 0.812 -1.188 0 1
#&gt; Item_11 0.903  0.661 0 1
#&gt; Item_12 0.841  2.646 0 1
#&gt; Item_13 0.843 -0.064 0 1
#&gt; Item_14 1.009 -0.600 0 1
#&gt; Item_15 1.167  0.013 0 1
#&gt; Item_16 1.008  1.886 0 1
#&gt; Item_17 0.885 -1.124 0 1
#&gt; Item_18 0.790  1.420 0 1
#&gt; Item_19 0.799  1.316 0 1
#&gt; Item_20 1.565  0.294 0 1
#&gt; Item_21 1.002  0.001 0 1
#&gt; Item_22 0.929 -0.497 0 1
#&gt; Item_23 0.903 -0.383 0 1
#&gt; Item_24 1.120  0.702 0 1
#&gt; Item_25 0.850  2.002 0 1
#&gt; Item_26 0.706 -0.208 0 1
#&gt; Item_27 1.048 -1.279 0 1
#&gt; Item_28 0.826 -0.770 0 1
#&gt; Item_29 1.062  0.221 0 1
#&gt; Item_30 0.737 -0.333 0 1
#&gt; Item_31 1.208 -0.178 0 1
#&gt; Item_32 0.917 -0.202 0 1
#&gt; Item_33 0.859 -1.360 0 1
#&gt; Item_34 0.913 -0.252 0 1
#&gt; Item_35 0.767  0.886 0 1
#&gt; Item_36 0.783  0.763 0 1
#&gt; Item_37 0.630  0.550 0 1
#&gt; Item_38 0.736 -0.405 0 1
#&gt; Item_39 0.917 -0.166 0 1
#&gt; Item_40 0.895 -1.251 0 1
#&gt; Item_41 1.251 -0.040 0 1
#&gt; Item_42 0.882  0.202 0 1
#&gt; Item_43 0.796  1.639 0 1
#&gt; Item_44 1.022  1.038 0 1
#&gt; Item_45 0.812 -0.470 0 1
#&gt; Item_46 0.807  0.336 0 1
#&gt; Item_47 0.815 -1.121 0 1
#&gt; Item_48 0.739  0.892 0 1
#&gt; Item_49 0.904  1.036 0 1
#&gt; Item_50 0.895  2.124 0 1
#&gt; 
#&gt; $means
#&gt; F1 
#&gt;  0 
#&gt; 
#&gt; $cov
#&gt;    F1
#&gt; F1  1
#&gt; 
#&gt; 
#&gt; $G2
#&gt; $items
#&gt;            a1      d g u
#&gt; Item_1  0.759 -1.830 0 1
#&gt; Item_2  1.062 -0.555 0 1
#&gt; Item_3  1.235 -1.117 0 1
#&gt; Item_4  0.611 -0.953 0 1
#&gt; Item_5  1.088 -0.132 0 1
#&gt; Item_6  1.054  0.502 0 1
#&gt; Item_7  0.849  1.581 0 1
#&gt; Item_8  0.870 -0.779 0 1
#&gt; Item_9  0.902  1.658 0 1
#&gt; Item_10 0.812 -1.188 0 1
#&gt; Item_11 0.903  0.661 0 1
#&gt; Item_12 0.841  2.646 0 1
#&gt; Item_13 0.843 -0.064 0 1
#&gt; Item_14 1.009 -0.600 0 1
#&gt; Item_15 1.167  0.013 0 1
#&gt; Item_16 1.008  1.886 0 1
#&gt; Item_17 0.885 -1.124 0 1
#&gt; Item_18 0.790  1.420 0 1
#&gt; Item_19 0.799  1.316 0 1
#&gt; Item_20 1.565  0.294 0 1
#&gt; Item_21 1.002  0.001 0 1
#&gt; Item_22 0.929 -0.497 0 1
#&gt; Item_23 0.903 -0.383 0 1
#&gt; Item_24 1.120  0.702 0 1
#&gt; Item_25 0.850  2.002 0 1
#&gt; Item_26 0.706 -0.208 0 1
#&gt; Item_27 1.048 -1.279 0 1
#&gt; Item_28 0.826 -0.770 0 1
#&gt; Item_29 1.062  0.221 0 1
#&gt; Item_30 0.737 -0.333 0 1
#&gt; Item_31 1.208 -0.178 0 1
#&gt; Item_32 0.917 -0.202 0 1
#&gt; Item_33 0.859 -1.360 0 1
#&gt; Item_34 0.913 -0.252 0 1
#&gt; Item_35 0.767  0.886 0 1
#&gt; Item_36 0.783  0.763 0 1
#&gt; Item_37 0.630  0.550 0 1
#&gt; Item_38 0.736 -0.405 0 1
#&gt; Item_39 0.917 -0.166 0 1
#&gt; Item_40 0.895 -1.251 0 1
#&gt; Item_41 1.251 -0.040 0 1
#&gt; Item_42 0.882  0.202 0 1
#&gt; Item_43 0.796  1.639 0 1
#&gt; Item_44 1.022  1.038 0 1
#&gt; Item_45 0.812 -0.470 0 1
#&gt; Item_46 0.807  0.336 0 1
#&gt; Item_47 0.815 -1.121 0 1
#&gt; Item_48 0.739  0.892 0 1
#&gt; Item_49 0.904  1.036 0 1
#&gt; Item_50 0.895  2.124 0 1
#&gt; 
#&gt; $means
#&gt; F1 
#&gt;  0 
#&gt; 
#&gt; $cov
#&gt;    F1
#&gt; F1  1
#&gt; 
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>EH</span>, type <span class='op'>=</span> <span class='st'>'empiricalhist'</span>, npts <span class='op'>=</span> <span class='fl'>60</span><span class='op'>)</span>
</div><div class='img'><img src='multipleGroup-16.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#DIF test for item 1</span>
<span class='va'>EH1</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span>, group<span class='op'>=</span><span class='va'>group</span>, dentype<span class='op'>=</span><span class='st'>"empiricalhist"</span>, invariance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>EH</span>, <span class='va'>EH1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Model 1: multipleGroup(data = dat, model = 1, group = group, invariance = colnames(dat), 
#&gt;     dentype = "empiricalhist")
#&gt; Model 2: multipleGroup(data = dat, model = 1, group = group, invariance = colnames(dat)[-1], 
#&gt;     dentype = "empiricalhist")
#&gt; </div><div class='output co'>#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik    X2  df     p
#&gt; 1 216599.8 216663.2 217659.4 217358.4 218739.8 -107959.9   NaN NaN   NaN
#&gt; 2 216602.9 216667.0 217668.7 217365.9 218755.4 -107959.4 0.916   2 0.632</div><div class='input'>
<span class='co'>#--------------------------------</span>
<span class='co'># Mixture model (no prior group variable specified)</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span>
<span class='va'>nitems</span> <span class='op'>&lt;-</span> <span class='fl'>20</span>
<span class='va'>a1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>.75</span>, ncol<span class='op'>=</span><span class='fl'>1</span>, nrow<span class='op'>=</span><span class='va'>nitems</span><span class='op'>)</span>
<span class='va'>a2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>1.25</span>, ncol<span class='op'>=</span><span class='fl'>1</span>, nrow<span class='op'>=</span><span class='va'>nitems</span><span class='op'>)</span>
<span class='va'>d1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>nitems</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>,ncol<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>d2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>nitems</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>,ncol<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>itemtype</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'2PL'</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>a1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>N1</span> <span class='op'>&lt;-</span> <span class='fl'>500</span>
<span class='va'>N2</span> <span class='op'>&lt;-</span> <span class='va'>N1</span><span class='op'>*</span><span class='fl'>2</span> <span class='co'># second class twice as large</span>

<span class='va'>dataset1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a1</span>, <span class='va'>d1</span>, <span class='va'>N1</span>, <span class='va'>itemtype</span><span class='op'>)</span>
<span class='va'>dataset2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a2</span>, <span class='va'>d2</span>, <span class='va'>N2</span>, <span class='va'>itemtype</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>dataset1</span>, <span class='va'>dataset2</span><span class='op'>)</span>
<span class='co'># group &lt;- c(rep('D1', N1), rep('D2', N2))</span>

<span class='co'># Mixture Rasch model (Rost, 1990)</span>
<span class='va'>models</span> <span class='op'>&lt;-</span> <span class='st'>'F1 = 1-20
           CONSTRAIN = (1-20, a1)'</span>
<span class='va'>mod_mix</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>models</span>, dentype <span class='op'>=</span> <span class='st'>'mixture-2'</span>, GenRandomPars <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>mod_mix</span>, simplify<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $MIXTURE_1
#&gt; $items
#&gt;            a1      d g u
#&gt; Item_1  1.302  0.772 0 1
#&gt; Item_2  1.302  1.476 0 1
#&gt; Item_3  1.302 -0.553 0 1
#&gt; Item_4  1.302 -1.588 0 1
#&gt; Item_5  1.302 -1.545 0 1
#&gt; Item_6  1.302  2.084 0 1
#&gt; Item_7  1.302 -0.510 0 1
#&gt; Item_8  1.302  0.606 0 1
#&gt; Item_9  1.302  0.550 0 1
#&gt; Item_10 1.302 -0.167 0 1
#&gt; Item_11 1.302  0.961 0 1
#&gt; Item_12 1.302  2.156 0 1
#&gt; Item_13 1.302  2.082 0 1
#&gt; Item_14 1.302  1.733 0 1
#&gt; Item_15 1.302  0.138 0 1
#&gt; Item_16 1.302  0.434 0 1
#&gt; Item_17 1.302 -0.368 0 1
#&gt; Item_18 1.302 -1.633 0 1
#&gt; Item_19 1.302  1.799 0 1
#&gt; Item_20 1.302 -0.024 0 1
#&gt; 
#&gt; $means
#&gt; F1 
#&gt;  0 
#&gt; 
#&gt; $cov
#&gt;    F1
#&gt; F1  1
#&gt; 
#&gt; $class_proportion
#&gt;     pi
#&gt;  0.655
#&gt; 
#&gt; 
#&gt; $MIXTURE_2
#&gt; $items
#&gt;            a1      d g u
#&gt; Item_1  0.681  0.664 0 1
#&gt; Item_2  0.681  0.805 0 1
#&gt; Item_3  0.681 -0.039 0 1
#&gt; Item_4  0.681 -0.416 0 1
#&gt; Item_5  0.681  0.530 0 1
#&gt; Item_6  0.681 -2.046 0 1
#&gt; Item_7  0.681  0.770 0 1
#&gt; Item_8  0.681 -0.314 0 1
#&gt; Item_9  0.681 -0.031 0 1
#&gt; Item_10 0.681 -0.820 0 1
#&gt; Item_11 0.681 -0.252 0 1
#&gt; Item_12 0.681  1.939 0 1
#&gt; Item_13 0.681  0.642 0 1
#&gt; Item_14 0.681  0.593 0 1
#&gt; Item_15 0.681 -0.750 0 1
#&gt; Item_16 0.681  0.852 0 1
#&gt; Item_17 0.681 -0.950 0 1
#&gt; Item_18 0.681 -0.345 0 1
#&gt; Item_19 0.681  1.230 0 1
#&gt; Item_20 0.681  0.271 0 1
#&gt; 
#&gt; $means
#&gt; F1 
#&gt;  0 
#&gt; 
#&gt; $cov
#&gt;    F1
#&gt; F1  1
#&gt; 
#&gt; $class_proportion
#&gt;     pi
#&gt;  0.345
#&gt; 
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>mod_mix</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; ----------
#&gt; GROUP: MIXTURE_1 
#&gt;            F1    h2
#&gt; Item_1  0.608 0.369
#&gt; Item_2  0.608 0.369
#&gt; Item_3  0.608 0.369
#&gt; Item_4  0.608 0.369
#&gt; Item_5  0.608 0.369
#&gt; Item_6  0.608 0.369
#&gt; Item_7  0.608 0.369
#&gt; Item_8  0.608 0.369
#&gt; Item_9  0.608 0.369
#&gt; Item_10 0.608 0.369
#&gt; Item_11 0.608 0.369
#&gt; Item_12 0.608 0.369
#&gt; Item_13 0.608 0.369
#&gt; Item_14 0.608 0.369
#&gt; Item_15 0.608 0.369
#&gt; Item_16 0.608 0.369
#&gt; Item_17 0.608 0.369
#&gt; Item_18 0.608 0.369
#&gt; Item_19 0.608 0.369
#&gt; Item_20 0.608 0.369
#&gt; 
#&gt; SS loadings:  7.386 
#&gt; Proportion Var:  0.369 
#&gt; 
#&gt; Factor correlations: 
#&gt; 
#&gt;    F1
#&gt; F1  1
#&gt; 
#&gt; Class proportion:  0.655 
#&gt; 
#&gt; ----------
#&gt; GROUP: MIXTURE_2 
#&gt;            F1    h2
#&gt; Item_1  0.371 0.138
#&gt; Item_2  0.371 0.138
#&gt; Item_3  0.371 0.138
#&gt; Item_4  0.371 0.138
#&gt; Item_5  0.371 0.138
#&gt; Item_6  0.371 0.138
#&gt; Item_7  0.371 0.138
#&gt; Item_8  0.371 0.138
#&gt; Item_9  0.371 0.138
#&gt; Item_10 0.371 0.138
#&gt; Item_11 0.371 0.138
#&gt; Item_12 0.371 0.138
#&gt; Item_13 0.371 0.138
#&gt; Item_14 0.371 0.138
#&gt; Item_15 0.371 0.138
#&gt; Item_16 0.371 0.138
#&gt; Item_17 0.371 0.138
#&gt; Item_18 0.371 0.138
#&gt; Item_19 0.371 0.138
#&gt; Item_20 0.371 0.138
#&gt; 
#&gt; SS loadings:  2.758 
#&gt; Proportion Var:  0.138 
#&gt; 
#&gt; Factor correlations: 
#&gt; 
#&gt;    F1
#&gt; F1  1
#&gt; 
#&gt; Class proportion:  0.345 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>mod_mix</span><span class='op'>)</span>
</div><div class='img'><img src='multipleGroup-17.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>mod_mix</span>, type <span class='op'>=</span> <span class='st'>'trace'</span><span class='op'>)</span>
</div><div class='img'><img src='multipleGroup-18.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='itemplot.html'>itemplot</a></span><span class='op'>(</span><span class='va'>mod_mix</span>, <span class='fl'>1</span>, type <span class='op'>=</span> <span class='st'>'info'</span><span class='op'>)</span>
</div><div class='img'><img src='multipleGroup-19.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'><a href='fscores.html'>fscores</a></span><span class='op'>(</span><span class='va'>mod_mix</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># theta estimates</span>
</div><div class='output co'>#&gt;         Class_1
#&gt; [1,] -0.3608700
#&gt; [2,] -1.6950983
#&gt; [3,] -0.8216594
#&gt; [4,]  0.8090804
#&gt; [5,]  0.7936639
#&gt; [6,]  0.2285733</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fu'><a href='fscores.html'>fscores</a></span><span class='op'>(</span><span class='va'>mod_mix</span>, method <span class='op'>=</span> <span class='st'>'classify'</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># classification probability</span>
</div><div class='output co'>#&gt;         CLASS_1   CLASS_2
#&gt; [1,] 0.04827981 0.9517202
#&gt; [2,] 0.74219783 0.2578022
#&gt; [3,] 0.02497150 0.9750285
#&gt; [4,] 0.02930674 0.9706933
#&gt; [5,] 0.07222962 0.9277704
#&gt; [6,] 0.42448185 0.5755182</div><div class='input'><span class='fu'><a href='itemfit.html'>itemfit</a></span><span class='op'>(</span><span class='va'>mod_mix</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       item   S_X2 df.S_X2 RMSEA.S_X2 p.S_X2
#&gt; 1   Item_1 30.497      12      0.032  0.002
#&gt; 2   Item_2 36.271      12      0.037  0.000
#&gt; 3   Item_3 15.755      12      0.014  0.203
#&gt; 4   Item_4  9.333      11      0.000  0.591
#&gt; 5   Item_5 21.637      12      0.023  0.042
#&gt; 6   Item_6 26.068      13      0.026  0.017
#&gt; 7   Item_7  8.625      12      0.000  0.735
#&gt; 8   Item_8 16.652      12      0.016  0.163
#&gt; 9   Item_9 22.772      12      0.024  0.030
#&gt; 10 Item_10 14.622      12      0.012  0.263
#&gt; 11 Item_11  7.357      12      0.000  0.833
#&gt; 12 Item_12 14.964      12      0.013  0.243
#&gt; 13 Item_13 10.222      12      0.000  0.597
#&gt; 14 Item_14 17.414      13      0.015  0.181
#&gt; 15 Item_15  9.436      12      0.000  0.665
#&gt; 16 Item_16 11.408      12      0.000  0.494
#&gt; 17 Item_17 16.484      12      0.016  0.170
#&gt; 18 Item_18 11.718      11      0.007  0.385
#&gt; 19 Item_19 11.425      12      0.000  0.493
#&gt; 20 Item_20 15.290      12      0.014  0.226</div><div class='input'>
<span class='co'># Mixture 2PL model</span>
<span class='va'>mod_mix2</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span>, dentype <span class='op'>=</span> <span class='st'>'mixture-2'</span>, GenRandomPars <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>mod_mix2</span>, <span class='va'>mod_mix</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Model 1: multipleGroup(data = dat, model = models, dentype = "mixture-2", 
#&gt;     GenRandomPars = TRUE)
#&gt; Model 2: multipleGroup(data = dat, model = 1, dentype = "mixture-2", GenRandomPars = TRUE)
#&gt; </div><div class='output co'>#&gt;        AIC     AICc    SABIC       HQ      BIC    logLik     X2  df    p
#&gt; 1 34628.19 34630.79 34720.06 34713.30 34856.65 -17271.09    NaN NaN  NaN
#&gt; 2 34655.23 34664.60 34828.29 34815.56 35085.60 -17246.62 48.957  38 0.11</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>mod_mix2</span>, simplify<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $MIXTURE_1
#&gt; $items
#&gt;            a1      d g u
#&gt; Item_1  0.517  0.672 0 1
#&gt; Item_2  0.516  0.826 0 1
#&gt; Item_3  0.533 -0.012 0 1
#&gt; Item_4  0.387 -0.363 0 1
#&gt; Item_5  0.452  0.551 0 1
#&gt; Item_6  0.727 -1.904 0 1
#&gt; Item_7  1.032  0.879 0 1
#&gt; Item_8  0.744 -0.275 0 1
#&gt; Item_9  0.900  0.037 0 1
#&gt; Item_10 0.709 -0.777 0 1
#&gt; Item_11 0.538 -0.190 0 1
#&gt; Item_12 0.915  2.079 0 1
#&gt; Item_13 0.729  0.690 0 1
#&gt; Item_14 1.183  0.722 0 1
#&gt; Item_15 0.812 -0.717 0 1
#&gt; Item_16 0.582  0.843 0 1
#&gt; Item_17 0.791 -0.953 0 1
#&gt; Item_18 0.657 -0.290 0 1
#&gt; Item_19 0.498  1.222 0 1
#&gt; Item_20 0.468  0.304 0 1
#&gt; 
#&gt; $means
#&gt; F1 
#&gt;  0 
#&gt; 
#&gt; $cov
#&gt;    F1
#&gt; F1  1
#&gt; 
#&gt; $class_proportion
#&gt;     pi
#&gt;  0.349
#&gt; 
#&gt; 
#&gt; $MIXTURE_2
#&gt; $items
#&gt;            a1      d g u
#&gt; Item_1  1.118  0.710 0 1
#&gt; Item_2  1.216  1.405 0 1
#&gt; Item_3  1.244 -0.565 0 1
#&gt; Item_4  1.684 -1.826 0 1
#&gt; Item_5  1.669 -1.800 0 1
#&gt; Item_6  1.473  2.151 0 1
#&gt; Item_7  1.143 -0.511 0 1
#&gt; Item_8  1.244  0.574 0 1
#&gt; Item_9  1.272  0.506 0 1
#&gt; Item_10 1.188 -0.183 0 1
#&gt; Item_11 1.465  0.980 0 1
#&gt; Item_12 1.403  2.208 0 1
#&gt; Item_13 1.388  2.110 0 1
#&gt; Item_14 1.062  1.599 0 1
#&gt; Item_15 1.311  0.112 0 1
#&gt; Item_16 1.191  0.410 0 1
#&gt; Item_17 1.381 -0.387 0 1
#&gt; Item_18 1.500 -1.798 0 1
#&gt; Item_19 1.624  1.955 0 1
#&gt; Item_20 1.353 -0.060 0 1
#&gt; 
#&gt; $means
#&gt; F1 
#&gt;  0 
#&gt; 
#&gt; $cov
#&gt;    F1
#&gt; F1  1
#&gt; 
#&gt; $class_proportion
#&gt;     pi
#&gt;  0.651
#&gt; 
#&gt; </div><div class='input'><span class='fu'><a href='itemfit.html'>itemfit</a></span><span class='op'>(</span><span class='va'>mod_mix2</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       item   S_X2 df.S_X2 RMSEA.S_X2 p.S_X2
#&gt; 1   Item_1 21.271      12      0.023  0.047
#&gt; 2   Item_2 44.619      13      0.040  0.000
#&gt; 3   Item_3 14.259      12      0.011  0.284
#&gt; 4   Item_4  6.550      11      0.000  0.834
#&gt; 5   Item_5 20.639      12      0.022  0.056
#&gt; 6   Item_6 27.956      13      0.028  0.009
#&gt; 7   Item_7  8.628      12      0.000  0.734
#&gt; 8   Item_8 16.261      12      0.015  0.180
#&gt; 9   Item_9 21.304      12      0.023  0.046
#&gt; 10 Item_10 11.461      12      0.000  0.490
#&gt; 11 Item_11  7.091      12      0.000  0.852
#&gt; 12 Item_12 13.837      12      0.010  0.311
#&gt; 13 Item_13 10.444      12      0.000  0.577
#&gt; 14 Item_14 15.704      13      0.012  0.265
#&gt; 15 Item_15  9.439      12      0.000  0.665
#&gt; 16 Item_16 10.128      12      0.000  0.605
#&gt; 17 Item_17 17.474      12      0.017  0.133
#&gt; 18 Item_18 11.833      11      0.007  0.376
#&gt; 19 Item_19  8.071      11      0.000  0.707
#&gt; 20 Item_20 14.542      12      0.012  0.267</div><div class='input'>
<span class='co'># Zero-inflated 2PL IRT model</span>
<span class='va'>model</span> <span class='op'>&lt;-</span> <span class='st'>"F = 1-20
          START [MIXTURE_1] = (GROUP, MEAN_1, -100), (GROUP, COV_11, .00001),
             (1-20, a1, 1.0), (1-20, d, 0.0)
          FIXED [MIXTURE_1] = (GROUP, MEAN_1), (GROUP, COV_11),
             (1-20, a1), (1-20, d)"</span>
<span class='va'>zip</span> <span class='op'>&lt;-</span> <span class='fu'>multipleGroup</span><span class='op'>(</span><span class='va'>dat</span>, <span class='va'>model</span>, dentype <span class='op'>=</span> <span class='st'>'mixture-2'</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>zip</span>, simplify<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $MIXTURE_1
#&gt; $items
#&gt;         a1 d g u
#&gt; Item_1   1 0 0 1
#&gt; Item_2   1 0 0 1
#&gt; Item_3   1 0 0 1
#&gt; Item_4   1 0 0 1
#&gt; Item_5   1 0 0 1
#&gt; Item_6   1 0 0 1
#&gt; Item_7   1 0 0 1
#&gt; Item_8   1 0 0 1
#&gt; Item_9   1 0 0 1
#&gt; Item_10  1 0 0 1
#&gt; Item_11  1 0 0 1
#&gt; Item_12  1 0 0 1
#&gt; Item_13  1 0 0 1
#&gt; Item_14  1 0 0 1
#&gt; Item_15  1 0 0 1
#&gt; Item_16  1 0 0 1
#&gt; Item_17  1 0 0 1
#&gt; Item_18  1 0 0 1
#&gt; Item_19  1 0 0 1
#&gt; Item_20  1 0 0 1
#&gt; 
#&gt; $means
#&gt;    F 
#&gt; -100 
#&gt; 
#&gt; $cov
#&gt;   F
#&gt; F 0
#&gt; 
#&gt; $class_proportion
#&gt;     pi
#&gt;  0.014
#&gt; 
#&gt; 
#&gt; $MIXTURE_2
#&gt; $items
#&gt;            a1      d g u
#&gt; Item_1  0.902  0.699 0 1
#&gt; Item_2  0.948  1.172 0 1
#&gt; Item_3  0.890 -0.338 0 1
#&gt; Item_4  0.827 -1.048 0 1
#&gt; Item_5  0.634 -0.612 0 1
#&gt; Item_6  0.709  0.420 0 1
#&gt; Item_7  0.831 -0.025 0 1
#&gt; Item_8  1.074  0.251 0 1
#&gt; Item_9  1.141  0.334 0 1
#&gt; Item_10 1.042 -0.410 0 1
#&gt; Item_11 1.095  0.482 0 1
#&gt; Item_12 1.217  2.180 0 1
#&gt; Item_13 1.034  1.459 0 1
#&gt; Item_14 1.032  1.255 0 1
#&gt; Item_15 1.148 -0.199 0 1
#&gt; Item_16 0.930  0.571 0 1
#&gt; Item_17 1.195 -0.610 0 1
#&gt; Item_18 0.807 -1.033 0 1
#&gt; Item_19 1.181  1.640 0 1
#&gt; Item_20 0.985  0.087 0 1
#&gt; 
#&gt; $means
#&gt; F 
#&gt; 0 
#&gt; 
#&gt; $cov
#&gt;   F
#&gt; F 1
#&gt; 
#&gt; $class_proportion
#&gt;     pi
#&gt;  0.986
#&gt; 
#&gt; </div><div class='input'>
<span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


