<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute model residuals — residuals-method • mirt</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute model residuals — residuals-method" />
<meta property="og:description" content="Return model implied residuals for linear dependencies between items or at the person level.
If the latent trait density was approximated (e.g., Davidian curves, Empirical histograms, etc)
then passing use_dentype_estimate = TRUE will use the internally saved quadrature and
density components (where applicable)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mirt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.32.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mirt-vignettes.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/philchalmers/mirt/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute model residuals</h1>
    <small class="dont-index">Source: <a href='https://github.com/philchalmers/mirt/blob/master/R/SingleGroup-methods.R'><code>R/SingleGroup-methods.R</code></a></small>
    <div class="hidden name"><code>residuals-method.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Return model implied residuals for linear dependencies between items or at the person level.
If the latent trait density was approximated (e.g., Davidian curves, Empirical histograms, etc)
then passing <code>use_dentype_estimate = TRUE</code> will use the internally saved quadrature and
density components (where applicable).</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for SingleGroupClass</span>
<span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span>
  <span class='va'>object</span>,
  type <span class='op'>=</span> <span class='st'>"LD"</span>,
  df.p <span class='op'>=</span> <span class='cn'>FALSE</span>,
  full.scores <span class='op'>=</span> <span class='cn'>FALSE</span>,
  QMC <span class='op'>=</span> <span class='cn'>FALSE</span>,
  printvalue <span class='op'>=</span> <span class='cn'>NULL</span>,
  tables <span class='op'>=</span> <span class='cn'>FALSE</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  Theta <span class='op'>=</span> <span class='cn'>NULL</span>,
  suppress <span class='op'>=</span> <span class='fl'>1</span>,
  theta_lim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>6</span>, <span class='fl'>6</span><span class='op'>)</span>,
  quadpts <span class='op'>=</span> <span class='cn'>NULL</span>,
  fold <span class='op'>=</span> <span class='cn'>TRUE</span>,
  technical <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>an object of class <code>SingleGroupClass</code> or
<code>MultipleGroupClass</code>. Bifactor models are automatically detected and utilized for
better accuracy</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>type of residuals to be displayed.
Can be either <code>'LD'</code> or <code>'LDG2'</code> for a local dependence matrix based on the
X2 or G2 statistics (Chen &amp; Thissen, 1997), <code>'Q3'</code> for the statistic proposed by
Yen (1984), <code>'JSI'</code> for the jack-knife statistic proposed Edwards et al. (2018),
<code>'exp'</code> for the expected values for the frequencies of every response pattern,
and <code>'expfull'</code> for the expected values for every theoretically observable response pattern.
For the 'LD' and 'LDG2' types, the upper diagonal elements represent the standardized
residuals in the form of signed Cramers V coefficients</p></td>
    </tr>
    <tr>
      <th>df.p</th>
      <td><p>logical; print the degrees of freedom and p-values?</p></td>
    </tr>
    <tr>
      <th>full.scores</th>
      <td><p>logical; compute relevant statistics
for each subject in the original data?</p></td>
    </tr>
    <tr>
      <th>QMC</th>
      <td><p>logical; use quasi-Monte Carlo integration? If <code>quadpts</code> is omitted the
default number of nodes is 5000</p></td>
    </tr>
    <tr>
      <th>printvalue</th>
      <td><p>a numeric value to be specified when using the <code>res='exp'</code>
option. Only prints patterns that have standardized residuals greater than
<code><a href='https://rdrr.io/r/base/MathFun.html'>abs(printvalue)</a></code>. The default (NULL) prints all response patterns</p></td>
    </tr>
    <tr>
      <th>tables</th>
      <td><p>logical; for LD type, return the observed, expected, and standardized residual
tables for each item combination?</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical; allow information to be printed to the console?</p></td>
    </tr>
    <tr>
      <th>Theta</th>
      <td><p>a matrix of factor scores used for statistics that require empirical estimates (i.e., Q3).
If supplied, arguments typically passed to <code><a href='fscores.html'>fscores()</a></code> will be ignored and these values will
be used instead</p></td>
    </tr>
    <tr>
      <th>suppress</th>
      <td><p>a numeric value indicating which parameter local dependency combinations
to flag as being too high. Absolute values for the standardized estimates greater than
this value will be returned, while all values less than this value will be set to NA</p></td>
    </tr>
    <tr>
      <th>theta_lim</th>
      <td><p>range for the integration grid</p></td>
    </tr>
    <tr>
      <th>quadpts</th>
      <td><p>number of quadrature nodes to use. The default is extracted from model (if available)
or generated automatically if not available</p></td>
    </tr>
    <tr>
      <th>fold</th>
      <td><p>logical; apply the sum 'folding' described by Edwards et al. (2018) for the JSI statistic?</p></td>
    </tr>
    <tr>
      <th>technical</th>
      <td><p>list of technical arguments when models are re-estimated (see <code><a href='mirt.html'>mirt</a></code>
for details)</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments to be passed to <code><a href='fscores.html'>fscores()</a></code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Chalmers, R., P. (2012). mirt: A Multidimensional Item Response Theory
Package for the R Environment. <em>Journal of Statistical Software, 48</em>(6), 1-29.
doi: <a href='https://doi.org/10.18637/jss.v048.i06'>10.18637/jss.v048.i06</a></p>
<p>Chen, W. H. &amp; Thissen, D. (1997). Local dependence indices for item pairs using item
response theory. <em>Journal of Educational and Behavioral Statistics, 22</em>, 265-289.</p>
<p>Edwards, M. C., Houts, C. R. &amp; Cai, L. (2018). A Diagnostic Procedure to Detect Departures
From Local Independence in Item Response Theory Models.
<em>Psychological Methods, 23</em>, 138-149.</p>
<p>Yen, W. (1984). Effects of local item dependence on the fit and equating performance of the three
parameter logistic model. <em>Applied Psychological Measurement, 8</em>, 125-145.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># \donttest{</span>

<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mirt.html'>mirt</a></span><span class='op'>(</span><span class='va'>Science</span>, <span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</div><div class='output co'>#&gt; LD matrix (lower triangle) and standardized values:
#&gt; 
#&gt;         Comfort   Work Future Benefit
#&gt; Comfort      NA -0.147 -0.101   0.152
#&gt; Work     25.512     NA  0.088  -0.141
#&gt; Future   12.002  9.208     NA  -0.122
#&gt; Benefit  27.321 23.235 17.461      NA</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>x</span>, tables <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $Comfort_Work
#&gt; $Comfort_Work$Obs
#&gt;    
#&gt;       1   2   3   4
#&gt;   1   2   0   1   2
#&gt;   2   2  11  15   4
#&gt;   3  24  71 148  23
#&gt;   4   5  16  42  26
#&gt; 
#&gt; $Comfort_Work$Exp
#&gt;           [,1]      [,2]       [,3]      [,4]
#&gt; [1,]  1.046123  1.787854   1.922925  0.262908
#&gt; [2,]  5.722535 11.386923  13.625623  1.972172
#&gt; [3,] 23.322258 69.348472 140.029013 31.718143
#&gt; [4,]  3.487224 14.109434  50.763258 21.495135
#&gt; 
#&gt; $Comfort_Work$std_res
#&gt;    
#&gt;              1          2          3          4
#&gt;   1  0.9326115 -1.3371066 -0.6655567  3.3878247
#&gt;   2 -1.5561252 -0.1146625  0.3723298  1.4439717
#&gt;   3  0.1403392  0.1983204  0.6736015 -1.5479971
#&gt;   4  0.8100928  0.5033119 -1.2299596  0.9716541
#&gt; 
#&gt; 
#&gt; $Comfort_Future
#&gt; $Comfort_Future$Obs
#&gt;    
#&gt;       1   2   3   4
#&gt;   1   2   2   1   0
#&gt;   2   3  11  11   7
#&gt;   3   8  51 155  52
#&gt;   4   1   8  43  37
#&gt; 
#&gt; $Comfort_Future$Exp
#&gt;           [,1]      [,2]       [,3]       [,4]
#&gt; [1,] 0.7680477  1.812936   2.091572  0.3472546
#&gt; [2,] 3.6749826 11.241583  15.084907  2.7057791
#&gt; [3,] 9.1976778 52.384929 148.579175 54.2561060
#&gt; [4,] 0.7527106  6.828614  42.541147 39.7325783
#&gt; 
#&gt; $Comfort_Future$std_res
#&gt;    
#&gt;               1           2           3           4
#&gt;   1  1.40572316  0.13893088 -0.75477217 -0.58928310
#&gt;   2 -0.35209910 -0.07205318 -1.05174604  2.61058722
#&gt;   3 -0.39491253 -0.19134814  0.52675890 -0.30629167
#&gt;   4  0.28503062  0.44826372  0.07035076 -0.43351011
#&gt; 
#&gt; 
#&gt; $Comfort_Benefit
#&gt; $Comfort_Benefit$Obs
#&gt;    
#&gt;       1   2   3   4
#&gt;   1   4   0   1   0
#&gt;   2   5  10  13   4
#&gt;   3  11  81 133  41
#&gt;   4   1   9  46  33
#&gt; 
#&gt; $Comfort_Benefit$Exp
#&gt;            [,1]     [,2]       [,3]       [,4]
#&gt; [1,]  0.6710457  1.95217   1.959779  0.4368153
#&gt; [2,]  3.6241191 12.16983  13.682082  3.2312240
#&gt; [3,] 14.8454892 71.28246 131.343241 46.9466978
#&gt; [4,]  2.3173267 14.55596  44.803655 28.1781067
#&gt; 
#&gt; $Comfort_Benefit$std_res
#&gt;    
#&gt;              1          2          3          4
#&gt;   1  4.0637950 -1.3972006 -0.6855953 -0.6609200
#&gt;   2  0.7227359 -0.6219892 -0.1844000  0.4276774
#&gt;   3 -0.9980547  1.1509727  0.1445624 -0.8679073
#&gt;   4 -0.8653661 -1.4562597  0.1787310  0.9083677
#&gt; 
#&gt; 
#&gt; $Work_Future
#&gt; $Work_Future$Obs
#&gt;    
#&gt;       1   2   3   4
#&gt;   1   7  10  14   2
#&gt;   2   3  28  57  10
#&gt;   3   3  31 122  50
#&gt;   4   1   3  17  34
#&gt; 
#&gt; $Work_Future$Exp
#&gt;           [,1]      [,2]      [,3]      [,4]
#&gt; [1,] 4.6004355 12.483087  14.34426  2.150355
#&gt; [2,] 5.8020446 27.786418  52.26417 10.780046
#&gt; [3,] 3.6903551 28.936581 118.01439 55.699488
#&gt; [4,] 0.3005835  3.061977  23.67397 28.411829
#&gt; 
#&gt; $Work_Future$std_res
#&gt;    
#&gt;               1           2           3           4
#&gt;   1  1.11874979 -0.70279865 -0.09089724 -0.10253275
#&gt;   2 -1.16328067  0.04051800  0.65507895 -0.23757996
#&gt;   3 -0.35936723  0.38358699  0.36688237 -0.76367799
#&gt;   4  1.27571400 -0.03541829 -1.37166696  1.04838334
#&gt; 
#&gt; 
#&gt; $Work_Benefit
#&gt; $Work_Benefit$Obs
#&gt;    
#&gt;       1   2   3   4
#&gt;   1   4   8  12   9
#&gt;   2   6  34  47  11
#&gt;   3   8  52 111  35
#&gt;   4   3   6  23  23
#&gt; 
#&gt; $Work_Benefit$Exp
#&gt;          [,1]      [,2]      [,3]      [,4]
#&gt; [1,] 4.233251 13.170723  13.31610  2.858063
#&gt; [2,] 7.660483 32.196149  44.96112 11.814929
#&gt; [3,] 8.417022 46.931424 106.55195 44.440425
#&gt; [4,] 1.147224  7.662122  26.95958 19.679427
#&gt; 
#&gt; $Work_Benefit$std_res
#&gt;    
#&gt;              1          2          3          4
#&gt;   1 -0.1133671 -1.4247756 -0.3606627  3.6330344
#&gt;   2 -0.5999380  0.3179060  0.3040694 -0.2370851
#&gt;   3 -0.1437407  0.7398678  0.4309125 -1.4161278
#&gt;   4  1.7298113 -0.6004660 -0.7625934  0.7485258
#&gt; 
#&gt; 
#&gt; $Future_Benefit
#&gt; $Future_Benefit$Obs
#&gt;    
#&gt;       1   2   3   4
#&gt;   1   5   1   6   2
#&gt;   2   5  32  30   5
#&gt;   3   8  53 118  31
#&gt;   4   3  14  39  40
#&gt; 
#&gt; $Future_Benefit$Exp
#&gt;          [,1]      [,2]       [,3]       [,4]
#&gt; [1,] 2.960508  6.706374   4.143629  0.5829072
#&gt; [2,] 7.760422 29.142832  29.887302  5.4775063
#&gt; [3,] 9.227453 52.779344 109.948223 36.3417805
#&gt; [4,] 1.509597 11.331867  47.809604 36.3906499
#&gt; 
#&gt; $Future_Benefit$std_res
#&gt;    
#&gt;               1           2           3           4
#&gt;   1  1.18532911 -2.20351681  0.91195681  1.85608815
#&gt;   2 -0.99090687  0.52926095  0.02061456 -0.20402700
#&gt;   3 -0.40407692  0.03037266  0.76788760 -0.88610042
#&gt;   4  1.21303423  0.79260501 -1.27408623  0.59832081
#&gt; 
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>x</span>, type <span class='op'>=</span> <span class='st'>'exp'</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    Comfort Work Future Benefit freq    exp    res
#&gt; 86       1    1      1       1    2  0.124  5.324
#&gt; 54       1    3      2       1    1  0.067  3.605
#&gt; 16       1    4      2       3    1  0.019  7.046
#&gt; 85       1    4      3       1    1  0.006 12.642
#&gt; 90       2    1      1       1    1  0.460  0.796
#&gt; 57       2    1      2       4    1  0.095  2.930
#&gt; 29       2    2      1       1    1  0.351  1.095
#&gt; 72       2    2      2       2    4  2.147  1.264
#&gt; 53       2    2      2       3    2  1.616  0.302
#&gt; 74       2    2      3       1    1  0.377  1.015
#&gt; 89       2    2      3       2    1  1.716 -0.547
#&gt; 73       2    2      3       3    1  2.228 -0.823
#&gt; 24       2    2      4       3    1  0.251  1.497
#&gt; 14       2    3      1       3    1  0.213  1.707
#&gt; 23       2    3      2       2    2  1.545  0.366
#&gt; 65       2    3      2       3    1  1.489 -0.401
#&gt; 62       2    3      3       2    3  2.248  0.502
#&gt; 70       2    3      3       3    3  3.910 -0.460
#&gt; 46       2    3      3       4    2  1.035  0.948
#&gt; 48       2    3      4       1    1  0.041  4.763
#&gt; 30       2    3      4       3    2  0.866  1.218
#&gt; 32       2    4      2       1    1  0.029  5.690
#&gt; 79       2    4      4       3    2  0.259  3.418
#&gt; 49       2    4      4       4    1  0.184  1.902
#&gt; 83       3    1      1       1    1  0.644  0.444
#&gt; 36       3    1      1       3    2  0.638  1.705
#&gt; 13       3    1      2       2    2  3.923 -0.971
#&gt; 10       3    1      2       3    4  3.077  0.526
#&gt; 18       3    1      3       2    5  3.567  0.759
#&gt; 15       3    1      3       3    5  5.097 -0.043
#&gt; 69       3    1      3       4    3  1.160  1.709
#&gt; 87       3    1      4       3    1  0.764  0.269
#&gt; 42       3    1      4       4    1  0.320  1.203
#&gt; 37       3    2      1       2    1  1.781 -0.585
#&gt; 64       3    2      1       4    1  0.154  2.157
#&gt; 88       3    2      2       1    1  2.250 -0.833
#&gt; 38       3    2      2       2   10  8.471  0.525
#&gt; 3        3    2      2       3    7  8.067 -0.376
#&gt; 40       3    2      3       1    1  2.221 -0.819
#&gt; 12       3    2      3       2   16 11.743  1.242
#&gt; 17       3    2      3       3   22 19.584  0.546
#&gt; 6        3    2      3       4    5  4.950  0.023
#&gt; 82       3    2      4       1    1  0.193  1.835
#&gt; 50       3    2      4       2    1  1.293 -0.258
#&gt; 75       3    2      4       3    3  3.778 -0.400
#&gt; 60       3    2      4       4    2  1.716  0.217
#&gt; 66       3    3      1       3    2  0.971  1.044
#&gt; 59       3    3      2       1    1  1.764 -0.575
#&gt; 19       3    3      2       2   13  7.852  1.837
#&gt; 26       3    3      2       3   10  9.780  0.070
#&gt; 76       3    3      2       4    2  1.975  0.018
#&gt; 39       3    3      3       1    5  3.363  0.893
#&gt; 11       3    3      3       2   23 20.447  0.565
#&gt; 2        3    3      3       3   52 45.243  1.005
#&gt; 21       3    3      3       4    8 14.757 -1.759
#&gt; 7        3    3      4       2    7  4.389  1.246
#&gt; 9        3    3      4       3   13 16.979 -0.966
#&gt; 31       3    3      4       4   12 10.323  0.522
#&gt; 58       3    4      1       3    1  0.090  3.030
#&gt; 34       3    4      2       3    1  1.098 -0.093
#&gt; 55       3    4      3       2    2  3.043 -0.598
#&gt; 28       3    4      3       3    4  8.562 -1.559
#&gt; 51       3    4      3       4    4  3.637  0.191
#&gt; 4        3    4      4       1    1  0.160  2.100
#&gt; 78       3    4      4       2    1  1.287 -0.253
#&gt; 56       3    4      4       3    6  6.466 -0.183
#&gt; 63       3    4      4       4    3  5.659 -1.118
#&gt; 47       4    1      1       4    1  0.006 12.587
#&gt; 80       4    1      2       2    1  0.325  1.183
#&gt; 35       4    1      2       4    2  0.057  8.158
#&gt; 61       4    1      3       4    1  0.300  1.278
#&gt; 25       4    2      2       1    1  0.193  1.836
#&gt; 68       4    2      2       3    3  1.017  1.967
#&gt; 22       4    2      3       3    8  4.462  1.675
#&gt; 20       4    2      3       4    2  1.448  0.459
#&gt; 45       4    2      4       2    1  0.433  0.862
#&gt; 71       4    2      4       4    1  1.080 -0.077
#&gt; 84       4    3      2       3    1  1.665 -0.516
#&gt; 81       4    3      3       2    2  4.874 -1.302
#&gt; 8        4    3      3       3   21 14.002  1.870
#&gt; 33       4    3      3       4    3  5.965 -1.214
#&gt; 27       4    3      4       2    2  2.097 -0.067
#&gt; 67       4    3      4       3    5 10.419 -1.679
#&gt; 44       4    3      4       4    8  8.830 -0.279
#&gt; 1        4    4      3       2    1  0.966  0.034
#&gt; 5        4    4      3       3    2  3.571 -0.831
#&gt; 52       4    4      3       4    3  2.063  0.652
#&gt; 77       4    4      4       2    2  0.906  1.149
#&gt; 43       4    4      4       3    6  5.780  0.092
#&gt; 41       4    4      4       4   12  7.470  1.657</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>x</span>, suppress <span class='op'>=</span> <span class='fl'>.15</span><span class='op'>)</span>
</div><div class='output co'>#&gt; LD matrix (lower triangle) and standardized values:
#&gt; 
#&gt;         Comfort Work Future Benefit
#&gt; Comfort      NA   NA     NA   0.152
#&gt; Work         NA   NA     NA      NA
#&gt; Future       NA   NA     NA      NA
#&gt; Benefit      NA   NA     NA      NA</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>x</span>, df.p <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Degrees of freedom (lower triangle) and p-values:
#&gt; 
#&gt;         Comfort  Work Future Benefit
#&gt; Comfort      NA 0.002  0.213   0.001
#&gt; Work          9    NA  0.418   0.006
#&gt; Future        9 9.000     NA   0.042
#&gt; Benefit       9 9.000  9.000      NA
#&gt; 
#&gt; LD matrix (lower triangle) and standardized values:
#&gt; 
#&gt;         Comfort   Work Future Benefit
#&gt; Comfort      NA -0.147 -0.101   0.152
#&gt; Work     25.512     NA  0.088  -0.141
#&gt; Future   12.002  9.208     NA  -0.122
#&gt; Benefit  27.321 23.235 17.461      NA</div><div class='input'>
<span class='co'># Pearson's X2 estimate for goodness-of-fit</span>
<span class='va'>full_table</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>x</span>, type <span class='op'>=</span> <span class='st'>'expfull'</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>full_table</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   Comfort Work Future Benefit freq   exp    res
#&gt; 1       1    1      1       1    2 0.124  5.324
#&gt; 2       1    1      1       2    0 0.160 -0.400
#&gt; 3       1    1      1       3    0 0.054 -0.233
#&gt; 4       1    1      1       4    0 0.005 -0.073
#&gt; 5       1    1      2       1    0 0.092 -0.303
#&gt; 6       1    1      2       2    0 0.219 -0.468</div><div class='input'><span class='va'>X2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>full_table</span>, <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>freq</span> <span class='op'>-</span> <span class='va'>exp</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>/</span> <span class='va'>exp</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>full_table</span><span class='op'>)</span> <span class='op'>-</span> <span class='fu'><a href='extract.mirt.html'>extract.mirt</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>'nest'</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>1</span>
<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Chisquare.html'>pchisq</a></span><span class='op'>(</span><span class='va'>X2</span>, df <span class='op'>=</span> <span class='va'>df</span>, lower.tail<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>X2</span>, <span class='va'>df</span>, <span class='va'>p</span>, row.names<span class='op'>=</span><span class='st'>'Pearson-X2'</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                  X2  df            p
#&gt; Pearson-X2 689.3347 239 2.942933e-45</div><div class='input'>
<span class='co'># above FOG test as a function</span>
<span class='va'>PearsonX2</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>{</span>
   <span class='va'>full_table</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>x</span>, type <span class='op'>=</span> <span class='st'>'expfull'</span><span class='op'>)</span>
   <span class='va'>X2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>full_table</span>, <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>freq</span> <span class='op'>-</span> <span class='va'>exp</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>/</span> <span class='va'>exp</span><span class='op'>)</span><span class='op'>)</span>
   <span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>full_table</span><span class='op'>)</span> <span class='op'>-</span> <span class='fu'><a href='extract.mirt.html'>extract.mirt</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>'nest'</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>1</span>
   <span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Chisquare.html'>pchisq</a></span><span class='op'>(</span><span class='va'>X2</span>, df <span class='op'>=</span> <span class='va'>df</span>, lower.tail<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
   <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>X2</span>, <span class='va'>df</span>, <span class='va'>p</span>, row.names<span class='op'>=</span><span class='st'>'Pearson-X2'</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='fu'>PearsonX2</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                  X2  df            p
#&gt; Pearson-X2 689.3347 239 2.942933e-45</div><div class='input'>

<span class='co'># extract results manually</span>
<span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>x</span>, df.p <span class='op'>=</span> <span class='cn'>TRUE</span>, verbose<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>out</span><span class='op'>)</span>
</div><div class='output co'>#&gt; List of 2
#&gt;  $ df.p: 'mirt_matrix' num [1:4, 1:4] NA 9 9 9 0.00245 ...
#&gt;   ..- attr(*, "dimnames")=List of 2
#&gt;   .. ..$ : chr [1:4] "Comfort" "Work" "Future" "Benefit"
#&gt;   .. ..$ : chr [1:4] "Comfort" "Work" "Future" "Benefit"
#&gt;  $ LD  : 'mirt_matrix' num [1:4, 1:4] NA 25.512 12.002 27.321 -0.147 ...
#&gt;   ..- attr(*, "dimnames")=List of 2
#&gt;   .. ..$ : chr [1:4] "Comfort" "Work" "Future" "Benefit"
#&gt;   .. ..$ : chr [1:4] "Comfort" "Work" "Future" "Benefit"</div><div class='input'><span class='va'>out</span><span class='op'>$</span><span class='va'>df.p</span><span class='op'>[</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>]</span>
</div><div class='output co'>#&gt; [1] 0.002454207</div><div class='input'>
<span class='co'># with and without supplied factor scores</span>
<span class='va'>Theta</span> <span class='op'>&lt;-</span> <span class='fu'><a href='fscores.html'>fscores</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>x</span>, type <span class='op'>=</span> <span class='st'>'Q3'</span>, Theta<span class='op'>=</span><span class='va'>Theta</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Q3 matrix:
#&gt; 
#&gt;         Comfort   Work Future Benefit
#&gt; Comfort   1.000 -0.203 -0.252   0.085
#&gt; Work     -0.203  1.000 -0.208  -0.242
#&gt; Future   -0.252 -0.208  1.000  -0.320
#&gt; Benefit   0.085 -0.242 -0.320   1.000</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>x</span>, type <span class='op'>=</span> <span class='st'>'Q3'</span>, method <span class='op'>=</span> <span class='st'>'ML'</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Q3 matrix:
#&gt; 
#&gt;         Comfort   Work Future Benefit
#&gt; Comfort   1.000 -0.262 -0.419   0.053
#&gt; Work     -0.262  1.000 -0.428  -0.295
#&gt; Future   -0.419 -0.428  1.000  -0.514
#&gt; Benefit   0.053 -0.295 -0.514   1.000</div><div class='input'>
<span class='co'># Edwards et al. (2018) JSI statistic</span>
<span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>250</span>
<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>1.7</span>, <span class='fl'>0.3</span><span class='op'>)</span>
<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>d</span>, N<span class='op'>=</span><span class='fl'>250</span>, itemtype <span class='op'>=</span> <span class='st'>'2PL'</span><span class='op'>)</span>

<span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mirt.html'>mirt</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>mod</span>, type <span class='op'>=</span> <span class='st'>'JSI'</span><span class='op'>)</span>
</div><div class='output co'>#&gt;         Item_1 Item_2 Item_3 Item_4 Item_5 Item_6 Item_7 Item_8 Item_9 Item_10
#&gt; Item_1      NA -0.161  0.054  0.229  0.332 -0.330  0.307 -0.619  0.176  -0.028
#&gt; Item_2  -0.161     NA -0.471 -0.160  0.319  0.317 -0.180 -0.016  0.412   0.018
#&gt; Item_3   0.054 -0.471     NA -0.256 -0.506  0.056 -0.178  1.356  0.104  -0.079
#&gt; Item_4   0.229 -0.160 -0.256     NA  0.362 -0.175 -0.142  0.512  0.044  -0.377
#&gt; Item_5   0.332  0.319 -0.506  0.362     NA  0.135 -0.066 -1.046 -0.516   0.866
#&gt; Item_6  -0.330  0.317  0.056 -0.175  0.135     NA  0.047  0.219 -0.007   0.011
#&gt; Item_7   0.307 -0.180 -0.178 -0.142 -0.066  0.047     NA  0.020  0.139  -0.081
#&gt; Item_8  -0.619 -0.016  1.356  0.512 -1.046  0.219  0.020     NA  0.333  -0.051
#&gt; Item_9   0.176  0.412  0.104  0.044 -0.516 -0.007  0.139  0.333     NA  -0.393
#&gt; Item_10 -0.028  0.018 -0.079 -0.377  0.866  0.011 -0.081 -0.051 -0.393      NA</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>mod</span>, type <span class='op'>=</span> <span class='st'>'JSI'</span>, fold<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='co'># unfolded</span>
</div><div class='output co'>#&gt;         Item_1 Item_2 Item_3 Item_4 Item_5 Item_6 Item_7 Item_8 Item_9 Item_10
#&gt; Item_1      NA -0.102  0.108  0.147  0.128 -0.152  0.223 -0.339  0.079  -0.016
#&gt; Item_2  -0.059     NA -0.184 -0.084  0.151  0.166 -0.091 -0.010  0.200   0.003
#&gt; Item_3  -0.054 -0.288     NA -0.089 -0.276 -0.002 -0.147  0.690  0.067  -0.013
#&gt; Item_4   0.082 -0.076 -0.167     NA  0.161 -0.102 -0.100  0.273  0.039  -0.187
#&gt; Item_5   0.203  0.169 -0.230  0.201     NA  0.072 -0.017 -0.551 -0.278   0.491
#&gt; Item_6  -0.178  0.151  0.058 -0.073  0.062     NA  0.026  0.108 -0.004   0.011
#&gt; Item_7   0.084 -0.088 -0.030 -0.042 -0.049  0.022     NA  0.004  0.041  -0.041
#&gt; Item_8  -0.279 -0.007  0.666  0.239 -0.495  0.111  0.017     NA  0.183  -0.045
#&gt; Item_9   0.097  0.212  0.037  0.004 -0.238 -0.003  0.098  0.150     NA  -0.213
#&gt; Item_10 -0.012  0.015 -0.066 -0.190  0.374  0.000 -0.040 -0.006 -0.180      NA</div><div class='input'>
<span class='co'># LD between items 1-2</span>
<span class='va'>aLD</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>
<span class='va'>aLD</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>2.55</span>, <span class='fl'>0.15</span><span class='op'>)</span>
<span class='va'>a2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>aLD</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simdata.html'>simdata</a></span><span class='op'>(</span><span class='va'>a2</span>, <span class='va'>d</span>, N<span class='op'>=</span><span class='fl'>250</span>, itemtype <span class='op'>=</span> <span class='st'>'2PL'</span><span class='op'>)</span>

<span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mirt.html'>mirt</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='fl'>1</span><span class='op'>)</span>

<span class='co'># JSI executed in parallel over multiple cores</span>
<span class='fu'><a href='mirtCluster.html'>mirtCluster</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>mirtCluster() has already been defined</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span><span class='op'>(</span><span class='va'>mod</span>, type <span class='op'>=</span> <span class='st'>'JSI'</span><span class='op'>)</span>
</div><div class='output co'>#&gt;         Item_1 Item_2 Item_3 Item_4 Item_5 Item_6 Item_7 Item_8 Item_9 Item_10
#&gt; Item_1      NA  4.804 -1.676 -0.731 -0.550 -0.546 -1.542 -1.020 -0.100  -0.514
#&gt; Item_2   4.804     NA -1.289 -0.629 -1.082 -1.025 -0.948 -0.326 -0.427  -0.610
#&gt; Item_3  -1.676 -1.289     NA  0.802 -0.117  0.837  0.820  1.140  0.734   0.039
#&gt; Item_4  -0.731 -0.629  0.802     NA  0.847 -0.006  0.226  0.367  0.470  -0.317
#&gt; Item_5  -0.550 -1.082 -0.117  0.847     NA  0.195  0.467  0.201 -0.055   0.680
#&gt; Item_6  -0.546 -1.025  0.837 -0.006  0.195     NA  0.306 -0.420  0.489   0.978
#&gt; Item_7  -1.542 -0.948  0.820  0.226  0.467  0.306     NA  0.514  0.211   0.086
#&gt; Item_8  -1.020 -0.326  1.140  0.367  0.201 -0.420  0.514     NA -0.475   0.672
#&gt; Item_9  -0.100 -0.427  0.734  0.470 -0.055  0.489  0.211 -0.475     NA  -0.629
#&gt; Item_10 -0.514 -0.610  0.039 -0.317  0.680  0.978  0.086  0.672 -0.629      NA</div><div class='input'>
<span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


